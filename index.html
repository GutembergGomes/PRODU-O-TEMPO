<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GGOMES-LOG - Sistema de Acompanhamento de Produção</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f0ff',
                            100: '#e1e0ff',
                            200: '#c7c5fe',
                            300: '#a7a4fd',
                            400: '#8c7af8',
                            500: '#7a63f1',
                            600: '#7250e6',
                            700: '#5D5CDE', // Nossa cor principal
                            800: '#4940b0',
                            900: '#373583',
                        },
                        secondary: {
                            50: '#f1fcf7',
                            100: '#dbf7e8',
                            200: '#b9edd4',
                            300: '#88dbb8',
                            400: '#52bf95',
                            500: '#35a57d',
                            600: '#258566',
                            700: '#206b54',
                            800: '#1d5645',
                            900: '#19473a',
                        },
                        accent: {
                            50: '#fff8eb',
                            100: '#ffecc6',
                            200: '#ffd886',
                            300: '#ffbc46',
                            400: '#ffa620',
                            500: '#fe8605',
                            600: '#e56506',
                            700: '#bd4708',
                            800: '#983a0f',
                            900: '#7c3010',
                        },
                        success: {
                            50: '#ecfdf5',
                            100: '#d1fae5',
                            200: '#a7f3d0',
                            300: '#6ee7b7',
                            400: '#34d399',
                            500: '#10b981',
                            600: '#059669',
                            700: '#047857',
                            800: '#065f46',
                            900: '#064e3b',
                        },
                        warning: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                        },
                        danger: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            200: '#fecaca',
                            300: '#fca5a5',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                            800: '#991b1b',
                            900: '#7f1d1d',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif']
                    },
                    boxShadow: {
                        'card': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                        'card-hover': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                        'inner-light': 'inset 0 2px 4px 0 rgba(0, 0, 0, 0.06)',
                        'inner-dark': 'inset 0 2px 4px 0 rgba(255, 255, 255, 0.06)'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-in-out',
                        'slide-in': 'slideIn 0.3s ease-out',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-slow': 'bounce 2s infinite',
                        'spin-slow': 'spin 3s linear infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideIn: {
                            '0%': { transform: 'translateY(-10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                    },
                    borderRadius: {
                        'xl': '0.75rem',
                        '2xl': '1rem',
                        '3xl': '1.5rem',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            transition: background-color 0.3s, border-color 0.3s, color 0.3s;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            0% { transform: translateY(-10px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        
        .rotate-on-hover:hover {
            transform: rotate(15deg);
            transition: transform 0.3s ease;
        }
        
        /* Estilizando a barra de rolagem */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(93, 92, 222, 0.5);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(93, 92, 222, 0.8);
        }
        
        /* Loader */
        .loader {
            border: 3px solid rgba(93, 92, 222, 0.1);
            border-radius: 50%;
            border-top: 3px solid #5D5CDE;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Toast notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            animation: slideInRight 0.3s, fadeOut 0.5s 2.5s forwards;
            border-left: 4px solid;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        @keyframes slideInRight {
            0% { transform: translateX(100%); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            0% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }
        
        .toast-success { border-color: #34D399; }
        .toast-error { border-color: #F87171; }
        .toast-warning { border-color: #FBBF24; }
        .toast-info { border-color: #60A5FA; }
        
        /* Auth Container Styles */
        .auth-container {
            background-color: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(5px);
        }

        /* Progress Bar */
        .progress-bar {
            height: 8px;
            border-radius: 4px;
            transition: width 0.6s ease;
        }

        /* Active Tabs */
        .tab-active {
            border-bottom: 2px solid;
            color: #5D5CDE;
        }
        .dark .tab-active {
            color: #a7a4fd;
        }
        
        /* Glassmorphism cards */
        .glass-card {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        
        .dark .glass-card {
            background: rgba(17, 24, 39, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        
        /* Improved form inputs */
        .form-input:focus {
            border-color: #5D5CDE;
            box-shadow: 0 0 0 3px rgba(93, 92, 222, 0.25);
        }
        
        /* Animated icons */
        .icon-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        /* Weather icon animations */
        .icon-rain {
            animation: rain 1.5s infinite ease-in-out;
        }
        
        @keyframes rain {
            0% { transform: translateY(0) }
            50% { transform: translateY(3px) }
            100% { transform: translateY(0) }
        }
        
        .icon-sun {
            animation: rotate 10s infinite linear;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltip-text {
            visibility: hidden;
            width: 120px;
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: rgba(0, 0, 0, 0.8) transparent transparent transparent;
        }
        
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        /* Print styles */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .no-print {
                display: none !important;
            }
            
            .print-only {
                display: block !important;
            }
            
            .card, .bg-white, .dark\:bg-gray-800 {
                background: white !important;
                color: black !important;
                border: 1px solid #eaeaea !important;
                box-shadow: none !important;
            }
            
            td, th {
                color: black !important;
            }
        }
        
        /* Mobile optimizations */
        @media (max-width: 640px) {
            .mobile-card {
                padding: 0.75rem !important;
            }
            
            .mobile-text-sm {
                font-size: 0.875rem !important;
            }
            
            .mobile-compact-tabs .tab {
                padding: 0.5rem 0.75rem !important;
            }
        }
    </style>
    
    <!-- Detectar modo escuro -->
    <script>
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-100 min-h-screen">
    <!-- Authentication Container with improved UI -->
    <div id="auth-container" class="fixed inset-0 auth-container flex items-center justify-center z-50 fade-in">
        <div class="bg-white dark:bg-gray-800 p-8 rounded-xl shadow-xl w-full max-w-md transform transition-all duration-300">
            <div class="text-center mb-6">
                <div class="flex justify-center mb-4">
                    <div class="relative">
                        <i class="fas fa-tractor text-4xl text-primary-600 dark:text-primary-400"></i>
                        <span class="absolute top-0 right-0 h-3 w-3 rounded-full bg-green-400 animate-pulse"></span>
                    </div>
                </div>
                <h2 class="text-2xl font-bold text-primary-700 dark:text-primary-300">GGOMES-LOG</h2>
                <p class="text-gray-600 dark:text-gray-400">Sistema de Acompanhamento de Produção</p>
            </div>
            
            <!-- Login Form with improved styling -->
            <div id="login-form" class="space-y-4">
                <div class="group">
                    <label for="login-email" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Email</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-envelope text-gray-400 group-focus-within:text-primary-500 transition-colors"></i>
                        </div>
                        <input type="email" id="login-email" class="form-input w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200" placeholder="seu@email.com" required>
                    </div>
                </div>
                <div class="group">
                    <label for="login-password" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Senha</label>
                    <div class="relative">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <i class="fas fa-lock text-gray-400 group-focus-within:text-primary-500 transition-colors"></i>
                        </div>
                        <input type="password" id="login-password" class="form-input w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all duration-200" placeholder="********" required>
                        <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                            <button type="button" id="toggle-password" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <button id="btn-login" class="w-full bg-primary-600 hover:bg-primary-700 text-white px-4 py-3 rounded-lg transition duration-200 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-opacity-50 font-medium">
                    <i class="fas fa-sign-in-alt mr-2"></i> Entrar
                </button>
                
                <!-- Mensagem sobre criação de usuários -->
                <div class="text-center text-sm text-gray-600 dark:text-gray-400 mt-4">
                    <p>Novos usuários devem ser cadastrados por um administrador</p>
                </div>
            </div>
            
            <!-- Auth loader with improved animation -->
            <div id="auth-loader" class="flex flex-col items-center justify-center py-6 hidden">
                <div class="loader mb-4 w-12 h-12 border-4"></div>
                <span class="text-gray-600 dark:text-gray-400 animate-pulse">Autenticando...</span>
            </div>
        </div>
    </div>
    
    <!-- Toast notifications container -->
    <div id="toast-container"></div>
    
    <!-- Main container -->
    <div id="app-container" class="flex flex-col h-screen hidden">
        <!-- Header with improved responsive design -->
        <header class="bg-white dark:bg-gray-800 shadow-md px-4 py-2 sticky top-0 z-50">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="text-primary-700 dark:text-primary-300 p-2 bg-primary-100 dark:bg-primary-900/40 rounded-lg">
                        <i class="fas fa-tractor text-2xl"></i>
                    </div>
                    <h1 class="text-xl md:text-2xl font-bold text-primary-700 dark:text-primary-300 truncate">GGOMES-LOG</h1>
                </div>
                
                <div class="flex items-center space-x-1 md:space-x-4">
                    <!-- Weather widget -->
                    <div id="weather-widget" class="hidden md:flex items-center mr-2 bg-blue-50 dark:bg-blue-900/20 px-3 py-1 rounded-full">
                        <i id="weather-icon" class="fas fa-cloud-sun text-blue-500 mr-2"></i>
                        <span id="weather-temp" class="text-sm font-medium">--°C</span>
                    </div>
                    
                    <!-- Current date display -->
                    <div class="hidden md:flex items-center mr-2 bg-gray-100 dark:bg-gray-800 px-3 py-1 rounded-full">
                        <i class="far fa-calendar-alt text-gray-500 dark:text-gray-400 mr-2"></i>
                        <span id="current-date" class="text-sm font-medium"></span>
                    </div>
                    
                    <div class="text-sm text-gray-600 dark:text-gray-400 hidden md:block">
                        <span id="user-role-badge" class="px-2 py-1 rounded text-xs font-medium"></span>
                        <span id="user-name">Usuário</span>
                    </div>
                    
                    <button id="toggle-theme" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition tooltip">
                        <i class="fas fa-sun text-yellow-500 dark:hidden"></i>
                        <i class="fas fa-moon text-blue-300 hidden dark:block"></i>
                        <span class="tooltip-text">Alternar tema</span>
                    </button>
                    
                    <button id="btn-export-data" class="bg-secondary-600 hover:bg-secondary-700 text-white px-3 py-2 rounded-lg flex items-center transition transform hover:scale-105 tooltip">
                        <i class="fas fa-download"></i>
                        <span class="hidden md:inline ml-2">Exportar</span>
                        <span class="tooltip-text">Exportar Dados</span>
                    </button>
                    
                    <button id="btn-notifications" class="relative p-2 text-gray-500 hover:text-primary-600 dark:text-gray-400 dark:hover:text-primary-400 tooltip">
                        <i class="fas fa-bell"></i>
                        <span id="notification-badge" class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full">0</span>
                        <span class="tooltip-text">Notificações</span>
                    </button>
                    
                    <button id="btn-logout" class="bg-red-600 hover:bg-red-700 text-white p-2 rounded-lg transition transform hover:scale-105 tooltip">
                        <i class="fas fa-sign-out-alt"></i>
                        <span class="tooltip-text">Sair</span>
                    </button>
                </div>
            </div>
            
            <!-- Mobile search bar -->
            <div class="mt-2 relative lg:hidden">
                <input id="mobile-search" type="text" placeholder="Buscar..." class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                <div class="absolute inset-y-0 right-0 flex items-center pr-3">
                    <i class="fas fa-search text-gray-400"></i>
                </div>
            </div>
        </header>
        
        <!-- Main Content with improved layout -->
        <main class="flex-1 flex flex-col md:flex-row overflow-hidden">
            <!-- Sidebar Navigation with improved design -->
            <aside class="w-full md:w-64 bg-white dark:bg-gray-800 shadow-md md:h-full overflow-hidden">
                <!-- User profile summary at top of sidebar -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700 hidden md:block">
                    <div class="flex items-center space-x-3">
                        <div class="bg-primary-100 dark:bg-primary-900 p-2 rounded-full">
                            <i class="fas fa-user text-primary-600 dark:text-primary-400"></i>
                        </div>
                        <div>
                            <p id="sidebar-user-name" class="font-medium text-gray-800 dark:text-gray-200 text-sm truncate">Usuário</p>
                            <p id="sidebar-user-role" class="text-xs text-gray-500 dark:text-gray-400">Perfil</p>
                        </div>
                    </div>
                </div>
                
                <!-- Desktop search in sidebar -->
                <div class="p-4 border-b border-gray-200 dark:border-gray-700 hidden lg:block">
                    <div class="relative">
                        <input id="sidebar-search" type="text" placeholder="Buscar..." class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                        <div class="absolute inset-y-0 right-0 flex items-center pr-3">
                            <i class="fas fa-search text-gray-400"></i>
                        </div>
                    </div>
                </div>
                
                <nav class="flex md:flex-col p-1 md:p-0 space-x-1 md:space-x-0 md:space-y-0 overflow-x-auto md:overflow-x-visible">
                    <div class="p-2">
                        <h3 class="text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 px-3 mb-2">Principal</h3>
                        <a href="#dashboard" class="sidebar-link active flex items-center space-x-2 px-3 py-3 rounded-lg bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 transition-all">
                            <i class="fas fa-chart-line w-5 text-center"></i>
                            <span>Dashboard</span>
                        </a>
                        <a href="#colhedoras" class="sidebar-link flex items-center space-x-2 px-3 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all">
                            <i class="fas fa-tractor w-5 text-center"></i>
                            <span>Colhedoras</span>
                        </a>
                        <a href="#producao" class="sidebar-link flex items-center space-x-2 px-3 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all">
                            <i class="fas fa-cube w-5 text-center"></i>
                            <span>Registrar Produção</span>
                        </a>
                        <a href="#chuva" class="sidebar-link flex items-center space-x-2 px-3 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all">
                            <i class="fas fa-cloud-rain w-5 text-center"></i>
                            <span>Registro de Chuva</span>
                            <span class="ml-auto bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded-full">Novo</span>
                        </a>
                    </div>
                    
                    <div class="p-2">
                        <h3 class="text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 px-3 mb-2">Monitoramento</h3>
                        <a href="#registros" class="sidebar-link flex items-center space-x-2 px-3 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all">
                            <i class="fas fa-list w-5 text-center"></i>
                            <span>Histórico</span>
                        </a>
                        <a href="#caminhoes" class="sidebar-link flex items-center space-x-2 px-3 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all">
                            <i class="fas fa-truck w-5 text-center"></i>
                            <span>Caminhões</span>
                        </a>
                        <a href="#mapa" class="sidebar-link flex items-center space-x-2 px-3 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all">
                            <i class="fas fa-map-marked-alt w-5 text-center"></i>
                            <span>Mapa</span>
                            <span class="ml-auto bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full">Novo</span>
                        </a>
                    </div>
                    
                    <div class="p-2">
                        <h3 class="text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 px-3 mb-2">Sistema</h3>
                        <a href="#configuracoes" class="sidebar-link flex items-center space-x-2 px-3 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all">
                            <i class="fas fa-cog w-5 text-center"></i>
                            <span>Configurações</span>
                        </a>
                        <a href="#usuarios" class="sidebar-link admin-only flex items-center space-x-2 px-3 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all">
                            <i class="fas fa-users w-5 text-center"></i>
                            <span>Usuários</span>
                        </a>
                        <a href="#ajuda" class="sidebar-link flex items-center space-x-2 px-3 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all">
                            <i class="fas fa-question-circle w-5 text-center"></i>
                            <span>Ajuda</span>
                        </a>
                    </div>
                </nav>
            </aside>
            
            <!-- Content Area -->
            <div class="flex-1 overflow-auto p-4 bg-gray-50 dark:bg-gray-900">
                <!-- Dashboard Content -->
                <div id="content-dashboard" class="content fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-chart-line mr-3 text-primary-600 dark:text-primary-400"></i>
                            Dashboard
                        </h2>
                        
                        <!-- Quick Stats Bar -->
                        <div class="flex flex-wrap gap-2">
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-3 py-1.5 flex items-center">
                                <i class="fas fa-weight-hanging text-green-500 mr-2"></i>
                                <span id="quick-total-colhido" class="font-semibold">0 T</span>
                            </div>
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-3 py-1.5 flex items-center">
                                <i class="fas fa-ruler-combined text-blue-500 mr-2"></i>
                                <span id="quick-area-total" class="font-semibold">0 ha</span>
                            </div>
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-3 py-1.5 flex items-center">
                                <i class="fas fa-tractor text-purple-500 mr-2"></i>
                                <span id="quick-colhedoras" class="font-semibold">0</span>
                            </div>
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm px-3 py-1.5 flex items-center">
                                <i class="fas fa-cloud-rain text-red-500 mr-2"></i>
                                <span id="quick-paradas-chuva" class="font-semibold">0 dias</span>
                            </div>
                        </div>
                    </div>

                    <!-- Filtros de período com design melhorado -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                        <div class="flex flex-col md:flex-row justify-between items-center space-y-2 md:space-y-0">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-calendar-alt mr-2 text-primary-500"></i>
                                Visão Geral
                            </h3>
                            <div class="flex items-center space-x-2">
                                <label for="dashboard-period" class="text-sm text-gray-600 dark:text-gray-400">Período:</label>
                                <select id="dashboard-period" class="bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-sm px-3 py-1.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                    <option value="7">Últimos 7 dias</option>
                                    <option value="30" selected>Últimos 30 dias</option>
                                    <option value="90">Últimos 3 meses</option>
                                    <option value="180">Últimos 6 meses</option>
                                    <option value="365">Último ano</option>
                                </select>
                                <button id="refresh-dashboard" class="bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 p-2 rounded hover:bg-primary-200 dark:hover:bg-primary-800 transition transform hover:scale-105">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Cards de estatísticas principais com design melhorado -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 card-hover transform transition-all duration-300">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-sm font-medium">Total Colhido</p>
                                    <h3 id="dash-total-colhido" class="text-3xl font-bold text-gray-800 dark:text-white mt-1">0 T</h3>
                                </div>
                                <div class="bg-primary-100 dark:bg-primary-900 p-3 rounded-full">
                                    <i class="fas fa-weight-hanging text-xl text-primary-600 dark:text-primary-400"></i>
                                </div>
                            </div>
                            <div class="mt-3">
                                <div class="flex items-center">
                                    <span id="dash-total-trend" class="text-sm font-medium flex items-center">
                                        <i class="fas fa-arrow-up mr-1 text-green-500"></i>
                                        <span>0% vs. período anterior</span>
                                    </span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-2">
                                    <div id="dash-total-progress" class="bg-primary-600 h-1.5 rounded-full" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 card-hover transform transition-all duration-300">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-sm font-medium">Produtividade(DIA)</p>
                                    <h3 id="dash-area-total" class="text-3xl font-bold text-gray-800 dark:text-white mt-1">0 T/dia</h3>
                                </div>
                                <div class="bg-secondary-100 dark:bg-secondary-900 p-3 rounded-full">
                                    <i class="fas fa-ruler-combined text-xl text-secondary-600 dark:text-secondary-400"></i>
                                </div>
                            </div>
                            <div class="mt-3">
                                <div class="flex items-center">
                                    <span id="dash-area-trend" class="text-sm font-medium flex items-center">
                                        <i class="fas fa-arrow-up mr-1 text-green-500"></i>
                                        <span>0% vs. período anterior</span>
                                    </span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-2">
                                    <div id="dash-area-progress" class="bg-secondary-600 h-1.5 rounded-full" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 card-hover transform transition-all duration-300">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-sm font-medium">Produtividade Média</p>
                                    <h3 id="dash-produtividade" class="text-3xl font-bold text-gray-800 dark:text-white mt-1">0 T/ha</h3>
                                </div>
                                <div class="bg-accent-100 dark:bg-accent-900 p-3 rounded-full">
                                    <i class="fas fa-chart-line text-xl text-accent-600 dark:text-accent-400"></i>
                                </div>
                            </div>
                            <div class="mt-3">
                                <div class="flex items-center">
                                    <span id="dash-produtividade-trend" class="text-sm font-medium flex items-center">
                                        <i class="fas fa-arrow-up mr-1 text-green-500"></i>
                                        <span>0% vs. período anterior</span>
                                    </span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-2">
                                    <div id="dash-produtividade-progress" class="bg-accent-600 h-1.5 rounded-full" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 card-hover transform transition-all duration-300">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500 dark:text-gray-400 text-sm font-medium">Paradas por Chuva</p>
                                    <h3 id="dash-paradas-chuva" class="text-3xl font-bold text-gray-800 dark:text-white mt-1">0 dias</h3>
                                </div>
                                <div class="bg-red-100 dark:bg-red-900 p-3 rounded-full">
                                    <i class="fas fa-cloud-rain text-xl text-red-600 dark:text-red-400"></i>
                                </div>
                            </div>
                            <div class="mt-3">
                                <div class="flex items-center">
                                    <span id="dash-paradas-trend" class="text-sm font-medium flex items-center">
                                        <i class="fas fa-arrow-up mr-1 text-red-500"></i>
                                        <span>0% vs. período anterior</span>
                                    </span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-2">
                                    <div id="dash-paradas-progress" class="bg-red-600 h-1.5 rounded-full" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Gráficos principais com design melhorado -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <!-- Gráfico de produção ao longo do tempo -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 transform transition-all duration-300 hover:shadow-lg">
                            <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-chart-line mr-2 text-primary-500"></i>
                                Produção ao Longo do Tempo
                            </h3>
                            <div class="h-72 w-full">
                                <canvas id="chart-producao-tempo"></canvas>
                            </div>
                        </div>
                        
                        <!-- Gráfico de distribuição por cultura -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 transform transition-all duration-300 hover:shadow-lg">
                            <h3 class="text-lg font-semibold mb-3 text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-chart-pie mr-2 text-primary-500"></i>
                                Distribuição por Cultura
                            </h3>
                            <div class="h-72 w-full">
                                <canvas id="chart-culturas"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Seção de Desempenho com design melhorado -->
                    <div class="mb-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-trophy mr-2 text-yellow-500"></i>
                                Análise de Desempenho
                            </h3>
                            <div class="flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg p-1 mobile-compact-tabs">
                                <button class="dashboard-tab tab-active px-4 py-1.5 text-sm rounded-md transition-all" data-tab="colhedoras">Colhedoras</button>
                                <button class="dashboard-tab px-4 py-1.5 text-sm rounded-md transition-all" data-tab="culturas">Culturas</button>
                            </div>
                        </div>
                        
                        <!-- Conteúdo de tabs -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md">
                            <!-- Tab de Colhedoras -->
                            <div id="tab-colhedoras" class="dashboard-tab-content p-4">
                                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                                    <!-- Melhor produtividade -->
                                    <div class="bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/20 rounded-lg p-4 transform transition-all duration-300 hover:shadow-md">
                                        <div class="flex justify-between items-start">
                                            <div>
                                                <h4 class="text-sm font-medium text-green-800 dark:text-green-400">Melhor Produtividade</h4>
                                                <p id="best-productivity-colhedora" class="text-xl font-bold text-gray-800 dark:text-white mt-1">-</p>
                                                <p id="best-productivity-value" class="text-sm text-green-700 dark:text-green-400 font-medium">0 T/ha</p>
                                            </div>
                                            <div class="bg-green-200 dark:bg-green-700 p-2 rounded-full">
                                                <i class="fas fa-award text-green-600 dark:text-green-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Maior volume -->
                                    <div class="bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20 rounded-lg p-4 transform transition-all duration-300 hover:shadow-md">
                                        <div class="flex justify-between items-start">
                                            <div>
                                                <h4 class="text-sm font-medium text-blue-800 dark:text-blue-400">Maior Volume</h4>
                                                <p id="best-volume-colhedora" class="text-xl font-bold text-gray-800 dark:text-white mt-1">-</p>
                                                <p id="best-volume-value" class="text-sm text-blue-700 dark:text-blue-400 font-medium">0 T</p>
                                            </div>
                                            <div class="bg-blue-200 dark:bg-blue-700 p-2 rounded-full">
                                                <i class="fas fa-weight-hanging text-blue-600 dark:text-blue-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Melhor rendimento -->
                                    <div class="bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/20 rounded-lg p-4 transform transition-all duration-300 hover:shadow-md">
                                        <div class="flex justify-between items-start">
                                            <div>
                                                <h4 class="text-sm font-medium text-purple-800 dark:text-purple-400">Melhor Rendimento</h4>
                                                <p id="best-yield-colhedora" class="text-xl font-bold text-gray-800 dark:text-white mt-1">-</p>
                                                <p id="best-yield-value" class="text-sm text-purple-700 dark:text-purple-400 font-medium">0 T/h</p>
                                            </div>
                                            <div class="bg-purple-200 dark:bg-purple-700 p-2 rounded-full">
                                                <i class="fas fa-bolt text-purple-600 dark:text-purple-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Gráfico de comparação de colhedoras -->
                                <div class="mt-4 h-72">
                                    <canvas id="chart-colhedoras-comparacao"></canvas>
                                </div>
                            </div>
                            
                            <!-- Tab de Culturas -->
                            <div id="tab-culturas" class="dashboard-tab-content p-4 hidden">
                                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                                    <!-- Cultura mais produtiva -->
                                    <div class="bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/20 rounded-lg p-4 transform transition-all duration-300 hover:shadow-md">
                                        <div class="flex justify-between items-start">
                                            <div>
                                                <h4 class="text-sm font-medium text-green-800 dark:text-green-400">Cultura Mais Produtiva</h4>
                                                <p id="best-productivity-cultura" class="text-xl font-bold text-gray-800 dark:text-white mt-1">-</p>
                                                <p id="best-productivity-cultura-value" class="text-sm text-green-700 dark:text-green-400 font-medium">0 T/ha</p>
                                            </div>
                                            <div class="bg-green-200 dark:bg-green-700 p-2 rounded-full">
                                                <i class="fas fa-seedling text-green-600 dark:text-green-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Cultura com maior volume -->
                                    <div class="bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20 rounded-lg p-4 transform transition-all duration-300 hover:shadow-md">
                                        <div class="flex justify-between items-start">
                                            <div>
                                                <h4 class="text-sm font-medium text-blue-800 dark:text-blue-400">Maior Volume</h4>
                                                <p id="best-volume-cultura" class="text-xl font-bold text-gray-800 dark:text-white mt-1">-</p>
                                                <p id="best-volume-cultura-value" class="text-sm text-blue-700 dark:text-blue-400 font-medium">0 T</p>
                                            </div>
                                            <div class="bg-blue-200 dark:bg-blue-700 p-2 rounded-full">
                                                <i class="fas fa-weight-hanging text-blue-600 dark:text-blue-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Cultura com maior área -->
                                    <div class="bg-gradient-to-r from-yellow-50 to-yellow-100 dark:from-yellow-900/30 dark:to-yellow-800/20 rounded-lg p-4 transform transition-all duration-300 hover:shadow-md">
                                        <div class="flex justify-between items-start">
                                            <div>
                                                <h4 class="text-sm font-medium text-yellow-800 dark:text-yellow-400">Maior Área</h4>
                                                <p id="best-area-cultura" class="text-xl font-bold text-gray-800 dark:text-white mt-1">-</p>
                                                <p id="best-area-cultura-value" class="text-sm text-yellow-700 dark:text-yellow-400 font-medium">0 ha</p>
                                            </div>
                                            <div class="bg-yellow-200 dark:bg-yellow-700 p-2 rounded-full">
                                                <i class="fas fa-ruler-combined text-yellow-600 dark:text-yellow-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Gráfico de comparação de culturas -->
                                <div class="mt-4 h-72">
                                    <canvas id="chart-culturas-comparacao"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Estatísticas de Caminhões com design melhorado -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                            <i class="fas fa-truck mr-2 text-primary-600 dark:text-primary-400"></i>
                            Estatísticas de Caminhões
                        </h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 card-hover transform transition-all duration-300">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-500 dark:text-gray-400 text-sm font-medium">Tempo Médio de Campo</p>
                                        <h3 id="dash-tempo-campo" class="text-3xl font-bold text-gray-800 dark:text-white mt-1">0 min</h3>
                                    </div>
                                    <div class="bg-green-100 dark:bg-green-900 p-3 rounded-full">
                                        <i class="fas fa-tractor text-xl text-green-600 dark:text-green-400"></i>
                                    </div>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-3">
                                    <div id="dash-tempo-campo-progress" class="bg-green-600 h-1.5 rounded-full" style="width: 45%"></div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 card-hover transform transition-all duration-300">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-500 dark:text-gray-400 text-sm font-medium">Tempo Médio de Pátio</p>
                                        <h3 id="dash-tempo-patio" class="text-3xl font-bold text-gray-800 dark:text-white mt-1">0 min</h3>
                                    </div>
                                    <div class="bg-blue-100 dark:bg-blue-900 p-3 rounded-full">
                                        <i class="fas fa-warehouse text-xl text-blue-600 dark:text-blue-400"></i>
                                    </div>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mt-3">
                                    <div id="dash-tempo-patio-progress" class="bg-blue-600 h-1.5 rounded-full" style="width: 30%"></div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 card-hover transform transition-all duration-300">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-gray-500 dark:text-gray-400 text-sm font-medium">Registros de Caminhões</p>
                                        <h3 id="dash-total-caminhoes" class="text-3xl font-bold text-gray-800 dark:text-white mt-1">0</h3>
                                    </div>
                                    <div class="bg-yellow-100 dark:bg-yellow-900 p-3 rounded-full">
                                        <i class="fas fa-truck text-xl text-yellow-600 dark:text-yellow-400"></i>
                                    </div>
                                </div>
                                <div class="flex items-center mt-2">
                                    <span id="dash-caminhoes-trend" class="text-sm font-medium flex items-center">
                                        <i class="fas fa-arrow-up mr-1 text-green-500"></i>
                                        <span>0% vs. período anterior</span>
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Gráfico de tempos de caminhões -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mt-4 transform transition-all duration-300 hover:shadow-lg">
                            <h4 class="text-base font-semibold mb-3 text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-chart-bar mr-2 text-primary-500"></i>
                                Análise de Tempos de Caminhões
                            </h4>
                            <div class="h-72">
                                <canvas id="chart-caminhoes-tempo"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Nova seção: Previsão do Tempo e Alertas -->
                    <div class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Previsão do Tempo -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 transform transition-all duration-300 hover:shadow-lg">
                            <h3 class="text-xl font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-cloud-sun mr-2 text-blue-500 dark:text-blue-400"></i>
                                Previsão do Tempo
                            </h3>
                            
                            <div class="flex flex-wrap gap-4">
                                <!-- Tempo Atual -->
                                <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/20 p-4 rounded-lg flex-grow">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="text-sm text-blue-800 dark:text-blue-300">Hoje</p>
                                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1">28°C</p>
                                            <p class="text-sm text-blue-700 dark:text-blue-400">Parcialmente nublado</p>
                                        </div>
                                        <div class="text-5xl text-blue-500 dark:text-blue-400">
                                            <i class="fas fa-cloud-sun icon-sun"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Próximos Dias -->
                                <div class="flex flex-wrap gap-2 justify-around flex-grow">
                                    <div class="text-center p-2">
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Amanhã</p>
                                        <i class="fas fa-sun text-2xl text-yellow-500 mt-1 mb-1"></i>
                                        <p class="text-sm font-bold">30°C</p>
                                    </div>
                                    <div class="text-center p-2">
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Quarta</p>
                                        <i class="fas fa-cloud-rain text-2xl text-blue-500 mt-1 mb-1 icon-rain"></i>
                                        <p class="text-sm font-bold">24°C</p>
                                    </div>
                                    <div class="text-center p-2">
                                        <p class="text-xs text-gray-600 dark:text-gray-400">Quinta</p>
                                        <i class="fas fa-cloud text-2xl text-gray-500 mt-1 mb-1"></i>
                                        <p class="text-sm font-bold">26°C</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Informações de clima para agricultura -->
                            <div class="mt-4 border-t border-gray-200 dark:border-gray-700 pt-3">
                                <div class="grid grid-cols-3 gap-2 text-center">
                                    <div>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Umidade</p>
                                        <p class="font-medium">65%</p>
                                    </div>
                                    <div>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Vento</p>
                                        <p class="font-medium">12 km/h</p>
                                    </div>
                                    <div>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Chuva (7d)</p>
                                        <p class="font-medium">15mm</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Alertas e Notificações -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 transform transition-all duration-300 hover:shadow-lg">
                            <h3 class="text-xl font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-bell mr-2 text-yellow-500"></i>
                                Alertas e Lembretes
                            </h3>
                            
                            <div class="space-y-3">
                                <div class="bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg border-l-4 border-yellow-500">
                                    <div class="flex items-start">
                                        <i class="fas fa-exclamation-circle text-yellow-500 mt-0.5 mr-2"></i>
                                        <div>
                                            <p class="font-medium text-yellow-800 dark:text-yellow-300">Manutenção Programada</p>
                                            <p class="text-sm text-yellow-700 dark:text-yellow-400">Colhedora 001 - Troca de óleo em 2 dias</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border-l-4 border-blue-500">
                                    <div class="flex items-start">
                                        <i class="fas fa-cloud-rain text-blue-500 mt-0.5 mr-2"></i>
                                        <div>
                                            <p class="font-medium text-blue-800 dark:text-blue-300">Alerta de Clima</p>
                                            <p class="text-sm text-blue-700 dark:text-blue-400">Previsão de chuva para quarta-feira (15mm)</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-green-50 dark:bg-green-900/20 p-3 rounded-lg border-l-4 border-green-500">
                                    <div class="flex items-start">
                                        <i class="fas fa-seedling text-green-500 mt-0.5 mr-2"></i>
                                        <div>
                                            <p class="font-medium text-green-800 dark:text-green-300">Meta de Colheita</p>
                                            <p class="text-sm text-green-700 dark:text-green-400">75% da meta mensal alcançada (3750T/5000T)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Botão para adicionar lembrete -->
                            <button class="mt-4 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg w-full flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600 transition">
                                <i class="fas fa-plus mr-2"></i>
                                Adicionar Lembrete
                            </button>
                        </div>
                    </div>
                    
                    <!-- Paradas por Chuva - Nova seção -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                            <i class="fas fa-cloud-rain mr-2 text-red-600 dark:text-red-400"></i>
                            Paradas por Chuva
                        </h3>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5">
                            <div class="flex flex-col lg:flex-row justify-between mb-4">
                                <h4 class="text-base font-semibold text-gray-800 dark:text-white mb-2 lg:mb-0">Histórico de Paradas</h4>
                                <div class="flex items-center space-x-2">
                                    <label for="paradas-period" class="text-sm text-gray-600 dark:text-gray-400">Período:</label>
                                    <select id="paradas-period" class="bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-sm px-3 py-1.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                        <option value="30" selected>30 dias</option>
                                        <option value="90">3 meses</option>
                                        <option value="180">6 meses</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Gráfico de paradas por chuva -->
                            <div class="h-64">
                                <canvas id="chart-paradas-chuva"></canvas>
                            </div>
                            
                            <!-- Estatísticas de paradas -->
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg text-center">
                                    <h5 class="text-sm text-gray-500 dark:text-gray-400">Total de Dias Parados</h5>
                                    <p id="total-dias-chuva" class="text-2xl font-bold text-red-600 dark:text-red-400">0 dias</p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg text-center">
                                    <h5 class="text-sm text-gray-500 dark:text-gray-400">Dias com Paradas</h5>
                                    <p id="total-ocorrencias-chuva" class="text-2xl font-bold text-blue-600 dark:text-blue-400">0</p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg text-center">
                                    <h5 class="text-sm text-gray-500 dark:text-gray-400">Impacto Estimado</h5>
                                    <p id="impacto-estimado-chuva" class="text-2xl font-bold text-orange-600 dark:text-orange-400">0 T</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Resumo do Dashboard com design melhorado -->
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                            <i class="fas fa-info-circle mr-2 text-primary-600 dark:text-primary-400"></i>
                            Resumo da Atividade
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">
                            Bem-vindo ao dashboard do GGOMES-LOG. Aqui você encontrará um resumo das atividades 
                            de produção e poderá acompanhar as principais métricas do sistema.
                        </p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                <h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center">
                                    <i class="fas fa-tractor text-primary-500 mr-2"></i>
                                    Colhedoras Registradas
                                </h4>
                                <div class="flex items-end">
                                    <p id="qtd-colhedoras" class="text-2xl font-bold text-primary-700 dark:text-primary-300">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 ml-2 mb-1">unidades</p>
                                </div>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                <h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center">
                                    <i class="fas fa-clipboard-list text-secondary-500 mr-2"></i>
                                    Registros de Produção
                                </h4>
                                <div class="flex items-end">
                                    <p id="qtd-registros" class="text-2xl font-bold text-secondary-700 dark:text-secondary-300">0</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 ml-2 mb-1">registros</p>
                                </div>
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
                                <h4 class="font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center">
                                    <i class="fas fa-users text-accent-500 mr-2"></i>
                                    Usuários Ativos
                                </h4>
                                <div class="flex items-end">
                                    <p id="qtd-usuarios" class="text-2xl font-bold text-accent-700 dark:text-accent-300">1</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 ml-2 mb-1">usuários</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Colhedoras Content -->
                <div id="content-colhedoras" class="content hidden fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-tractor mr-3 text-primary-600 dark:text-primary-400"></i>
                            Colhedoras
                        </h2>
                        <button id="btn-add-colhedora" class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg flex items-center transition transform hover:scale-105">
                            <i class="fas fa-plus mr-2"></i>
                            Nova Colhedora
                        </button>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                            <i class="fas fa-list mr-2 text-primary-500"></i>
                            Lista de Colhedoras
                        </h3>
                        
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            ID / Modelo
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Marca
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Ano
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Ações
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-colhedoras-lista" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Lista de colhedoras será inserida aqui via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                            <i class="fas fa-plus-circle mr-2 text-primary-500"></i>
                            Adicionar/Editar Colhedora
                        </h3>
                        
                        <form id="form-colhedora" class="space-y-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="colhedora-id" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">ID da Colhedora*</label>
                                    <input type="text" id="colhedora-id" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                </div>
                                <div>
                                    <label for="colhedora-modelo" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Modelo*</label>
                                    <input type="text" id="colhedora-modelo" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label for="colhedora-marca" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Marca</label>
                                    <input type="text" id="colhedora-marca" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label for="colhedora-ano" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Ano</label>
                                    <input type="number" id="colhedora-ano" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                </div>
                            </div>
                            
                            <div>
                                <label for="colhedora-observacoes" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Observações</label>
                                <textarea id="colhedora-observacoes" rows="3" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"></textarea>
                            </div>
                            
                            <div class="flex justify-end space-x-3">
                                <button type="reset" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg transition">
                                    <i class="fas fa-times mr-2"></i> Cancelar
                                </button>
                                <button type="submit" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition">
                                    <i class="fas fa-save mr-2"></i> Salvar Colhedora
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Registros Content -->
                <div id="content-registros" class="content hidden fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-list mr-3 text-primary-600 dark:text-primary-400"></i>
                            Histórico de Registros
                        </h2>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                            <i class="fas fa-filter mr-2 text-primary-500"></i>
                            Filtros
                        </h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <div>
                                <label for="filtro-colhedora" class="block mb-1 text-gray-700 dark:text-gray-300 text-sm font-medium">Colhedora</label>
                                <select id="filtro-colhedora" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                    <option value="">Todas</option>
                                    <!-- Será preenchido via JavaScript -->
                                </select>
                            </div>
                            <div>
                                <label for="filtro-cultura" class="block mb-1 text-gray-700 dark:text-gray-300 text-sm font-medium">Cultura</label>
                                <select id="filtro-cultura" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                    <option value="">Todas</option>
                                    <!-- Será preenchido via JavaScript -->
                                </select>
                            </div>
                            <div>
                                <label for="filtro-data-inicio" class="block mb-1 text-gray-700 dark:text-gray-300 text-sm font-medium">Data Início</label>
                                <input type="date" id="filtro-data-inicio" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            </div>
                            <div>
                                <label for="filtro-data-fim" class="block mb-1 text-gray-700 dark:text-gray-300 text-sm font-medium">Data Fim</label>
                                <input type="date" id="filtro-data-fim" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            </div>
                        </div>
                        
                        <div class="flex justify-end mt-4">
                            <button id="btn-limpar-filtros" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg transition mr-2">
                                <i class="fas fa-eraser mr-2"></i> Limpar
                            </button>
                            <button id="btn-aplicar-filtros" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition">
                                <i class="fas fa-filter mr-2"></i> Aplicar Filtros
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-history mr-2 text-primary-500"></i>
                                Histórico de Produção
                            </h3>
                            <p class="text-sm text-gray-600 dark:text-gray-400">
                                <span id="registros-contagem">0</span> registros encontrados
                            </p>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Data
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Colhedora
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Cultura
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Quantidade (T)
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Área (ha)
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Horas
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            T/ha
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            T/h
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Ações
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-registros" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Será preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div class="flex justify-between items-center mt-4">
                            <div>
                                <p id="paginacao-info" class="text-sm text-gray-600 dark:text-gray-400">
                                    Página 1 de 1
                                </p>
                            </div>
                            <div class="flex space-x-2">
                                <button id="btn-pagina-anterior" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded transition" disabled>
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button id="btn-proxima-pagina" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded transition" disabled>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Producao Content -->
                <div id="content-producao" class="content hidden fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-cube mr-3 text-primary-600 dark:text-primary-400"></i>
                            Registrar Produção
                        </h2>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div class="lg:col-span-2">
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-plus-circle mr-2 text-primary-500"></i>
                                    Novo Registro
                                </h3>
                                
                                <form id="form-registro" class="space-y-4">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label for="registro-data" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Data*</label>
                                            <input type="date" id="registro-data" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                        </div>
                                        <div>
                                            <label for="registro-colhedora" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Colhedora*</label>
                                            <select id="registro-colhedora" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                                <option value="">Selecione uma colhedora</option>
                                                <!-- Será preenchido via JavaScript -->
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label for="registro-cultura" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Cultura*</label>
                                            <input type="text" id="registro-cultura" list="lista-culturas" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                            <datalist id="lista-culturas">
                                                <!-- Será preenchido via JavaScript -->
                                            </datalist>
                                        </div>
                                        <div>
                                            <label for="registro-quantidade" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Quantidade (T)*</label>
                                            <input type="number" id="registro-quantidade" min="0" step="0.01" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                        </div>
                                        <div>
                                            <label for="registro-area" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Área (ha)*</label>
                                            <input type="number" id="registro-area" min="0" step="0.01" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label for="registro-horas" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Horas Trabalhadas</label>
                                            <input type="number" id="registro-horas" min="0" step="0.1" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                        </div>
                                        <div>
                                            <label for="registro-combustivel" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Combustível (L)</label>
                                            <input type="number" id="registro-combustivel" min="0" step="0.1" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label for="registro-observacoes" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Observações</label>
                                        <textarea id="registro-observacoes" rows="3" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"></textarea>
                                    </div>
                                    
                                    <div class="flex justify-end space-x-3">
                                        <button type="reset" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg transition">
                                            <i class="fas fa-times mr-2"></i> Limpar
                                        </button>
                                        <button type="submit" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition">
                                            <i class="fas fa-save mr-2"></i> Salvar Registro
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <div>
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-chart-pie mr-2 text-primary-500"></i>
                                    Resumo de Produção
                                </h3>
                                
                                <div class="space-y-3">
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total Colhido</p>
                                        <p id="total-colhido" class="text-2xl font-bold text-gray-800 dark:text-white">0 T</p>
                                    </div>
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Área Total</p>
                                        <p id="area-total" class="text-2xl font-bold text-gray-800 dark:text-white">0 ha</p>
                                    </div>
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Produtividade Média</p>
                                        <p id="produtividade-media" class="text-2xl font-bold text-gray-800 dark:text-white">0 T/ha</p>
                                    </div>
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Rendimento Médio</p>
                                        <p id="rendimento-medio" class="text-2xl font-bold text-gray-800 dark:text-white">0 T/h</p>
                                    </div>
                                    <div class="p-3 bg-red-50 dark:bg-red-900/20 rounded-lg">
                                        <p class="text-sm text-red-500 dark:text-red-400">Dias Parados (Chuva)</p>
                                        <p id="paradas-chuva-total" class="text-2xl font-bold text-red-600 dark:text-red-400">0 dias</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-tractor mr-2 text-primary-500"></i>
                                    Estatísticas por Colhedora
                                </h3>
                                
                                <div class="overflow-x-auto max-h-96 overflow-y-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700 sticky top-0">
                                            <tr>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Colhedora
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Total (T)
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Área (ha)
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    T/ha
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-colhedoras" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Será preenchido via JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Nova seção: Registro de Chuva -->
                <div id="content-chuva" class="content hidden fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-cloud-rain mr-3 text-primary-600 dark:text-primary-400"></i>
                            Registro de Chuva
                        </h2>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div class="lg:col-span-2">
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-plus-circle mr-2 text-primary-500"></i>
                                    Registrar Parada por Chuva
                                </h3>
                                
                                <form id="form-chuva" class="space-y-4">
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label for="chuva-data-inicio" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Data Início*</label>
                                            <input type="date" id="chuva-data-inicio" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                        </div>
                                        <div>
                                            <label for="chuva-data-fim" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Data Fim*</label>
                                            <input type="date" id="chuva-data-fim" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                        </div>
                                    </div>
                                    
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label for="chuva-dias" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Total de Dias Parados*</label>
                                            <input type="number" id="chuva-dias" min="0.5" step="0.5" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Pode incluir meio dia (0.5)</p>
                                        </div>
                                        <div>
                                            <label for="chuva-intensidade" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Intensidade</label>
                                            <select id="chuva-intensidade" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                                <option value="baixa">Baixa</option>
                                                <option value="media">Média</option>
                                                <option value="alta">Alta</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label for="chuva-observacoes" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Observações</label>
                                        <textarea id="chuva-observacoes" rows="3" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="Descreva as condições climáticas, impactos, etc."></textarea>
                                    </div>
                                    
                                    <div class="flex justify-end space-x-3">
                                        <button type="reset" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg transition">
                                            <i class="fas fa-times mr-2"></i> Limpar
                                        </button>
                                        <button type="submit" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition">
                                            <i class="fas fa-save mr-2"></i> Salvar Registro
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <div>
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-cloud-showers-heavy mr-2 text-blue-500"></i>
                                    Resumo de Paradas
                                </h3>
                                
                                <div class="space-y-3">
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total de Paradas</p>
                                        <p id="chuva-total-registros" class="text-2xl font-bold text-gray-800 dark:text-white">0 registros</p>
                                    </div>
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Dias Parados (Total)</p>
                                        <p id="chuva-total-dias" class="text-2xl font-bold text-red-600 dark:text-red-400">0 dias</p>
                                    </div>
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Última Parada</p>
                                        <p id="chuva-ultima-parada" class="text-2xl font-bold text-gray-800 dark:text-white">-</p>
                                    </div>
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Impacto Estimado</p>
                                        <p id="chuva-impacto-estimado" class="text-2xl font-bold text-orange-600 dark:text-orange-400">0 T</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-chart-bar mr-2 text-primary-500"></i>
                                    Estatísticas Mensais
                                </h3>
                                
                                <div class="h-56">
                                    <canvas id="chart-chuva-mensal"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-history mr-2 text-primary-500"></i>
                                Histórico de Paradas por Chuva
                            </h3>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Período
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Dias Parados
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Intensidade
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Observações
                                        </th>
                                        <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                            Ações
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-chuvas" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- Será preenchido via JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Caminhoes Content -->
                <div id="content-caminhoes" class="content hidden fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-truck mr-3 text-primary-600 dark:text-primary-400"></i>
                            Caminhões
                        </h2>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div class="lg:col-span-1">
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-plus-circle mr-2 text-primary-500"></i>
                                    Registrar Caminhão
                                </h3>
                                
                                <form id="form-caminhao" class="space-y-4">
                                    <div>
                                        <label for="caminhao-data" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Data*</label>
                                        <input type="date" id="caminhao-data" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label for="caminhao-id" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">ID do Caminhão*</label>
                                        <input type="text" id="caminhao-id" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label for="caminhao-tempo-campo" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Tempo de Campo (min)*</label>
                                        <input type="number" id="caminhao-tempo-campo" min="0" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label for="caminhao-tempo-patio" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Tempo de Pátio (min)*</label>
                                        <input type="number" id="caminhao-tempo-patio" min="0" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label for="caminhao-observacoes" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Observações</label>
                                        <textarea id="caminhao-observacoes" rows="3" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"></textarea>
                                    </div>
                                    
                                    <div class="flex justify-end space-x-3">
                                        <button type="reset" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg transition">
                                            <i class="fas fa-times mr-2"></i> Limpar
                                        </button>
                                        <button type="submit" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition">
                                            <i class="fas fa-save mr-2"></i> Salvar
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <div class="lg:col-span-2">
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4">
                                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white flex items-center">
                                        <i class="fas fa-chart-bar mr-2 text-primary-500"></i>
                                        Estatísticas
                                    </h3>
                                    <div class="flex items-center space-x-2">
                                        <label for="data-filtro-caminhoes" class="text-sm text-gray-600 dark:text-gray-400">Filtrar por data:</label>
                                        <input type="date" id="data-filtro-caminhoes" class="bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-sm px-3 py-1.5 focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                        <button id="btn-filtrar-caminhoes" class="bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 p-1.5 rounded hover:bg-primary-200 dark:hover:bg-primary-800 transition">
                                            <i class="fas fa-filter"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Tempo Médio de Campo</p>
                                        <p id="media-campo" class="text-2xl font-bold text-gray-800 dark:text-white">0 min</p>
                                    </div>
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Tempo Médio de Pátio</p>
                                        <p id="media-patio" class="text-2xl font-bold text-gray-800 dark:text-white">0 min</p>
                                    </div>
                                    <div class="p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                        <p class="text-sm text-gray-500 dark:text-gray-400">Total de Registros</p>
                                        <p id="total-registros-caminhoes" class="text-2xl font-bold text-gray-800 dark:text-white">0</p>
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="md:col-span-1">
                                        <h4 class="font-medium text-gray-800 dark:text-white mb-2 border-b border-gray-200 dark:border-gray-700 pb-1">
                                            Tempo Total Médio
                                        </h4>
                                        <p id="tempo-total-medio" class="text-xl font-bold text-primary-600 dark:text-primary-400">0 min</p>
                                    </div>
                                    <div class="md:col-span-2">
                                        <h4 class="font-medium text-gray-800 dark:text-white mb-2 border-b border-gray-200 dark:border-gray-700 pb-1">
                                            Médias por Caminhão
                                        </h4>
                                        <div class="overflow-x-auto">
                                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                                <thead class="bg-gray-50 dark:bg-gray-700">
                                                    <tr>
                                                        <th scope="col" class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                            Caminhão
                                                        </th>
                                                        <th scope="col" class="px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                            Campo
                                                        </th>
                                                        <th scope="col" class="px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                            Pátio
                                                        </th>
                                                        <th scope="col" class="px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                            Total
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody id="tabela-medias-caminhoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                                    <!-- Será preenchido via JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-history mr-2 text-primary-500"></i>
                                    Histórico de Caminhões
                                </h3>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Data
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Caminhão
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Campo (min)
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Pátio (min)
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Total (min)
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Ações
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-historico-caminhoes" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Será preenchido via JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Configuracoes Content -->
                <div id="content-configuracoes" class="content hidden fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-cog mr-3 text-primary-600 dark:text-primary-400"></i>
                            Configurações
                        </h2>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4">
                            <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-sliders-h mr-2 text-primary-500"></i>
                                Configurações Gerais
                            </h3>
                            
                            <form id="form-config-geral" class="space-y-4">
                                <div>
                                    <label class="flex items-center">
                                        <input type="checkbox" id="config-tema-escuro" class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500">
                                        <span class="ml-2 text-gray-700 dark:text-gray-300">Usar tema escuro</span>
                                    </label>
                                </div>
                                
                                <div>
                                    <label for="config-registros-pagina" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Registros por página</label>
                                    <select id="config-registros-pagina" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                        <option value="10">10</option>
                                        <option value="25">25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label for="config-formato-data" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Formato de data</label>
                                    <select id="config-formato-data" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                        <option value="dd/MM/yyyy">DD/MM/AAAA</option>
                                        <option value="MM/dd/yyyy">MM/DD/AAAA</option>
                                        <option value="yyyy-MM-dd">AAAA-MM-DD</option>
                                    </select>
                                </div>
                                
                                <div class="flex justify-end">
                                    <button type="submit" class="px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition">
                                        <i class="fas fa-save mr-2"></i> Salvar Configurações
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4">
                            <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-database mr-2 text-primary-500"></i>
                                Gerenciamento de Dados
                            </h3>
                            
                            <form id="form-config-dados" class="space-y-4">
                                <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                    <h4 class="text-base font-medium text-blue-800 dark:text-blue-300 mb-2">Exportar Dados</h4>
                                    <p class="text-sm text-blue-600 dark:text-blue-400 mb-3">
                                        Faça backup de todos os seus dados do sistema em arquivos externos.
                                    </p>
                                    <div class="flex space-x-2">
                                        <button type="button" id="btn-exportar-json" class="px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition flex-1 flex items-center justify-center">
                                            <i class="fas fa-download mr-2"></i> Exportar JSON
                                        </button>
                                        <button type="button" id="btn-exportar-pdf" class="px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition flex-1 flex items-center justify-center">
                                            <i class="fas fa-file-pdf mr-2"></i> Relatório PDF
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg">
                                    <h4 class="text-base font-medium text-yellow-800 dark:text-yellow-300 mb-2">Importar Dados</h4>
                                    <p class="text-sm text-yellow-600 dark:text-yellow-400 mb-3">
                                        Restaure dados a partir de um arquivo de backup JSON.
                                    </p>
                                    <div class="flex items-center space-x-2">
                                        <input type="file" id="input-importar-json" accept=".json" class="hidden">
                                        <button type="button" id="btn-selecionar-arquivo" class="px-3 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition flex-1 flex items-center justify-center">
                                            <i class="fas fa-upload mr-2"></i> Selecionar Arquivo
                                        </button>
                                        <button type="button" id="btn-importar-json" class="px-3 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition flex-1 flex items-center justify-center" disabled>
                                            <i class="fas fa-file-import mr-2"></i> Importar
                                        </button>
                                    </div>
                                    <p id="arquivo-selecionado" class="text-xs text-gray-500 dark:text-gray-400 mt-2">
                                        Nenhum arquivo selecionado
                                    </p>
                                </div>
                                
                                <div class="p-4 bg-red-50 dark:bg-red-900/20 rounded-lg">
                                    <h4 class="text-base font-medium text-red-800 dark:text-red-300 mb-2">Limpar Dados</h4>
                                    <p class="text-sm text-red-600 dark:text-red-400 mb-3">
                                        Cuidado! Esta ação removerá todos os dados do sistema.
                                    </p>
                                    <button type="button" id="btn-limpar-dados" class="px-3 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition flex items-center justify-center">
                                        <i class="fas fa-trash-alt mr-2"></i> Limpar Todos os Dados
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
                <!-- Usuarios Content -->
                <div id="content-usuarios" class="content hidden fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-users mr-3 text-primary-600 dark:text-primary-400"></i>
                            Gerenciamento de Usuários
                        </h2>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div class="lg:col-span-2">
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-user-friends mr-2 text-primary-500"></i>
                                    Lista de Usuários
                                </h3>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Nome
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Email
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Tipo
                                                </th>
                                                <th scope="col" class="px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                                    Ações
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="tabela-usuarios" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <!-- Será preenchido via JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="lg:col-span-1">
                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4">
                                <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                    <i class="fas fa-user-plus mr-2 text-primary-500"></i>
                                    Adicionar Usuário
                                </h3>
                                
                                <form id="form-usuario" class="space-y-4">
                                    <div>
                                        <label for="nome-usuario" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Nome*</label>
                                        <input type="text" id="nome-usuario" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label for="email-usuario" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Email*</label>
                                        <input type="email" id="email-usuario" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label for="senha-usuario" class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Senha*</label>
                                        <input type="password" id="senha-usuario" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent" required>
                                    </div>
                                    <div>
                                        <label class="block mb-1 text-gray-700 dark:text-gray-300 font-medium">Tipo de Usuário*</label>
                                        <div class="flex space-x-4">
                                            <label class="flex items-center">
                                                <input type="radio" name="tipo-usuario" value="usuario" class="w-4 h-4 text-primary-600 border-gray-300 focus:ring-primary-500" checked>
                                                <span class="ml-2 text-gray-700 dark:text-gray-300">Usuário</span>
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="tipo-usuario" value="admin" class="w-4 h-4 text-primary-600 border-gray-300 focus:ring-primary-500">
                                                <span class="ml-2 text-gray-700 dark:text-gray-300">Administrador</span>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <button type="submit" class="w-full bg-primary-600 hover:bg-primary-700 text-white px-4 py-3 rounded-lg transition">
                                        <i class="fas fa-user-plus mr-2"></i> Adicionar Usuário
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Ajuda Content -->
                <div id="content-ajuda" class="content hidden fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-question-circle mr-3 text-primary-600 dark:text-primary-400"></i>
                            Ajuda
                        </h2>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4">
                            <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-book mr-2 text-primary-500"></i>
                                Guia do Usuário
                            </h3>
                            
                            <div class="space-y-4">
                                <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <h4 class="font-medium text-gray-800 dark:text-white mb-2">Navegação Básica</h4>
                                    <p class="text-gray-600 dark:text-gray-400 text-sm">
                                        O sistema possui um menu lateral com as principais funções. Clique nas opções para navegar entre as páginas.
                                    </p>
                                </div>
                                
                                <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <h4 class="font-medium text-gray-800 dark:text-white mb-2">Dashboard</h4>
                                    <p class="text-gray-600 dark:text-gray-400 text-sm">
                                        No Dashboard você encontra um resumo das atividades de produção, gráficos de acompanhamento e estatísticas gerais.
                                    </p>
                                </div>
                                
                                <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <h4 class="font-medium text-gray-800 dark:text-white mb-2">Registro de Produção</h4>
                                    <p class="text-gray-600 dark:text-gray-400 text-sm">
                                        Para registrar a produção, acesse o menu "Registrar Produção", preencha os dados do formulário e clique em "Salvar Registro".
                                    </p>
                                </div>
                                
                                <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                    <h4 class="font-medium text-blue-800 dark:text-blue-300 mb-2">Registro de Chuva</h4>
                                    <p class="text-blue-600 dark:text-blue-400 text-sm">
                                        Novo! Agora você pode registrar os dias parados por chuva na aba específica, o que permite melhor análise do impacto climático na produção.
                                    </p>
                                </div>
                                
                                <div class="p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                    <h4 class="font-medium text-gray-800 dark:text-white mb-2">Histórico e Relatórios</h4>
                                    <p class="text-gray-600 dark:text-gray-400 text-sm">
                                        Na opção "Histórico" você pode visualizar todos os registros de produção, aplicar filtros e exportar relatórios.
                                    </p>
                                </div>
                            </div>
                            
                            <button class="mt-4 w-full bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg transition flex items-center justify-center">
                                <i class="fas fa-download mr-2"></i> Baixar Manual Completo
                            </button>
                        </div>
                        
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4">
                            <h3 class="text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center">
                                <i class="fas fa-headset mr-2 text-primary-500"></i>
                                Suporte Técnico
                            </h3>
                            
                            <div class="space-y-4">
                                <div class="p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                                    <h4 class="font-medium text-blue-800 dark:text-blue-300 mb-2">Contato por Email</h4>
                                    <p class="text-blue-600 dark:text-blue-400 text-sm mb-2">
                                        Envie suas dúvidas ou sugestões para nossa equipe de suporte.
                                    </p>
                                    <a href="mailto:suporte@ggomes.com" class="text-blue-700 dark:text-blue-300 flex items-center">
                                        <i class="fas fa-envelope mr-2"></i>
                                        suporte@ggomes.com
                                    </a>
                                </div>
                                
                                <div class="p-4 bg-green-50 dark:bg-green-900/20 rounded-lg">
                                    <h4 class="font-medium text-green-800 dark:text-green-300 mb-2">WhatsApp</h4>
                                    <p class="text-green-600 dark:text-green-400 text-sm mb-2">
                                        Suporte rápido via WhatsApp, disponível em horário comercial.
                                    </p>
                                    <a href="#" class="text-green-700 dark:text-green-300 flex items-center">
                                        <i class="fab fa-whatsapp mr-2"></i>
                                        +55 (11) 99999-9999
                                    </a>
                                </div>
                                
                                <div class="p-4 bg-purple-50 dark:bg-purple-900/20 rounded-lg">
                                    <h4 class="font-medium text-purple-800 dark:text-purple-300 mb-2">Tutoriais em Vídeo</h4>
                                    <p class="text-purple-600 dark:text-purple-400 text-sm">
                                        Acesse nossa biblioteca de vídeos tutoriais para aprender a utilizar o sistema.
                                    </p>
                                    <button class="mt-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition w-full flex items-center justify-center">
                                        <i class="fas fa-play-circle mr-2"></i>
                                        Assistir Tutoriais
                                    </button>
                                </div>
                            </div>
                            
                            <button id="btn-help-tutorial" class="mt-4 w-full bg-accent-500 hover:bg-accent-600 text-white px-4 py-2 rounded-lg transition flex items-center justify-center">
                                <i class="fas fa-question-circle mr-2"></i> Iniciar Tutorial Interativo
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Mapa Content -->
                <div id="content-mapa" class="content hidden fade-in">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                        <h2 class="text-2xl font-bold mb-2 md:mb-0 text-gray-800 dark:text-gray-100 flex items-center">
                            <i class="fas fa-map-marked-alt mr-3 text-primary-600 dark:text-primary-400"></i>
                            Mapa de Operações
                        </h2>
                    </div>
                    
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-6">
                        <div class="flex flex-col md:flex-row justify-between items-center space-y-2 md:space-y-0 mb-4">
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-white">
                                Visão Geográfica
                            </h3>
                            <div class="flex items-center space-x-2">
                                <select id="map-view-type" class="bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-sm px-3 py-1.5">
                                    <option value="satellite">Satélite</option>
                                    <option value="terrain">Terreno</option>
                                    <option value="roadmap">Mapa</option>
                                </select>
                                <button id="btn-refresh-map" class="bg-primary-100 dark:bg-primary-900 text-primary-700 dark:text-primary-300 p-2 rounded hover:bg-primary-200 dark:hover:bg-primary-800 transition transform hover:scale-105">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Mapa placeholder - Seria substituído por uma integração real de mapa -->
                        <div class="h-96 rounded-lg overflow-hidden relative">
                            <div class="absolute inset-0 bg-gray-200 dark:bg-gray-700 flex items-center justify-center">
                                <div class="text-center">
                                    <i class="fas fa-map-marked-alt text-5xl mb-4 text-gray-400 dark:text-gray-500"></i>
                                    <p class="text-gray-500 dark:text-gray-400">Mapa de operações seria exibido aqui</p>
                                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">Integração com Google Maps ou outra API de mapas</p>
                                </div>
                            </div>
                            <div class="absolute top-4 right-4 z-10">
                                <div class="bg-white dark:bg-gray-800 shadow rounded-lg p-2 space-y-2">
                                    <button class="w-8 h-8 flex items-center justify-center rounded hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                    <button class="w-8 h-8 flex items-center justify-center rounded hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <i class="fas fa-minus"></i>
                                    </button>
                                    <button class="w-8 h-8 flex items-center justify-center rounded hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <i class="fas fa-location-arrow"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                        <!-- Lista de áreas -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5">
                            <h3 class="font-semibold text-gray-800 dark:text-white mb-4 flex items-center">
                                <i class="fas fa-map-pin text-red-500 mr-2"></i> 
                                Áreas de Colheita
                            </h3>
                            
                            <div class="space-y-3 max-h-60 overflow-y-auto">
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium">Área Sul - Soja</p>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">250 hectares</p>
                                        </div>
                                        <div>
                                            <span class="bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400 text-xs px-2 py-1 rounded-full">Ativa</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium">Área Norte - Milho</p>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">180 hectares</p>
                                        </div>
                                        <div>
                                            <span class="bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400 text-xs px-2 py-1 rounded-full">Pendente</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium">Área Oeste - Trigo</p>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">120 hectares</p>
                                        </div>
                                        <div>
                                            <span class="bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400 text-xs px-2 py-1 rounded-full">Planejada</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <button class="mt-4 bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg w-full flex items-center justify-center transition transform hover:scale-105">
                                <i class="fas fa-plus-circle mr-2"></i>
                                Adicionar Nova Área
                            </button>
                        </div>
                        
                        <!-- Localização de colhedoras -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5">
                            <h3 class="font-semibold text-gray-800 dark:text-white mb-4 flex items-center">
                                <i class="fas fa-tractor text-primary-500 mr-2"></i> 
                                Colhedoras Ativas
                            </h3>
                            
                            <div class="space-y-3 max-h-60 overflow-y-auto">
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium">Colhedora 001</p>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Área Sul - Em atividade</p>
                                        </div>
                                        <div>
                                            <span class="inline-block h-3 w-3 bg-green-500 rounded-full"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium">Colhedora 002</p>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Área Sul - Em pausa</p>
                                        </div>
                                        <div>
                                            <span class="inline-block h-3 w-3 bg-yellow-500 rounded-full"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <p class="font-medium">Colhedora 003</p>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Em manutenção</p>
                                        </div>
                                        <div>
                                            <span class="inline-block h-3 w-3 bg-red-500 rounded-full"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-4 bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg">
                                <div class="flex items-start">
                                    <i class="fas fa-info-circle text-blue-500 mt-0.5 mr-2"></i>
                                    <div>
                                        <p class="text-sm text-blue-700 dark:text-blue-400">Localização em tempo real requer instalação do GPS nas colhedoras</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Análise de área -->
                        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-5">
                            <h3 class="font-semibold text-gray-800 dark:text-white mb-4 flex items-center">
                                <i class="fas fa-chart-area text-accent-500 mr-2"></i> 
                                Análise de Cobertura
                            </h3>
                            
                            <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg mb-3">
                                <h4 class="font-medium text-gray-800 dark:text-gray-200 mb-2">Área Sul - Progresso</h4>
                                <div class="flex items-center mb-1 justify-between">
                                    <span class="text-sm text-gray-600 dark:text-gray-400">Progresso:</span>
                                    <span class="text-sm font-medium">75%</span>
                                </div>
                                <div class="w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2">
                                    <div class="bg-green-500 h-2 rounded-full" style="width: 75%"></div>
                                </div>
                                <div class="mt-2 flex justify-between text-xs text-gray-500 dark:text-gray-400">
                                    <span>Área coberta: 187.5 ha</span>
                                    <span>Restante: 62.5 ha</span>
                                </div>
                            </div>
                            
                            <!-- Estatísticas de eficiência -->
                            <div class="grid grid-cols-2 gap-2 mb-3">
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg text-center">
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Rendimento Médio</p>
                                    <p class="font-bold text-lg text-primary-700 dark:text-primary-300">8.5 ha/h</p>
                                </div>
                                <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg text-center">
                                    <p class="text-sm text-gray-500 dark:text-gray-400">Tempo Estimado</p>
                                    <p class="font-bold text-lg text-primary-700 dark:text-primary-300">7.4 h</p>
                                </div>
                            </div>
                            
                            <button class="mt-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-4 py-2 rounded-lg w-full flex items-center justify-center hover:bg-gray-200 dark:hover:bg-gray-600 transition">
                                <i class="fas fa-file-download mr-2"></i>
                                Exportar Relatório
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Notifications Panel -->
    <div id="notifications-panel" class="fixed inset-y-0 right-0 w-80 bg-white dark:bg-gray-800 shadow-xl transform translate-x-full transition-transform duration-300 ease-in-out z-50">
        <div class="flex justify-between items-center p-4 border-b border-gray-200 dark:border-gray-700">
            <h3 class="font-semibold text-lg">Notificações</h3>
            <button id="close-notifications" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="overflow-y-auto h-full pb-20">
            <div class="p-4">
                <div class="mb-4">
                    <h4 class="text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-2">Hoje</h4>
                    <div class="space-y-3 notificacoes-hoje">
                        <div class="bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg">
                            <div class="flex">
                                <div class="flex-shrink-0 mr-3">
                                    <div class="h-9 w-9 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center">
                                        <i class="fas fa-clipboard-check text-blue-600 dark:text-blue-400"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-gray-800 dark:text-gray-200">Colheita Completa</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">Área Sul - Setor 3 finalizado</p>
                                    <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">10 minutos atrás</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg">
                            <div class="flex">
                                <div class="flex-shrink-0 mr-3">
                                    <div class="h-9 w-9 rounded-full bg-yellow-100 dark:bg-yellow-800 flex items-center justify-center">
                                        <i class="fas fa-exclamation-triangle text-yellow-600 dark:text-yellow-400"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-gray-800 dark:text-gray-200">Alerta de Manutenção</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">Colhedora 001 - Próximo ao limite de horas</p>
                                    <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">2 horas atrás</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-xs uppercase font-semibold text-gray-500 dark:text-gray-400 mb-2">Anteriores</h4>
                    <div class="space-y-3 notificacoes-anteriores">
                        <div class="bg-gray-50 dark:bg-gray-700 p-3 rounded-lg">
                            <div class="flex">
                                <div class="flex-shrink-0 mr-3">
                                    <div class="h-9 w-9 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center">
                                        <i class="fas fa-user text-gray-600 dark:text-gray-400"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-gray-800 dark:text-gray-200">Novo Usuário</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">João Silva foi adicionado como usuário</p>
                                    <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">Ontem</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-green-50 dark:bg-green-900/20 p-3 rounded-lg">
                            <div class="flex">
                                <div class="flex-shrink-0 mr-3">
                                    <div class="h-9 w-9 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center">
                                        <i class="fas fa-chart-line text-green-600 dark:text-green-400"></i>
                                    </div>
                                </div>
                                <div>
                                    <p class="text-sm font-medium text-gray-800 dark:text-gray-200">Meta Alcançada</p>
                                    <p class="text-xs text-gray-500 dark:text-gray-400">Meta semanal de produção atingida</p>
                                    <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">2 dias atrás</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800">
            <button class="w-full bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-medium py-2 px-4 rounded-lg transition">
                Marcar todas como lidas
            </button>
        </div>
    </div>
    
    <!-- Ajuda overlay (Nova funcionalidade) -->
    <div id="help-overlay" class="fixed inset-0 bg-black bg-opacity-70 z-50 hidden flex items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800 dark:text-white">Ajuda Rápida</h3>
                <button id="close-help" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-6">
                <div>
                    <h4 class="text-lg font-semibold mb-2 text-gray-800 dark:text-white">Navegação Básica</h4>
                    <ul class="space-y-2 text-gray-600 dark:text-gray-400">
                        <li class="flex items-start">
                            <i class="fas fa-chart-line text-primary-500 mt-1 mr-3"></i>
                            <span><b>Dashboard:</b> Visualize métricas gerais e gráficos com indicadores de produção.</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-tractor text-primary-500 mt-1 mr-3"></i>
                            <span><b>Colhedoras:</b> Gerencie o cadastro de colhedoras e veja estatísticas por equipamento.</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-cube text-primary-500 mt-1 mr-3"></i>
                            <span><b>Registrar Produção:</b> Adicione novos registros de produção e visualize resumos.</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-cloud-rain text-primary-500 mt-1 mr-3"></i>
                            <span><b>Registro de Chuva:</b> Registre os dias em que houve parada de produção devido à chuva.</span>
                        </li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-2 text-gray-800 dark:text-white">Dicas Rápidas</h4>
                    <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg space-y-3">
                        <p class="flex items-start">
                            <i class="fas fa-lightbulb text-yellow-500 mt-1 mr-3"></i>
                            <span>Use o botão de exportação para baixar relatórios em PDF ou dados em formato JSON.</span>
                        </p>
                        <p class="flex items-start">
                            <i class="fas fa-lightbulb text-yellow-500 mt-1 mr-3"></i>
                            <span>Alterne entre tema claro e escuro com o botão na barra de navegação.</span>
                        </p>
                        <p class="flex items-start">
                            <i class="fas fa-lightbulb text-yellow-500 mt-1 mr-3"></i>
                            <span>Para visualizar dados históricos, use os filtros disponíveis na página de Registros.</span>
                        </p>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-2 text-gray-800 dark:text-white">Precisa de mais ajuda?</h4>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Entre em contato com o suporte técnico para assistência adicional.</p>
                    <div class="flex space-x-3">
                        <button class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg transition flex-1 flex items-center justify-center">
                            <i class="fas fa-envelope mr-2"></i>
                            Email de Suporte
                        </button>
                        <button class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition flex-1 flex items-center justify-center">
                            <i class="fab fa-whatsapp mr-2"></i>
                            WhatsApp
                        </button>
                    </div>
                </div>
                
                <!-- Tutorial interativo -->
                <div class="mt-4 border-t border-gray-200 dark:border-gray-700 pt-4">
                    <button id="start-tutorial" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition flex items-center justify-center">
                        <i class="fas fa-play-circle mr-2"></i>
                        Iniciar Tutorial Interativo
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de Confirmação para Limpar Dados -->
    <div id="modal-limpar-dados" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center p-4 z-50">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md p-6 transform transition-all duration-300 scale-100">
            <div class="mb-6">
                <div class="flex items-center justify-center mb-4 text-red-500">
                    <i class="fas fa-exclamation-circle text-5xl"></i>
                </div>
                <h2 class="text-xl font-semibold mb-2 text-gray-800 dark:text-gray-100 text-center">Atenção!</h2>
                <p class="text-gray-600 dark:text-gray-300 text-center mb-2">Você está prestes a apagar <strong>todos os dados</strong> do sistema.</p>
                <p class="text-gray-600 dark:text-gray-300 text-center font-bold">Esta ação é irreversível!</p>
            </div>
            
            <!-- Confirmação por digitação -->
            <div class="mb-4">
                <label for="confirmacao-texto" class="block mb-1 text-gray-700 dark:text-gray-300 text-sm">Digite "CONFIRMAR" para continuar:</label>
                <input type="text" id="confirmacao-texto" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-base focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent">
            </div>
            
            <div class="flex justify-center space-x-4">
                <button type="button" id="btn-cancelar-limpar" class="px-4 py-3 bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg transition flex-1 font-medium">
                    Cancelar
                </button>
                <button type="button" id="btn-confirmar-limpar" class="px-4 py-3 bg-red-600 opacity-50 cursor-not-allowed text-white rounded-lg transition flex-1 flex items-center justify-center font-medium" disabled>
                    <i class="fas fa-trash-alt mr-2"></i>
                    Limpar Tudo
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Exclusão de Usuário -->
    <div id="modal-excluir-usuario" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md p-6 transform transition-all scale-100">
                <div class="mb-6">
                    <div class="flex items-center justify-center mb-4 text-red-500">
                        <i class="fas fa-user-times text-5xl"></i>
                    </div>
                    <h2 class="text-xl font-semibold mb-2 text-gray-800 dark:text-gray-100 text-center">Excluir Usuário</h2>
                    <p class="text-gray-600 dark:text-gray-300 text-center">Tem certeza que deseja excluir este usuário? Esta ação não pode ser desfeita.</p>
                </div>
                
                <input type="hidden" id="usuario-excluir-id">
                
                <div class="flex justify-center space-x-4">
                    <button type="button" id="btn-cancelar-excluir-usuario" class="px-4 py-3 bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 rounded-lg transition flex-1 font-medium">
                        Cancelar
                    </button>
                    <button type="button" id="btn-confirmar-excluir-usuario" class="px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition flex-1 flex items-center justify-center font-medium">
                        <i class="fas fa-trash-alt mr-2"></i>
                        Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Verificação de suporte ao localStorage
        function checkLocalStorageSupport() {
            try {
                const test = 'test';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch (e) {
                console.error("LocalStorage não está disponível:", e);
                return false;
            }
        }
        
        // Simulação de banco de dados usando localStorage
        const DB = {
            // Usuário padrão admin
            defaultAdmin: {
                id: "admin-1",
                name: "Administrador",
                email: "admin@ggomes.com",
                password: "admin123",
                isAdmin: true,
                createdAt: new Date().toISOString()
            },
            
            // Inicializa o banco de dados local
            init() {
                if (!checkLocalStorageSupport()) {
                    mostrarToast("Seu navegador não suporta armazenamento local. O sistema pode não funcionar corretamente.", "error");
                    return;
                }
                
                try {
                    // Verificar se já existe algum dado
                    if (!localStorage.getItem('ggomes_users')) {
                        // Criar usuário admin padrão
                        localStorage.setItem('ggomes_users', JSON.stringify([this.defaultAdmin]));
                    }
                    
                    // Inicializar outras coleções se não existirem
                    if (!localStorage.getItem('ggomes_colhedoras')) {
                        localStorage.setItem('ggomes_colhedoras', JSON.stringify([]));
                    }
                    
                    if (!localStorage.getItem('ggomes_registros')) {
                        localStorage.setItem('ggomes_registros', JSON.stringify([]));
                    }
                    
                    if (!localStorage.getItem('ggomes_caminhoes')) {
                        localStorage.setItem('ggomes_caminhoes', JSON.stringify([]));
                    }
                    
                    // Inicializar registros de chuva (nova coleção)
                    if (!localStorage.getItem('ggomes_chuvas')) {
                        localStorage.setItem('ggomes_chuvas', JSON.stringify([]));
                    }
                    
                    // Inicializar configurações
                    if (!localStorage.getItem('ggomes_config')) {
                        localStorage.setItem('ggomes_config', JSON.stringify({
                            registrosPorPagina: 10,
                            formatoData: 'dd/MM/yyyy',
                            temaEscuro: document.documentElement.classList.contains('dark')
                        }));
                    }
                    
                    // Inicializar notificações
                    if (!localStorage.getItem('ggomes_notifications')) {
                        localStorage.setItem('ggomes_notifications', JSON.stringify([]));
                    }
                } catch (error) {
                    console.error("Erro ao inicializar o banco de dados:", error);
                    mostrarToast("Erro ao inicializar o sistema. Verifique o console para mais detalhes.", "error");
                }
            },
            
            // Funções para usuários
            users: {
                getAll() {
                    try {
                        return JSON.parse(localStorage.getItem('ggomes_users') || '[]');
                    } catch (e) {
                        console.error("Erro ao obter usuários:", e);
                        return [];
                    }
                },
                
                get(id) {
                    try {
                        const users = this.getAll();
                        return users.find(user => user.id === id) || null;
                    } catch (e) {
                        console.error("Erro ao obter usuário:", e);
                        return null;
                    }
                },
                
                getByEmail(email) {
                    try {
                        if (!email) return null;
                        const users = this.getAll();
                        return users.find(user => user.email.toLowerCase() === email.toLowerCase()) || null;
                    } catch (e) {
                        console.error("Erro ao obter usuário por email:", e);
                        return null;
                    }
                },
                
                add(user) {
                    try {
                        const users = this.getAll();
                        
                        // Gerar ID único
                        user.id = 'user-' + Date.now();
                        
                        // Adicionar data de criação
                        user.createdAt = new Date().toISOString();
                        
                        users.push(user);
                        localStorage.setItem('ggomes_users', JSON.stringify(users));
                        return user;
                    } catch (e) {
                        console.error("Erro ao adicionar usuário:", e);
                        throw new Error("Não foi possível adicionar o usuário");
                    }
                },
                
                update(user) {
                    try {
                        const users = this.getAll();
                        const index = users.findIndex(u => u.id === user.id);
                        
                        if (index !== -1) {
                            users[index] = { ...users[index], ...user };
                            localStorage.setItem('ggomes_users', JSON.stringify(users));
                            return users[index];
                        }
                        
                        return null;
                    } catch (e) {
                        console.error("Erro ao atualizar usuário:", e);
                        throw new Error("Não foi possível atualizar o usuário");
                    }
                },
                
                remove(id) {
                    try {
                        let users = this.getAll();
                        users = users.filter(user => user.id !== id);
                        localStorage.setItem('ggomes_users', JSON.stringify(users));
                    } catch (e) {
                        console.error("Erro ao remover usuário:", e);
                        throw new Error("Não foi possível remover o usuário");
                    }
                }
            },
            
            // Funções para colhedoras
            colhedoras: {
                getAll() {
                    try {
                        return JSON.parse(localStorage.getItem('ggomes_colhedoras') || '[]');
                    } catch (e) {
                        console.error("Erro ao obter colhedoras:", e);
                        return [];
                    }
                },
                
                get(id) {
                    try {
                        const colhedoras = this.getAll();
                        return colhedoras.find(c => c.id === id) || null;
                    } catch (e) {
                        console.error("Erro ao obter colhedora:", e);
                        return null;
                    }
                },
                
                add(colhedora) {
                    try {
                        const colhedoras = this.getAll();
                        
                        // Verificar se ID já existe
                        if (colhedoras.some(c => c.id === colhedora.id)) {
                            throw new Error("Colhedora com este ID já existe");
                        }
                        
                        colhedoras.push(colhedora);
                        localStorage.setItem('ggomes_colhedoras', JSON.stringify(colhedoras));
                        return colhedora;
                    } catch (e) {
                        console.error("Erro ao adicionar colhedora:", e);
                        throw e;
                    }
                },
                
                update(colhedora) {
                    try {
                        const colhedoras = this.getAll();
                        const index = colhedoras.findIndex(c => c.id === colhedora.id);
                        
                        if (index !== -1) {
                            colhedoras[index] = colhedora;
                            localStorage.setItem('ggomes_colhedoras', JSON.stringify(colhedoras));
                            return colhedora;
                        }
                        
                        return null;
                    } catch (e) {
                        console.error("Erro ao atualizar colhedora:", e);
                        throw new Error("Não foi possível atualizar a colhedora");
                    }
                },
                
                remove(id) {
                    try {
                        let colhedoras = this.getAll();
                        colhedoras = colhedoras.filter(c => c.id !== id);
                        localStorage.setItem('ggomes_colhedoras', JSON.stringify(colhedoras));
                    } catch (e) {
                        console.error("Erro ao remover colhedora:", e);
                        throw new Error("Não foi possível remover a colhedora");
                    }
                }
            },
            
            // Funções para registros
            registros: {
                getAll() {
                    try {
                        return JSON.parse(localStorage.getItem('ggomes_registros') || '[]');
                    } catch (e) {
                        console.error("Erro ao obter registros:", e);
                        return [];
                    }
                },
                
                get(id) {
                    try {
                        const registros = this.getAll();
                        return registros.find(r => r.id === id) || null;
                    } catch (e) {
                        console.error("Erro ao obter registro:", e);
                        return null;
                    }
                },
                
                add(registro) {
                    try {
                        const registros = this.getAll();
                        
                        // Gerar ID único
                        registro.id = 'reg-' + Date.now();
                        
                        // Adicionar data de criação
                        registro.createdAt = new Date().toISOString();
                        
                        registros.push(registro);
                        localStorage.setItem('ggomes_registros', JSON.stringify(registros));
                        
                        // Adicionar notificação para o novo registro
                        const notificacao = {
                            id: 'notif-' + Date.now(),
                            tipo: 'info',
                            titulo: 'Novo Registro de Produção',
                            mensagem: `Registro adicionado: ${registro.colhedoraId} - ${registro.quantidade}T de ${registro.cultura || 'produção'}`,
                            dataHora: new Date().toISOString(),
                            lida: false
                        };
                        DB.notifications.add(notificacao);
                        
                        return registro;
                    } catch (e) {
                        console.error("Erro ao adicionar registro:", e);
                        throw new Error("Não foi possível adicionar o registro");
                    }
                },
                
                update(registro) {
                    try {
                        const registros = this.getAll();
                        const index = registros.findIndex(r => r.id === registro.id);
                        
                        if (index !== -1) {
                            registros[index] = registro;
                            localStorage.setItem('ggomes_registros', JSON.stringify(registros));
                            return registro;
                        }
                        
                        return null;
                    } catch (e) {
                        console.error("Erro ao atualizar registro:", e);
                        throw new Error("Não foi possível atualizar o registro");
                    }
                },
                
                remove(id) {
                    try {
                        let registros = this.getAll();
                        registros = registros.filter(r => r.id !== id);
                        localStorage.setItem('ggomes_registros', JSON.stringify(registros));
                    } catch (e) {
                        console.error("Erro ao remover registro:", e);
                        throw new Error("Não foi possível remover o registro");
                    }
                },
                
                // Novo método: obter registros por período
                getByPeriod(days) {
                    try {
                        const registros = this.getAll();
                        if (!days) return registros;
                        
                        const today = new Date();
                        const startDate = new Date();
                        startDate.setDate(today.getDate() - days);
                        
                        return registros.filter(r => {
                            const regDate = new Date(r.data);
                            return regDate >= startDate && regDate <= today;
                        });
                    } catch (e) {
                        console.error("Erro ao obter registros por período:", e);
                        return [];
                    }
                },
                
                // Novo método: obter registros do último dia de registro
                getLastDayRegistros() {
                    try {
                        const registros = this.getAll();
                        if (registros.length === 0) return [];
                        
                        // Ordenar registros por data (do mais recente para o mais antigo)
                        const sortedRegistros = [...registros].sort((a, b) => new Date(b.data) - new Date(a.data));
                        
                        // Obter a data mais recente
                        const lastDate = sortedRegistros[0].data;
                        
                        // Filtrar registros com a data mais recente
                        return sortedRegistros.filter(r => r.data === lastDate);
                    } catch (e) {
                        console.error("Erro ao obter registros do último dia:", e);
                        return [];
                    }
                },
                
                // Novo método: calcular tendências
                getTrends(currentPeriodDays) {
                    try {
                        // Obter registros do período atual
                        const currentRegistros = this.getByPeriod(currentPeriodDays);
                        
                        // Obter registros do período anterior de mesma duração
                        const today = new Date();
                        const previousEndDate = new Date();
                        previousEndDate.setDate(today.getDate() - currentPeriodDays);
                        
                        const previousStartDate = new Date();
                        previousStartDate.setDate(previousEndDate.getDate() - currentPeriodDays);
                        
                        const allRegistros = this.getAll();
                        const previousRegistros = allRegistros.filter(r => {
                            const regDate = new Date(r.data);
                            return regDate >= previousStartDate && regDate <= previousEndDate;
                        });
                        
                        // Obter registros do último dia
                        const lastDayRegistros = this.getLastDayRegistros();
                        
                        // Calcular totais atuais
                        let currentTotalColhido = 0;
                        let currentAreaTotal = 0;
                        let currentHorasTotal = 0;
                        
                        currentRegistros.forEach(reg => {
                            currentTotalColhido += Number(reg.quantidade) || 0;
                            currentAreaTotal += Number(reg.area) || 0;
                            currentHorasTotal += Number(reg.horas) || 0;
                        });
                        
                        // Calcular produtividade diária (último dia)
                        let lastDayTotalColhido = 0;
                        
                        lastDayRegistros.forEach(reg => {
                            lastDayTotalColhido += Number(reg.quantidade) || 0;
                        });
                        
                        const dailyProductivity = lastDayRegistros.length > 0 ? lastDayTotalColhido : 0;
                        
                        // Calcular totais do período anterior
                        let previousTotalColhido = 0;
                        let previousAreaTotal = 0;
                        let previousHorasTotal = 0;
                        
                        previousRegistros.forEach(reg => {
                            previousTotalColhido += Number(reg.quantidade) || 0;
                            previousAreaTotal += Number(reg.area) || 0;
                            previousHorasTotal += Number(reg.horas) || 0;
                        });
                        
                        // Calcular produtividade e rendimento médios por colhedora
                        const currentColhedoras = new Map();
                        const previousColhedoras = new Map();
                        
                        // Inicializar dados para o cálculo da média de produtividade/rendimento para período atual
                        currentRegistros.forEach(reg => {
                            if (!reg.colhedoraId) return;
                            
                            if (!currentColhedoras.has(reg.colhedoraId)) {
                                currentColhedoras.set(reg.colhedoraId, {
                                    quantidade: 0,
                                    area: 0,
                                    horas: 0
                                });
                            }
                            
                            const stats = currentColhedoras.get(reg.colhedoraId);
                            stats.quantidade += Number(reg.quantidade) || 0;
                            stats.area += Number(reg.area) || 0;
                            stats.horas += Number(reg.horas) || 0;
                        });
                        
                        // Inicializar dados para o cálculo da média de produtividade/rendimento para período anterior
                        previousRegistros.forEach(reg => {
                            if (!reg.colhedoraId) return;
                            
                            if (!previousColhedoras.has(reg.colhedoraId)) {
                                previousColhedoras.set(reg.colhedoraId, {
                                    quantidade: 0,
                                    area: 0,
                                    horas: 0
                                });
                            }
                            
                            const stats = previousColhedoras.get(reg.colhedoraId);
                            stats.quantidade += Number(reg.quantidade) || 0;
                            stats.area += Number(reg.area) || 0;
                            stats.horas += Number(reg.horas) || 0;
                        });
                        
                        // Calcular produtividade para cada colhedora e média total (período atual)
                        let currentProdutividadeTotal = 0;
                        let currentColhedorasComArea = 0;
                        
                        currentColhedoras.forEach(stats => {
                            if (stats.area > 0) {
                                stats.produtividade = stats.quantidade / stats.area;
                                currentProdutividadeTotal += stats.produtividade;
                                currentColhedorasComArea++;
                            }
                        });
                        
                        const currentProdutividade = currentColhedorasComArea > 0 
                            ? currentProdutividadeTotal / currentColhedorasComArea 
                            : 0;
                        
                        // Calcular rendimento para cada colhedora e média total (período atual)
                        let currentRendimentoTotal = 0;
                        let currentColhedorasComHoras = 0;
                        
                        currentColhedoras.forEach(stats => {
                            if (stats.horas > 0) {
                                stats.rendimento = stats.quantidade / stats.horas;
                                currentRendimentoTotal += stats.rendimento;
                                currentColhedorasComHoras++;
                            }
                        });
                        
                        const currentRendimento = currentColhedorasComHoras > 0 
                            ? currentRendimentoTotal / currentColhedorasComHoras 
                            : 0;
                        
                        // Calcular produtividade para cada colhedora e média total (período anterior)
                        let previousProdutividadeTotal = 0;
                        let previousColhedorasComArea = 0;
                        
                        previousColhedoras.forEach(stats => {
                            if (stats.area > 0) {
                                stats.produtividade = stats.quantidade / stats.area;
                                previousProdutividadeTotal += stats.produtividade;
                                previousColhedorasComArea++;
                            }
                        });
                        
                        const previousProdutividade = previousColhedorasComArea > 0 
                            ? previousProdutividadeTotal / previousColhedorasComArea 
                            : 0;
                        
                        // Calcular rendimento para cada colhedora e média total (período anterior)
                        let previousRendimentoTotal = 0;
                        let previousColhedorasComHoras = 0;
                        
                        previousColhedoras.forEach(stats => {
                            if (stats.horas > 0) {
                                stats.rendimento = stats.quantidade / stats.horas;
                                previousRendimentoTotal += stats.rendimento;
                                previousColhedorasComHoras++;
                            }
                        });
                        
                        const previousRendimento = previousColhedorasComHoras > 0 
                            ? previousRendimentoTotal / previousColhedorasComHoras 
                            : 0;
                        
                        // Calcular tendências (variação percentual)
                        const calcPercentChange = (current, previous) => {
                            if (previous === 0) return current > 0 ? 100 : 0;
                            return ((current - previous) / previous) * 100;
                        };
                        
                        return {
                            totalColhido: {
                                current: currentTotalColhido,
                                previous: previousTotalColhido,
                                change: calcPercentChange(currentTotalColhido, previousTotalColhido)
                            },
                            dailyProductivity: {
                                current: dailyProductivity,
                                previous: previousRegistros.length > 0 ? previousTotalColhido / (currentPeriodDays || 1) : 0,
                                change: calcPercentChange(dailyProductivity, previousRegistros.length > 0 ? previousTotalColhido / (currentPeriodDays || 1) : 0)
                            },
                            areaTotal: {
                                current: currentAreaTotal,
                                previous: previousAreaTotal,
                                change: calcPercentChange(currentAreaTotal, previousAreaTotal)
                            },
                            produtividade: {
                                current: currentProdutividade,
                                previous: previousProdutividade,
                                change: calcPercentChange(currentProdutividade, previousProdutividade)
                            },
                            rendimento: {
                                current: currentRendimento,
                                previous: previousRendimento,
                                change: calcPercentChange(currentRendimento, previousRendimento)
                            },
                            totalRegistros: {
                                current: currentRegistros.length,
                                previous: previousRegistros.length,
                                change: calcPercentChange(currentRegistros.length, previousRegistros.length)
                            }
                        };
                    } catch (e) {
                        console.error("Erro ao calcular tendências:", e);
                        return null;
                    }
                },
                
                // Obter dados para gráficos temporais
                getTimeSeriesData(days) {
                    try {
                        const registros = this.getByPeriod(days);
                        
                        // Agrupar por data
                        const dataMap = new Map();
                        
                        // Criar datas para todo o período solicitado
                        const today = new Date();
                        for (let i = days; i >= 0; i--) {
                            const date = new Date();
                            date.setDate(today.getDate() - i);
                            const dateString = date.toISOString().split('T')[0];
                            dataMap.set(dateString, {
                                date: dateString,
                                quantidade: 0,
                                area: 0
                            });
                        }
                        
                        // Preencher dados reais
                        registros.forEach(reg => {
                            const dateString = reg.data;
                            if (dataMap.has(dateString)) {
                                const dayData = dataMap.get(dateString);
                                dayData.quantidade += Number(reg.quantidade) || 0;
                                dayData.area += Number(reg.area) || 0;
                            }
                        });
                        
                        // Converter para array ordenado por data
                        return Array.from(dataMap.values()).sort((a, b) => {
                            return new Date(a.date) - new Date(b.date);
                        });
                    } catch (e) {
                        console.error("Erro ao obter dados de série temporal:", e);
                        return [];
                    }
                },
                
                // Obter estatísticas por categoria
                getStatsByCategory(category = 'cultura', period = null) {
                    try {
                        const registros = period ? this.getByPeriod(period) : this.getAll();
                        
                        // Agrupar por categoria (ex: cultura)
                        const categoryMap = new Map();
                        
                        registros.forEach(reg => {
                            const categoryValue = reg[category] || 'Não especificado';
                            
                            if (!categoryMap.has(categoryValue)) {
                                categoryMap.set(categoryValue, {
                                    name: categoryValue,
                                    quantidade: 0,
                                    area: 0,
                                    horas: 0,
                                    registros: 0
                                });
                            }
                            
                            const stats = categoryMap.get(categoryValue);
                            stats.quantidade += Number(reg.quantidade) || 0;
                            stats.area += Number(reg.area) || 0;
                            stats.horas += Number(reg.horas) || 0;
                            stats.registros += 1;
                        });
                        
                        // Calcular produtividade e rendimento
                        categoryMap.forEach(stats => {
                            stats.produtividade = stats.area > 0 ? stats.quantidade / stats.area : 0;
                            stats.rendimento = stats.horas > 0 ? stats.quantidade / stats.horas : 0;
                        });
                        
                        // Converter para array
                        return Array.from(categoryMap.values());
                    } catch (e) {
                        console.error(`Erro ao obter estatísticas por ${category}:`, e);
                        return [];
                    }
                },
                
                // Obter melhores desempenhos
                getBestPerformers(period = null) {
                    try {
                        // Estatísticas por colhedora
                        const colhedoraStats = this.getStatsByCategory('colhedoraId', period);
                        
                        // Estatísticas por cultura
                        const culturaStats = this.getStatsByCategory('cultura', period);
                        
                        // Encontrar os melhores desempenhos
                        const bestProductivityColhedora = colhedoraStats.reduce((best, current) => 
                            (current.produtividade > best.produtividade) ? current : best, 
                            { produtividade: 0 });
                        
                        const bestVolumeColhedora = colhedoraStats.reduce((best, current) => 
                            (current.quantidade > best.quantidade) ? current : best, 
                            { quantidade: 0 });
                            
                        const bestYieldColhedora = colhedoraStats.reduce((best, current) => 
                            (current.rendimento > best.rendimento) ? current : best, 
                            { rendimento: 0 });
                            
                        const bestProductivityCultura = culturaStats.reduce((best, current) => 
                            (current.produtividade > best.produtividade) ? current : best, 
                            { produtividade: 0 });
                        
                        const bestVolumeCultura = culturaStats.reduce((best, current) => 
                            (current.quantidade > best.quantidade) ? current : best, 
                            { quantidade: 0 });
                            
                        const bestAreaCultura = culturaStats.reduce((best, current) => 
                            (current.area > best.area) ? current : best, 
                            { area: 0 });
                        
                        return {
                            colhedoras: {
                                bestProductivity: bestProductivityColhedora,
                                bestVolume: bestVolumeColhedora,
                                bestYield: bestYieldColhedora,
                                all: colhedoraStats
                            },
                            culturas: {
                                bestProductivity: bestProductivityCultura,
                                bestVolume: bestVolumeCultura,
                                bestArea: bestAreaCultura,
                                all: culturaStats
                            }
                        };
                    } catch (e) {
                        console.error("Erro ao obter melhores desempenhos:", e);
                        return null;
                    }
                }
            },
            
            // Funções para registros de chuva (NOVA COLEÇÃO)
            chuvas: {
                getAll() {
                    try {
                        return JSON.parse(localStorage.getItem('ggomes_chuvas') || '[]');
                    } catch (e) {
                        console.error("Erro ao obter registros de chuva:", e);
                        return [];
                    }
                },
                
                get(id) {
                    try {
                        const chuvas = this.getAll();
                        return chuvas.find(c => c.id === id) || null;
                    } catch (e) {
                        console.error("Erro ao obter registro de chuva:", e);
                        return null;
                    }
                },
                
                add(chuva) {
                    try {
                        const chuvas = this.getAll();
                        
                        // Gerar ID único
                        chuva.id = 'chuva-' + Date.now();
                        
                        // Adicionar data de criação
                        chuva.createdAt = new Date().toISOString();
                        
                        chuvas.push(chuva);
                        localStorage.setItem('ggomes_chuvas', JSON.stringify(chuvas));
                        
                        // Adicionar notificação para o novo registro
                        const notificacao = {
                            id: 'notif-' + Date.now(),
                            tipo: 'warning',
                            titulo: 'Nova Parada por Chuva',
                            mensagem: `Registrada parada de ${chuva.dias} dia(s) por chuva`,
                            dataHora: new Date().toISOString(),
                            lida: false
                        };
                        DB.notifications.add(notificacao);
                        
                        return chuva;
                    } catch (e) {
                        console.error("Erro ao adicionar registro de chuva:", e);
                        throw new Error("Não foi possível adicionar o registro de chuva");
                    }
                },
                
                update(chuva) {
                    try {
                        const chuvas = this.getAll();
                        const index = chuvas.findIndex(c => c.id === chuva.id);
                        
                        if (index !== -1) {
                            chuvas[index] = chuva;
                            localStorage.setItem('ggomes_chuvas', JSON.stringify(chuvas));
                            return chuva;
                        }
                        
                        return null;
                    } catch (e) {
                        console.error("Erro ao atualizar registro de chuva:", e);
                        throw new Error("Não foi possível atualizar o registro de chuva");
                    }
                },
                
                remove(id) {
                    try {
                        let chuvas = this.getAll();
                        chuvas = chuvas.filter(c => c.id !== id);
                        localStorage.setItem('ggomes_chuvas', JSON.stringify(chuvas));
                    } catch (e) {
                        console.error("Erro ao remover registro de chuva:", e);
                        throw new Error("Não foi possível remover o registro de chuva");
                    }
                },
                
                // Obter registros de chuva por período
                getByPeriod(days) {
                    try {
                        const chuvas = this.getAll();
                        if (!days) return chuvas;
                        
                        const today = new Date();
                        const startDate = new Date();
                        startDate.setDate(today.getDate() - days);
                        
                        return chuvas.filter(c => {
                            // Verificar se o período da chuva está dentro do período solicitado
                            const dataInicio = new Date(c.dataInicio);
                            const dataFim = new Date(c.dataFim);
                            
                            // Se o período de chuva termina após a data de início do filtro
                            // ou começa antes da data final do filtro
                            return (dataFim >= startDate && dataInicio <= today);
                        });
                    } catch (e) {
                        console.error("Erro ao obter registros de chuva por período:", e);
                        return [];
                    }
                },
                
                // Obter total de dias parados por chuva
                getTotalDias(period = null) {
                    try {
                        const chuvas = period ? this.getByPeriod(period) : this.getAll();
                        
                        let totalDias = 0;
                        chuvas.forEach(chuva => {
                            totalDias += Number(chuva.dias) || 0;
                        });
                        
                        return totalDias;
                    } catch (e) {
                        console.error("Erro ao calcular total de dias parados por chuva:", e);
                        return 0;
                    }
                },
                
                // Obter dados para gráfico mensal
                getMonthlyChuvaData() {
                    try {
                        const chuvas = this.getAll();
                        const monthMap = new Map();
                        
                        // Inicializar mapa para todos os meses do ano atual
                        const currentYear = new Date().getFullYear();
                        for (let i = 0; i < 12; i++) {
                            const monthKey = `${currentYear}-${(i + 1).toString().padStart(2, '0')}`;
                            monthMap.set(monthKey, {
                                month: i + 1,
                                year: currentYear,
                                monthName: new Date(currentYear, i, 1).toLocaleString('pt-BR', { month: 'short' }),
                                totalDias: 0,
                                registros: 0
                            });
                        }
                        
                        // Agrupar registros por mês
                        chuvas.forEach(chuva => {
                            const dataInicio = new Date(chuva.dataInicio);
                            const year = dataInicio.getFullYear();
                            const month = dataInicio.getMonth() + 1;
                            
                            const monthKey = `${year}-${month.toString().padStart(2, '0')}`;
                            
                            if (!monthMap.has(monthKey)) {
                                monthMap.set(monthKey, {
                                    month,
                                    year,
                                    monthName: dataInicio.toLocaleString('pt-BR', { month: 'short' }),
                                    totalDias: 0,
                                    registros: 0
                                });
                            }
                            
                            const monthData = monthMap.get(monthKey);
                            monthData.totalDias += Number(chuva.dias) || 0;
                            monthData.registros += 1;
                        });
                        
                        // Converter para array e ordenar por mês
                        return Array.from(monthMap.values())
                            .sort((a, b) => {
                                if (a.year !== b.year) return a.year - b.year;
                                return a.month - b.month;
                            });
                    } catch (e) {
                        console.error("Erro ao obter dados mensais de chuva:", e);
                        return [];
                    }
                },
                
                // Obter dados para gráfico temporal
                getTimeSeriesData(days) {
                    try {
                        const chuvas = this.getByPeriod(days);
                        
                        // Agrupar por data
                        const dataMap = new Map();
                        
                        // Criar datas para todo o período solicitado
                        const today = new Date();
                        for (let i = days; i >= 0; i--) {
                            const date = new Date();
                            date.setDate(today.getDate() - i);
                            const dateString = date.toISOString().split('T')[0];
                            dataMap.set(dateString, {
                                date: dateString,
                                dias: 0,
                                registros: 0
                            });
                        }
                        
                        // Preencher dados reais
                        chuvas.forEach(chuva => {
                            // Verificar todas as datas entre dataInicio e dataFim
                            const dataInicio = new Date(chuva.dataInicio);
                            const dataFim = new Date(chuva.dataFim);
                            
                            // Distribuir os dias de chuva pelo período
                            const diasTotais = Number(chuva.dias) || 0;
                            const diasNoPeriodo = Math.round((dataFim - dataInicio) / (24 * 60 * 60 * 1000)) + 1; 
                            const diaPorData = diasNoPeriodo > 0 ? diasTotais / diasNoPeriodo : diasTotais;
                            
                            // Para cada data entre inicio e fim
                            for (let date = new Date(dataInicio); date <= dataFim; date.setDate(date.getDate() + 1)) {
                                const dateString = date.toISOString().split('T')[0];
                                
                                if (dataMap.has(dateString)) {
                                    const dayData = dataMap.get(dateString);
                                    dayData.dias += diaPorData;
                                    dayData.registros += 1;
                                }
                            }
                        });
                        
                        // Converter para array ordenado por data
                        return Array.from(dataMap.values()).sort((a, b) => {
                            return new Date(a.date) - new Date(b.date);
                        });
                    } catch (e) {
                        console.error("Erro ao obter dados de série temporal de chuva:", e);
                        return [];
                    }
                },
                
                // Obter última parada registrada
                getLastChuva() {
                    try {
                        const chuvas = this.getAll();
                        if (chuvas.length === 0) return null;
                        
                        // Ordenar por data de fim (do mais recente para o mais antigo)
                        const sortedChuvas = [...chuvas].sort((a, b) => new Date(b.dataFim) - new Date(a.dataFim));
                        
                        return sortedChuvas[0];
                    } catch (e) {
                        console.error("Erro ao obter última parada por chuva:", e);
                        return null;
                    }
                },
                
                // Calcular impacto estimado das paradas na produção
                calcularImpactoEstimado(period = null) {
                    try {
                        // Obter paradas do período
                        const chuvas = period ? this.getByPeriod(period) : this.getAll();
                        const totalDias = this.getTotalDias(period);
                        
                        // Calcular produtividade média diária (toneladas por dia)
                        const registros = period ? 
                            DB.registros.getByPeriod(period) : 
                            DB.registros.getAll();
                        
                        let totalProducao = 0;
                        let totalDiasProducao = new Set(); // Para contar dias únicos de produção
                        
                        registros.forEach(reg => {
                            totalProducao += Number(reg.quantidade) || 0;
                            totalDiasProducao.add(reg.data);
                        });
                        
                        // Se não houver dias de produção, retornar 0
                        if (totalDiasProducao.size === 0) return 0;
                        
                        // Calcular média diária de produção
                        const mediaDiaria = totalProducao / totalDiasProducao.size;
                        
                        // Estimar impacto
                        const impactoEstimado = mediaDiaria * totalDias;
                        
                        return impactoEstimado;
                    } catch (e) {
                        console.error("Erro ao calcular impacto estimado das paradas por chuva:", e);
                        return 0;
                    }
                }
            },
            
            // Funções para caminhões
            caminhoes: {
                getAll() {
                    try {
                        return JSON.parse(localStorage.getItem('ggomes_caminhoes') || '[]');
                    } catch (e) {
                        console.error("Erro ao obter caminhões:", e);
                        return [];
                    }
                },
                
                get(id) {
                    try {
                        const caminhoes = this.getAll();
                        return caminhoes.find(c => c.id === id) || null;
                    } catch (e) {
                        console.error("Erro ao obter caminhão:", e);
                        return null;
                    }
                },
                
                add(caminhao) {
                    try {
                        const caminhoes = this.getAll();
                        
                        // Gerar ID único
                        caminhao.id = 'cam-' + Date.now();
                        
                        // Adicionar data de criação
                        caminhao.createdAt = new Date().toISOString();
                        
                        caminhoes.push(caminhao);
                        localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
                        
                        // Adicionar notificação
                        if (Number(caminhao.tempoCampo) > 120 || Number(caminhao.tempoPatio) > 60) {
                            const notificacao = {
                                id: 'notif-' + Date.now(),
                                tipo: 'warning',
                                titulo: 'Tempo de Caminhão Elevado',
                                mensagem: `Caminhão ${caminhao.idCaminhao} registrou tempo acima do esperado`,
                                dataHora: new Date().toISOString(),
                                lida: false
                            };
                            DB.notifications.add(notificacao);
                        }
                        
                        return caminhao;
                    } catch (e) {
                        console.error("Erro ao adicionar caminhão:", e);
                        throw new Error("Não foi possível adicionar o caminhão");
                    }
                },
                
                update(caminhao) {
                    try {
                        const caminhoes = this.getAll();
                        const index = caminhoes.findIndex(c => c.id === caminhao.id);
                        
                        if (index !== -1) {
                            caminhoes[index] = caminhao;
                            localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
                            return caminhao;
                        }
                        
                        return null;
                    } catch (e) {
                        console.error("Erro ao atualizar caminhão:", e);
                        throw new Error("Não foi possível atualizar o caminhão");
                    }
                },
                
                remove(id) {
                    try {
                        let caminhoes = this.getAll();
                        caminhoes = caminhoes.filter(c => c.id !== id);
                        localStorage.setItem('ggomes_caminhoes', JSON.stringify(caminhoes));
                    } catch (e) {
                        console.error("Erro ao remover caminhão:", e);
                        throw new Error("Não foi possível remover o caminhão");
                    }
                },
                
                // Novo método: obter caminhões por período
                getByPeriod(days) {
                    try {
                        const caminhoes = this.getAll();
                        if (!days) return caminhoes;
                        
                        const today = new Date();
                        const startDate = new Date();
                        startDate.setDate(today.getDate() - days);
                        
                        return caminhoes.filter(c => {
                            const camDate = new Date(c.data);
                            return camDate >= startDate && camDate <= today;
                        });
                    } catch (e) {
                        console.error("Erro ao obter caminhões por período:", e);
                        return [];
                    }
                },
                
                // Obter tendências dos tempos de caminhões
                getTrends(currentPeriodDays) {
                    try {
                        // Obter caminhões do período atual
                        const currentCaminhoes = this.getByPeriod(currentPeriodDays);
                        
                        // Obter caminhões do período anterior
                        const today = new Date();
                        const previousEndDate = new Date();
                        previousEndDate.setDate(today.getDate() - currentPeriodDays);
                        
                        const previousStartDate = new Date();
                        previousStartDate.setDate(previousEndDate.getDate() - currentPeriodDays);
                        
                        const allCaminhoes = this.getAll();
                        const previousCaminhoes = allCaminhoes.filter(c => {
                            const regDate = new Date(c.data);
                            return regDate >= previousStartDate && regDate <= previousEndDate;
                        });
                        
                        // Calcular médias atuais
                        let currentTotalCampo = 0;
                        let currentTotalPatio = 0;
                        
                        currentCaminhoes.forEach(c => {
                            currentTotalCampo += Number(c.tempoCampo) || 0;
                            currentTotalPatio += Number(c.tempoPatio) || 0;
                        });
                        
                        const currentMediaCampo = currentCaminhoes.length > 0 ? currentTotalCampo / currentCaminhoes.length : 0;
                        const currentMediaPatio = currentCaminhoes.length > 0 ? currentTotalPatio / currentCaminhoes.length : 0;
                        
                        // Calcular médias do período anterior
                        let previousTotalCampo = 0;
                        let previousTotalPatio = 0;
                        
                        previousCaminhoes.forEach(c => {
                            previousTotalCampo += Number(c.tempoCampo) || 0;
                            previousTotalPatio += Number(c.tempoPatio) || 0;
                        });
                        
                        const previousMediaCampo = previousCaminhoes.length > 0 ? previousTotalCampo / previousCaminhoes.length : 0;
                        const previousMediaPatio = previousCaminhoes.length > 0 ? previousTotalPatio / previousCaminhoes.length : 0;
                        
                        // Calcular tendências
                        const calcPercentChange = (current, previous) => {
                            if (previous === 0) return current > 0 ? 100 : 0;
                            return ((current - previous) / previous) * 100;
                        };
                        
                        return {
                            tempoCampo: {
                                current: currentMediaCampo,
                                previous: previousMediaCampo,
                                change: calcPercentChange(currentMediaCampo, previousMediaCampo)
                            },
                            tempoPatio: {
                                current: currentMediaPatio,
                                previous: previousMediaPatio,
                                change: calcPercentChange(currentMediaPatio, previousMediaPatio)
                            },
                            totalCaminhoes: {
                                current: currentCaminhoes.length,
                                previous: previousCaminhoes.length,
                                change: calcPercentChange(currentCaminhoes.length, previousCaminhoes.length)
                            }
                        };
                    } catch (e) {
                        console.error("Erro ao calcular tendências de caminhões:", e);
                        return null;
                    }
                },
                
                // Obter dados para gráfico de tempos
                getTimeSeriesData(days) {
                    try {
                        const caminhoes = this.getByPeriod(days);
                        
                        // Agrupar por data
                        const dataMap = new Map();
                        
                        // Criar datas para todo o período solicitado
                        const today = new Date();
                        for (let i = days; i >= 0; i--) {
                            const date = new Date();
                            date.setDate(today.getDate() - i);
                            const dateString = date.toISOString().split('T')[0];
                            dataMap.set(dateString, {
                                date: dateString,
                                tempoCampo: 0,
                                tempoPatio: 0,
                                count: 0
                            });
                        }
                        
                        // Somar tempos por data
                        caminhoes.forEach(c => {
                            const dateString = c.data;
                            if (dataMap.has(dateString)) {
                                const dayData = dataMap.get(dateString);
                                dayData.tempoCampo += Number(c.tempoCampo) || 0;
                                dayData.tempoPatio += Number(c.tempoPatio) || 0;
                                dayData.count += 1;
                            }
                        });
                        
                        // Calcular médias
                        dataMap.forEach(dayData => {
                            if (dayData.count > 0) {
                                dayData.tempoCampoMedio = dayData.tempoCampo / dayData.count;
                                dayData.tempoPatioMedio = dayData.tempoPatio / dayData.count;
                            } else {
                                dayData.tempoCampoMedio = 0;
                                dayData.tempoPatioMedio = 0;
                            }
                        });
                        
                        // Converter para array ordenado por data
                        return Array.from(dataMap.values()).sort((a, b) => {
                            return new Date(a.date) - new Date(b.date);
                        });
                    } catch (e) {
                        console.error("Erro ao obter dados de série temporal de caminhões:", e);
                        return [];
                    }
                }
            },
            
            // Notificações
            notifications: {
                getAll() {
                    try {
                        return JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                    } catch (e) {
                        console.error("Erro ao obter notificações:", e);
                        return [];
                    }
                },
                
                getUnread() {
                    try {
                        const notifications = this.getAll();
                        return notifications.filter(n => !n.lida);
                    } catch (e) {
                        console.error("Erro ao obter notificações não lidas:", e);
                        return [];
                    }
                },
                
                add(notification) {
                    try {
                        const notifications = this.getAll();
                        notifications.push(notification);
                        localStorage.setItem('ggomes_notifications', JSON.stringify(notifications));
                        
                        // Atualizar contador de notificações
                        atualizarContadorNotificacoes();
                        
                        return notification;
                    } catch (e) {
                        console.error("Erro ao adicionar notificação:", e);
                        return null;
                    }
                },
                
                markAsRead(id) {
                    try {
                        const notifications = this.getAll();
                        const index = notifications.findIndex(n => n.id === id);
                        
                        if (index !== -1) {
                            notifications[index].lida = true;
                            localStorage.setItem('ggomes_notifications', JSON.stringify(notifications));
                            
                            // Atualizar contador de notificações
                            atualizarContadorNotificacoes();
                            
                            return true;
                        }
                        
                        return false;
                    } catch (e) {
                        console.error("Erro ao marcar notificação como lida:", e);
                        return false;
                    }
                },
                
                markAllAsRead() {
                    try {
                        const notifications = this.getAll();
                        notifications.forEach(n => n.lida = true);
                        localStorage.setItem('ggomes_notifications', JSON.stringify(notifications));
                        
                        // Atualizar contador de notificações
                        atualizarContadorNotificacoes();
                        
                        return true;
                    } catch (e) {
                        console.error("Erro ao marcar todas notificações como lidas:", e);
                        return false;
                    }
                }
            },
            
            // Configurações do usuário
            config: {
                get() {
                    try {
                        return JSON.parse(localStorage.getItem('ggomes_config') || '{}');
                    } catch (e) {
                        console.error("Erro ao obter configurações:", e);
                        return {
                            registrosPorPagina: 10,
                            formatoData: 'dd/MM/yyyy',
                            temaEscuro: document.documentElement.classList.contains('dark')
                        };
                    }
                },
                
                update(config) {
                    try {
                        localStorage.setItem('ggomes_config', JSON.stringify(config));
                    } catch (e) {
                        console.error("Erro ao atualizar configurações:", e);
                        throw new Error("Não foi possível atualizar as configurações");
                    }
                }
            },
            
            // Exportar todos os dados
            exportData() {
                try {
                    const data = {
                        users: this.users.getAll(),
                        colhedoras: this.colhedoras.getAll(),
                        registros: this.registros.getAll(),
                        caminhoes: this.caminhoes.getAll(),
                        chuvas: this.chuvas.getAll(), // Incluir dados de chuva
                        config: this.config.get(),
                        notifications: this.notifications.getAll(),
                        exportDate: new Date().toISOString(),
                        version: '1.2.0' // Atualizar versão
                    };
                    
                    return JSON.stringify(data, null, 2);
                } catch (e) {
                    console.error("Erro ao exportar dados:", e);
                    throw new Error("Não foi possível exportar os dados");
                }
            },
            
            // Importar dados
            importData(jsonData) {
                try {
                    const data = JSON.parse(jsonData);
                    
                    // Validar que o formato dos dados é válido
                    if (!data.users || !data.colhedoras || !data.registros || !data.caminhoes) {
                        throw new Error("Formato de dados inválido para importação");
                    }
                    
                    // Importar dados mantendo pelo menos o usuário admin padrão
                    const adminUser = this.users.getByEmail("admin@ggomes.com");
                    
                    // Preservar usuário admin atual se não estiver nos dados importados
                    const adminInImport = data.users.find(u => u.email === "admin@ggomes.com");
                    if (!adminInImport && adminUser) {
                        data.users.push(adminUser);
                    }
                    
                    // Importar todos os dados
                    localStorage.setItem('ggomes_users', JSON.stringify(data.users));
                    localStorage.setItem('ggomes_colhedoras', JSON.stringify(data.colhedoras));
                    localStorage.setItem('ggomes_registros', JSON.stringify(data.registros));
                    localStorage.setItem('ggomes_caminhoes', JSON.stringify(data.caminhoes));
                    
                    // Importar registros de chuva se existirem
                    if (data.chuvas) {
                        localStorage.setItem('ggomes_chuvas', JSON.stringify(data.chuvas));
                    } else {
                        // Se não existirem, criar array vazio
                        localStorage.setItem('ggomes_chuvas', JSON.stringify([]));
                    }
                    
                    localStorage.setItem('ggomes_config', JSON.stringify(data.config));
                    
                    // Importar notificações se existirem
                    if (data.notifications) {
                        localStorage.setItem('ggomes_notifications', JSON.stringify(data.notifications));
                    }
                    
                    // Adicionar notificação sobre a importação
                    const notificacao = {
                        id: 'notif-' + Date.now(),
                        tipo: 'info',
                        titulo: 'Dados Importados',
                        mensagem: `Importação de dados concluída com sucesso em ${new Date().toLocaleString()}`,
                        dataHora: new Date().toISOString(),
                        lida: false
                    };
                    
                    // Obter notificações existentes
                    let notifications = JSON.parse(localStorage.getItem('ggomes_notifications') || '[]');
                    notifications.push(notificacao);
                    localStorage.setItem('ggomes_notifications', JSON.stringify(notifications));
                    
                    return true;
                } catch (e) {
                    console.error("Erro ao importar dados:", e);
                    throw new Error("Não foi possível importar os dados: " + e.message);
                }
            },
            
            // Limpar todos os dados
            clearAll() {
                try {
                    // Preservar apenas o usuário admin
                    const adminUser = this.users.getByEmail("admin@ggomes.com");
                    
                    localStorage.setItem('ggomes_colhedoras', JSON.stringify([]));
                    localStorage.setItem('ggomes_registros', JSON.stringify([]));
                    localStorage.setItem('ggomes_caminhoes', JSON.stringify([]));
                    localStorage.setItem('ggomes_chuvas', JSON.stringify([])); // Limpar registros de chuva
                    localStorage.setItem('ggomes_notifications', JSON.stringify([]));
                    
                    // Preservar usuário admin se existir
                    if (adminUser) {
                        localStorage.setItem('ggomes_users', JSON.stringify([adminUser]));
                    }
                    
                    // Adicionar notificação sobre a limpeza
                    const notificacao = {
                        id: 'notif-' + Date.now(),
                        tipo: 'warning',
                        titulo: 'Dados Limpos',
                        mensagem: 'Todos os dados do sistema foram limpos',
                        dataHora: new Date().toISOString(),
                        lida: false
                    };
                    
                    // Adicionar notificação
                    localStorage.setItem('ggomes_notifications', JSON.stringify([notificacao]));
                } catch (e) {
                    console.error("Erro ao limpar dados:", e);
                    throw new Error("Não foi possível limpar os dados");
                }
            }
        };
        
        // Inicializar o banco de dados
        DB.init();
        
        // Estado da aplicação
        const estado = {
            user: null,
            colhedoras: [],
            registros: [],
            caminhoes: [],
            chuvas: [], // Novo array para registros de chuva
            notifications: [],
            config: {
                registrosPorPagina: 10,
                formatoData: 'dd/MM/yyyy',
                temaEscuro: document.documentElement.classList.contains('dark')
            },
            paginacao: {
                paginaAtual: 1,
                totalPaginas: 1,
                registrosPorPagina: 10
            },
            filtros: {
                colhedora: '',
                cultura: '',
                dataInicio: '',
                dataFim: ''
            },
            culturas: [],
            dashboard: {
                period: 30,
                charts: {},
                trends: null,
                bestPerformers: null
            },
            weather: {
                temp: 25,
                condition: 'Ensolarado'
            }
        };
        
        // Módulo de autenticação
        const Auth = {
            login(email, password) {
                try {
                    const user = DB.users.getByEmail(email);
                    
                    if (user && user.password === password) {
                        // Salvar informações do usuário no estado
                        estado.user = {
                            id: user.id,
                            name: user.name,
                            email: user.email,
                            isAdmin: user.isAdmin
                        };
                        
                        // Adicionar notificação de login
                        const notificacao = {
                            id: 'notif-' + Date.now(),
                            tipo: 'success',
                            titulo: 'Login Realizado',
                            mensagem: `Bem-vindo, ${user.name}!`,
                            dataHora: new Date().toISOString(),
                            lida: false
                        };
                        DB.notifications.add(notificacao);
                        
                        return true;
                    }
                    
                    return false;
                } catch (e) {
                    console.error("Erro ao fazer login:", e);
                    return false;
                }
            },
            
            logout() {
                        try {
                            // Limpar informações do usuário
                            estado.user = null;
                            
                            // Mostrar tela de login
                            document.getElementById('auth-container').classList.remove('hidden');
                            document.getElementById('app-container').classList.add('hidden');
                            
                            return true;
                        } catch (e) {
                            console.error("Erro ao fazer logout:", e);
                            return false;
                        }
                    },
                    
                    isLoggedIn() {
                        return estado.user !== null;
                    },
                    
                    isAdmin() {
                        return estado.user && estado.user.isAdmin;
                    }
                };
                
                // Funções para formatação e cálculos
                const Utils = {
                    // Formatação de números
                    formatNumber(number, decimals = 2) {
                        return Number(number).toLocaleString('pt-BR', {
                            minimumFractionDigits: decimals,
                            maximumFractionDigits: decimals
                        });
                    },
                    
                    // Formatação de data
                    formatDate(dateString, format = null) {
                        if (!dateString) return '';
                        
                        const date = new Date(dateString);
                        
                        if (!format) {
                            format = estado.config.formatoData || 'dd/MM/yyyy';
                        }
                        
                        const day = date.getDate().toString().padStart(2, '0');
                        const month = (date.getMonth() + 1).toString().padStart(2, '0');
                        const year = date.getFullYear();
                        
                        if (format === 'dd/MM/yyyy') {
                            return `${day}/${month}/${year}`;
                        } else if (format === 'MM/dd/yyyy') {
                            return `${month}/${day}/${year}`;
                        } else {
                            return `${year}-${month}-${day}`;
                        }
                    },
                    
                    // Formatação de data e hora
                    formatDateTime(dateTimeString) {
                        if (!dateTimeString) return '';
                        
                        const date = new Date(dateTimeString);
                        const formattedDate = this.formatDate(dateTimeString);
                        
                        const hours = date.getHours().toString().padStart(2, '0');
                        const minutes = date.getMinutes().toString().padStart(2, '0');
                        
                        return `${formattedDate} ${hours}:${minutes}`;
                    },
                    
                    // Cálculo de produtividade
                    calcProdutividade(quantidade, area) {
                        if (!area || area == 0) return 0;
                        return quantidade / area;
                    },
                    
                    // Cálculo de rendimento
                    calcRendimento(quantidade, horas) {
                        if (!horas || horas == 0) return 0;
                        return quantidade / horas;
                    },
                    
                    // Gerar PDF
                    generatePDF(title, headers, data) {
                        try {
                            const { jsPDF } = window.jspdf;
                            const doc = new jsPDF();
                            
                            // Configurar título
                            doc.setFontSize(18);
                            doc.text(title, 14, 22);
                            
                            // Adicionar logo ou texto do sistema
                            doc.setFontSize(12);
                            doc.text('GGOMES-LOG', 14, 14);
                            
                            // Adicionar data de geração
                            doc.setFontSize(10);
                            doc.text(`Gerado em: ${new Date().toLocaleString('pt-BR')}`, 14, 30);
                            
                            // Adicionar tabela
                            doc.autoTable({
                                head: [headers],
                                body: data,
                                startY: 40,
                                styles: { fontSize: 9, cellPadding: 3 },
                                headStyles: { fillColor: [93, 92, 222] },
                                alternateRowStyles: { fillColor: [240, 240, 255] }
                            });
                            
                            // Adicionar rodapé
                            const pageCount = doc.internal.getNumberOfPages();
                            for (let i = 1; i <= pageCount; i++) {
                                doc.setPage(i);
                                doc.setFontSize(8);
                                doc.text(`Página ${i} de ${pageCount}`, doc.internal.pageSize.width - 20, doc.internal.pageSize.height - 10);
                                doc.text('GGOMES-LOG - Sistema de Acompanhamento de Produção', 14, doc.internal.pageSize.height - 10);
                            }
                            
                            // Salvar o PDF
                            doc.save(`${title.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.pdf`);
                            
                            return true;
                        } catch (e) {
                            console.error("Erro ao gerar PDF:", e);
                            mostrarToast("Erro ao gerar o PDF: " + e.message, "error");
                            return false;
                        }
                    },
                    
                    // Salvar arquivo local
                    downloadFile(content, filename, type = 'application/json') {
                        try {
                            const blob = new Blob([content], { type });
                            const url = URL.createObjectURL(blob);
                            
                            const a = document.createElement('a');
                            a.href = url;
                            a.download = filename;
                            document.body.appendChild(a);
                            a.click();
                            
                            setTimeout(() => {
                                document.body.removeChild(a);
                                URL.revokeObjectURL(url);
                            }, 100);
                            
                            return true;
                        } catch (e) {
                            console.error("Erro ao baixar arquivo:", e);
                            mostrarToast("Erro ao baixar o arquivo: " + e.message, "error");
                            return false;
                        }
                    }
                };
                
                // Função para mostrar notificações toast
                function mostrarToast(mensagem, tipo = 'info') {
                    const container = document.getElementById('toast-container');
                    
                    const toast = document.createElement('div');
                    toast.classList.add('toast', `toast-${tipo}`, 'px-4', 'py-3', 'rounded-lg', 'bg-white', 'dark:bg-gray-800', 'text-gray-800', 'dark:text-gray-100', 'shadow-lg');
                    
                    // Ícone baseado no tipo
                    let icone = '';
                    switch (tipo) {
                        case 'success':
                            icone = '<i class="fas fa-check-circle text-green-500 mr-3"></i>';
                            break;
                        case 'error':
                            icone = '<i class="fas fa-times-circle text-red-500 mr-3"></i>';
                            break;
                        case 'warning':
                            icone = '<i class="fas fa-exclamation-circle text-yellow-500 mr-3"></i>';
                            break;
                        default:
                            icone = '<i class="fas fa-info-circle text-blue-500 mr-3"></i>';
                    }
                    
                    toast.innerHTML = `
                        <div class="flex items-center">
                            ${icone}
                            <div>${mensagem}</div>
                        </div>
                    `;
                    
                    container.appendChild(toast);
                    
                    // Remover o toast após a animação
                    setTimeout(() => {
                        toast.remove();
                    }, 3000);
                }
                
                // Função para atualizar o contador de notificações
                function atualizarContadorNotificacoes() {
                    const badge = document.getElementById('notification-badge');
                    if (!badge) return;
                    
                    const unreadCount = DB.notifications.getUnread().length;
                    badge.textContent = unreadCount;
                    
                    // Esconder o badge se não houver notificações não lidas
                    badge.style.display = unreadCount > 0 ? 'inline-flex' : 'none';
                }
                
                // Funções para manipulação do DOM e eventos
                
                // Inicializar formulário de login
                function initLoginForm() {
                    document.getElementById('btn-login').addEventListener('click', async function() {
                        const email = document.getElementById('login-email').value;
                        const password = document.getElementById('login-password').value;
                        
                        if (!email || !password) {
                            mostrarToast("Por favor, preencha todos os campos", "warning");
                            return;
                        }
                        
                        // Mostrar loader
                        document.getElementById('login-form').classList.add('hidden');
                        document.getElementById('auth-loader').classList.remove('hidden');
                        
                        // Simular delay de autenticação
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        
                        // Tentar fazer login
                        const success = Auth.login(email, password);
                        
                        if (success) {
                            // Inicializar a aplicação com os dados do usuário
                            initApp();
                            
                            // Esconder tela de login e mostrar aplicação
                            document.getElementById('auth-container').classList.add('hidden');
                            document.getElementById('app-container').classList.remove('hidden');
                        } else {
                            mostrarToast("Email ou senha incorretos", "error");
                            
                            // Esconder loader e mostrar formulário novamente
                            document.getElementById('login-form').classList.remove('hidden');
                            document.getElementById('auth-loader').classList.add('hidden');
                        }
                    });
                    
                    // Mostrar/esconder senha
                    document.getElementById('toggle-password').addEventListener('click', function() {
                        const passwordInput = document.getElementById('login-password');
                        const icon = this.querySelector('i');
                        
                        if (passwordInput.type === 'password') {
                            passwordInput.type = 'text';
                            icon.classList.remove('fa-eye');
                            icon.classList.add('fa-eye-slash');
                        } else {
                            passwordInput.type = 'password';
                            icon.classList.remove('fa-eye-slash');
                            icon.classList.add('fa-eye');
                        }
                    });
                }
                
                // Inicializar a aplicação
                function initApp() {
                    // Atualizar informações do usuário
                    document.getElementById('user-name').textContent = estado.user.name;
                    document.getElementById('sidebar-user-name').textContent = estado.user.name;
                    
                    const roleBadge = document.getElementById('user-role-badge');
                    const sidebarUserRole = document.getElementById('sidebar-user-role');
                    
                    if (estado.user.isAdmin) {
                        roleBadge.textContent = 'Admin';
                        roleBadge.classList.add('bg-primary-100', 'text-primary-800', 'dark:bg-primary-900', 'dark:text-primary-300');
                        sidebarUserRole.textContent = 'Administrador';
                    } else {
                        roleBadge.textContent = 'Usuário';
                        roleBadge.classList.add('bg-gray-100', 'text-gray-800', 'dark:bg-gray-700', 'dark:text-gray-300');
                        sidebarUserRole.textContent = 'Usuário';
                    }
                    
                    // Exibir/esconder elementos baseados no perfil do usuário
                    const adminElements = document.querySelectorAll('.admin-only');
                    adminElements.forEach(el => {
                        el.style.display = estado.user.isAdmin ? 'flex' : 'none';
                    });
                    
                    // Carregar dados iniciais
                    carregarDados();
                    
                    // Inicializar componentes e eventos
                    initNavigation();
                    initDashboard();
                    initColhedoras();
                    initProducao();
                    initChuvas();
                    initRegistros();
                    initCaminhoes();
                    initConfig();
                    initUsuarios();
                    initNotifications();
                    
                    // Inicializar data atual
                    updateCurrentDate();
                    
                    // Inicializar weather widget
                    initWeatherWidget();
                    
                    // Inicializar botão de tema
                    initThemeToggle();
                    
                    // Inicializar modal de limpar dados
                    initClearDataModal();
                    
                    // Inicializar ajuda
                    initHelp();
                }
                
                // Carregar dados da aplicação
                function carregarDados() {
                    try {
                        // Carregar dados de colhedoras
                        estado.colhedoras = DB.colhedoras.getAll();
                        
                        // Carregar dados de registros
                        estado.registros = DB.registros.getAll();
                        
                        // Carregar registros de caminhões
                        estado.caminhoes = DB.caminhoes.getAll();
                        
                        // Carregar registros de chuva
                        estado.chuvas = DB.chuvas.getAll();
                        
                        // Carregar notificações
                        estado.notifications = DB.notifications.getAll();
                        
                        // Carregar configurações
                        estado.config = DB.config.get();
                        
                        // Extrair culturas únicas
                        estado.culturas = [...new Set(estado.registros.map(r => r.cultura).filter(c => c))];
                        
                        // Aplicar tema conforme configurações
                        if (estado.config.temaEscuro) {
                            document.documentElement.classList.add('dark');
                        } else {
                            document.documentElement.classList.remove('dark');
                        }
                        
                        // Atualizar contador de notificações
                        atualizarContadorNotificacoes();
                    } catch (e) {
                        console.error("Erro ao carregar dados:", e);
                        mostrarToast("Erro ao carregar dados do sistema", "error");
                    }
                }
                
                // Atualizar a data atual
                function updateCurrentDate() {
                    const dateElement = document.getElementById('current-date');
                    if (!dateElement) return;
                    
                    const today = new Date();
                    dateElement.textContent = today.toLocaleDateString('pt-BR', {
                        weekday: 'short',
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric'
                    });
                }
                
                // Inicializar widget de clima
                function initWeatherWidget() {
                    const weatherWidget = document.getElementById('weather-widget');
                    const weatherIcon = document.getElementById('weather-icon');
                    const weatherTemp = document.getElementById('weather-temp');
                    
                    if (!weatherWidget || !weatherIcon || !weatherTemp) return;
                    
                    // Mostrar o widget
                    weatherWidget.classList.remove('hidden');
                    
                    // Dados simulados de clima
                    weatherTemp.textContent = `${estado.weather.temp}°C`;
                    
                    // Atualizar ícone baseado na condição
                    if (estado.weather.condition === 'Ensolarado') {
                        weatherIcon.className = 'fas fa-sun text-yellow-500 mr-2';
                    } else if (estado.weather.condition === 'Nublado') {
                        weatherIcon.className = 'fas fa-cloud text-gray-500 mr-2';
                    } else if (estado.weather.condition === 'Chuvoso') {
                        weatherIcon.className = 'fas fa-cloud-rain text-blue-500 mr-2 icon-rain';
                    } else {
                        weatherIcon.className = 'fas fa-cloud-sun text-blue-500 mr-2';
                    }
                }
                
                // Inicializar toggle de tema claro/escuro
                function initThemeToggle() {
                    const themeToggle = document.getElementById('toggle-theme');
                    
                    if (!themeToggle) return;
                    
                    themeToggle.addEventListener('click', function() {
                        // Alternar classe dark
                        document.documentElement.classList.toggle('dark');
                        
                        // Atualizar configuração
                        estado.config.temaEscuro = document.documentElement.classList.contains('dark');
                        DB.config.update(estado.config);
                    });
                }
                
                // Modal de confirmação para limpar dados
                function initClearDataModal() {
                    const modal = document.getElementById('modal-limpar-dados');
                    const btnLimparDados = document.getElementById('btn-limpar-dados');
                    const btnConfirmarLimpar = document.getElementById('btn-confirmar-limpar');
                    const btnCancelarLimpar = document.getElementById('btn-cancelar-limpar');
                    const confirmacaoTexto = document.getElementById('confirmacao-texto');
                    
                    if (!modal || !btnLimparDados || !btnConfirmarLimpar || !btnCancelarLimpar || !confirmacaoTexto) return;
                    
                    btnLimparDados.addEventListener('click', function() {
                        modal.classList.remove('hidden');
                        modal.classList.add('flex');
                        confirmacaoTexto.value = '';
                        btnConfirmarLimpar.disabled = true;
                        btnConfirmarLimpar.classList.add('opacity-50', 'cursor-not-allowed');
                    });
                    
                    btnCancelarLimpar.addEventListener('click', function() {
                        modal.classList.add('hidden');
                        modal.classList.remove('flex');
                    });
                    
                    confirmacaoTexto.addEventListener('input', function() {
                        if (this.value === 'CONFIRMAR') {
                            btnConfirmarLimpar.disabled = false;
                            btnConfirmarLimpar.classList.remove('opacity-50', 'cursor-not-allowed');
                        } else {
                            btnConfirmarLimpar.disabled = true;
                            btnConfirmarLimpar.classList.add('opacity-50', 'cursor-not-allowed');
                        }
                    });
                    
                    btnConfirmarLimpar.addEventListener('click', function() {
                        if (confirmacaoTexto.value === 'CONFIRMAR') {
                            try {
                                // Limpar todos os dados
                                DB.clearAll();
                                
                                // Recarregar dados
                                carregarDados();
                                
                                // Atualizar todas as views
                                atualizarDashboard();
                                atualizarListaColhedoras();
                                atualizarRegistros();
                                atualizarCaminhoes();
                                atualizarChuvas();
                                atualizarUsuarios();
                                
                                mostrarToast("Todos os dados foram limpos com sucesso", "success");
                                
                                // Fechar modal
                                modal.classList.add('hidden');
                                modal.classList.remove('flex');
                            } catch (e) {
                                console.error("Erro ao limpar dados:", e);
                                mostrarToast("Erro ao limpar dados: " + e.message, "error");
                            }
                        }
                    });
                }
                
                // Inicializar navegação
                function initNavigation() {
                    // Navegação entre telas
                    document.querySelectorAll('.sidebar-link').forEach(link => {
                        link.addEventListener('click', function(e) {
                            e.preventDefault();
                            
                            // Remover classe 'active' de todos os links
                            document.querySelectorAll('.sidebar-link').forEach(l => {
                                l.classList.remove('active', 'bg-primary-100', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
                                l.classList.add('hover:bg-gray-100', 'dark:hover:bg-gray-700');
                            });
                            
                            // Adicionar classe 'active' ao link clicado
                            this.classList.add('active', 'bg-primary-100', 'dark:bg-primary-900', 'text-primary-700', 'dark:text-primary-300');
                            this.classList.remove('hover:bg-gray-100', 'dark:hover:bg-gray-700');
                            
                            // Obter a seção correspondente
                            const section = this.getAttribute('href').substring(1);
                            
                            // Esconder todas as seções de conteúdo
                            document.querySelectorAll('.content').forEach(content => {
                                content.classList.add('hidden');
                            });
                            
                            // Mostrar a seção correspondente
                            const contentElement = document.getElementById(`content-${section}`);
                            if (contentElement) {
                                contentElement.classList.remove('hidden');
                            }
                            
                            // Atualizar dados específicos da seção se necessário
                            if (section === 'dashboard') {
                                atualizarDashboard();
                            } else if (section === 'colhedoras') {
                                atualizarListaColhedoras();
                            } else if (section === 'registros') {
                                atualizarRegistros();
                            } else if (section === 'producao') {
                                atualizarProducao();
                            } else if (section === 'caminhoes') {
                                atualizarCaminhoes();
                            } else if (section === 'chuva') {
                                atualizarChuvas();
                            } else if (section === 'usuarios') {
                                atualizarUsuarios();
                            }
                        });
                    });
                    
                    // Logout
                    document.getElementById('btn-logout').addEventListener('click', function() {
                        Auth.logout();
                    });
                    
                    // Função para exportar dados
                    document.getElementById('btn-export-data').addEventListener('click', function() {
                        try {
                            const jsonData = DB.exportData();
                            Utils.downloadFile(jsonData, 'ggomes_log_backup.json');
                            mostrarToast("Dados exportados com sucesso", "success");
                        } catch (e) {
                            console.error("Erro ao exportar dados:", e);
                            mostrarToast("Erro ao exportar dados: " + e.message, "error");
                        }
                    });
                    
                    // Botão de notificações
                    document.getElementById('btn-notifications').addEventListener('click', function() {
                        const panel = document.getElementById('notifications-panel');
                        panel.classList.toggle('translate-x-full');
                    });
                    
                    // Fechar painel de notificações
                    document.getElementById('close-notifications').addEventListener('click', function() {
                        document.getElementById('notifications-panel').classList.add('translate-x-full');
                    });
                }
                
                // Inicializar dashboard
                function initDashboard() {
                    const dashboardPeriod = document.getElementById('dashboard-period');
                    const refreshDashboard = document.getElementById('refresh-dashboard');
                    
                    // Configurar período
                    if (dashboardPeriod) {
                        dashboardPeriod.addEventListener('change', function() {
                            estado.dashboard.period = Number(this.value);
                            atualizarDashboard();
                        });
                    }
                    
                    // Botão de atualizar
                    if (refreshDashboard) {
                        refreshDashboard.addEventListener('click', function() {
                            atualizarDashboard();
                        });
                    }
                    
                    // Alternar entre tabs
                    document.querySelectorAll('.dashboard-tab').forEach(tab => {
                        tab.addEventListener('click', function() {
                            // Remover classe active de todas as tabs
                            document.querySelectorAll('.dashboard-tab').forEach(t => {
                                t.classList.remove('tab-active');
                            });
                            
                            // Adicionar classe active à tab clicada
                            this.classList.add('tab-active');
                            
                            // Esconder todos os conteúdos de tabs
                            document.querySelectorAll('.dashboard-tab-content').forEach(content => {
                                content.classList.add('hidden');
                            });
                            
                            // Mostrar o conteúdo da tab selecionada
                            const tabName = this.getAttribute('data-tab');
                            document.getElementById(`tab-${tabName}`).classList.remove('hidden');
                        });
                    });
                    
                    // Inicializar dashboard com dados iniciais
                    atualizarDashboard();
                }
                
                // Atualizar dashboard
                function atualizarDashboard() {
                    try {
                        // Obter período selecionado
                        const period = estado.dashboard.period;
                        
                        // Carregar tendências e melhores desempenhos
                        estado.dashboard.trends = DB.registros.getTrends(period);
                        estado.dashboard.bestPerformers = DB.registros.getBestPerformers(period);
                        
                        // Atualizar cards de estatísticas
                        updateDashboardCards();
                        
                        // Atualizar gráficos
                        updateDashboardCharts();
                        
                        // Atualizar seção de análise de desempenho
                        updatePerformanceSection();
                        
                        // Atualizar estatísticas de caminhões
                        updateTruckStatistics();
                        
                        // Atualizar estatísticas de paradas por chuva
                        updateChuvaStatistics();
                        
                        // Atualizar resumo do dashboard
                        updateDashboardSummary();
                    } catch (e) {
                        console.error("Erro ao atualizar dashboard:", e);
                        mostrarToast("Erro ao atualizar o dashboard", "error");
                    }
                }
                
                // Atualizar cards de estatísticas do dashboard
                function updateDashboardCards() {
                    try {
                        const trends = estado.dashboard.trends;
                        if (!trends) return;
                        
                        // Total colhido
                        document.getElementById('dash-total-colhido').textContent = `${Utils.formatNumber(trends.totalColhido.current)} T`;
                        document.getElementById('quick-total-colhido').textContent = `${Utils.formatNumber(trends.totalColhido.current)} T`;
                        
                        const totalTrendPercent = Math.round(trends.totalColhido.change);
                        const totalTrendElement = document.getElementById('dash-total-trend');
                        totalTrendElement.innerHTML = `
                            <i class="fas fa-arrow-${totalTrendPercent >= 0 ? 'up' : 'down'} mr-1 text-${totalTrendPercent >= 0 ? 'green' : 'red'}-500"></i>
                            <span>${Math.abs(totalTrendPercent)}% vs. período anterior</span>
                        `;
                        
                        document.getElementById('dash-total-progress').style.width = `${Math.min(100, Math.max(0, totalTrendPercent + 50))}%`;
                        
                        // Produtividade diária
                        document.getElementById('dash-area-total').textContent = `${Utils.formatNumber(trends.dailyProductivity.current)} T/dia`;
                        
                        const areaTrendPercent = Math.round(trends.dailyProductivity.change);
                        const areaTrendElement = document.getElementById('dash-area-trend');
                        areaTrendElement.innerHTML = `
                            <i class="fas fa-arrow-${areaTrendPercent >= 0 ? 'up' : 'down'} mr-1 text-${areaTrendPercent >= 0 ? 'green' : 'red'}-500"></i>
                            <span>${Math.abs(areaTrendPercent)}% vs. período anterior</span>
                        `;
                        
                        document.getElementById('dash-area-progress').style.width = `${Math.min(100, Math.max(0, areaTrendPercent + 50))}%`;
                        
                        // Área total
                        document.getElementById('quick-area-total').textContent = `${Utils.formatNumber(trends.areaTotal.current)} ha`;
                        
                        // Produtividade
                        document.getElementById('dash-produtividade').textContent = `${Utils.formatNumber(trends.produtividade.current)} T/ha`;
                        
                        const produtividadeTrendPercent = Math.round(trends.produtividade.change);
                        const produtividadeTrendElement = document.getElementById('dash-produtividade-trend');
                        produtividadeTrendElement.innerHTML = `
                            <i class="fas fa-arrow-${produtividadeTrendPercent >= 0 ? 'up' : 'down'} mr-1 text-${produtividadeTrendPercent >= 0 ? 'green' : 'red'}-500"></i>
                            <span>${Math.abs(produtividadeTrendPercent)}% vs. período anterior</span>
                        `;
                        
                        document.getElementById('dash-produtividade-progress').style.width = `${Math.min(100, Math.max(0, produtividadeTrendPercent + 50))}%`;
                        
                        // Paradas por chuva
                        const totalDiasChuva = DB.chuvas.getTotalDias(period);
                        document.getElementById('dash-paradas-chuva').textContent = `${totalDiasChuva} dias`;
                        document.getElementById('quick-paradas-chuva').textContent = `${totalDiasChuva} dias`;
                        
                        // Tendência de paradas por chuva (simulado para fins de demonstração)
                        const paradasTrendPercent = -5; // Valor simulado
                        const paradasTrendElement = document.getElementById('dash-paradas-trend');
                        paradasTrendElement.innerHTML = `
                            <i class="fas fa-arrow-${paradasTrendPercent >= 0 ? 'up' : 'down'} mr-1 text-${paradasTrendPercent >= 0 ? 'red' : 'green'}-500"></i>
                            <span>${Math.abs(paradasTrendPercent)}% vs. período anterior</span>
                        `;
                        
                        document.getElementById('dash-paradas-progress').style.width = `${Math.min(100, Math.max(0, 50 - paradasTrendPercent))}%`;
                        
                        // Colhedoras cadastradas
                        document.getElementById('quick-colhedoras').textContent = estado.colhedoras.length;
                    } catch (e) {
                        console.error("Erro ao atualizar cards do dashboard:", e);
                    }
                }
                
                // Atualizar gráficos do dashboard
                function updateDashboardCharts() {
                    try {
                        renderizarGraficoProducaoTempo();
                        renderizarGraficoCulturas();
                        renderizarGraficoColhedoras();
                        renderizarGraficoCulturasComparacao();
                        renderizarGraficoParadasChuva();
                        renderizarGraficoCaminhoesComparacao();
                    } catch (e) {
                        console.error("Erro ao atualizar gráficos do dashboard:", e);
                    }
                }
                
                // Renderizar gráfico de produção ao longo do tempo
                function renderizarGraficoProducaoTempo() {
                    const chartElement = document.getElementById('chart-producao-tempo');
                    if (!chartElement) return;
                    
                    // Destruir gráfico existente
                    if (estado.dashboard.charts.producaoTempo) {
                        estado.dashboard.charts.producaoTempo.destroy();
                    }
                    
                    // Obter dados de produção temporal
                    const data = DB.registros.getTimeSeriesData(estado.dashboard.period);
                    
                    // Preparar dados para o gráfico
                    const labels = data.map(d => Utils.formatDate(d.date));
                    const valuesQuantidade = data.map(d => d.quantidade);
                    const valuesArea = data.map(d => d.area);
                    
                    // Criar novo gráfico
                    estado.dashboard.charts.producaoTempo = new Chart(chartElement, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Produção (T)',
                                    data: valuesQuantidade,
                                    borderColor: '#7a63f1',
                                    backgroundColor: 'rgba(122, 99, 241, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.3,
                                    fill: true
                                },
                                {
                                    label: 'Área Colhida (ha)',
                                    data: valuesArea,
                                    borderColor: '#35a57d',
                                    backgroundColor: 'rgba(53, 165, 125, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.3,
                                    fill: true,
                                    borderDash: [5, 5]
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        font: {
                                            size: 11
                                        }
                                    }
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false
                                }
                            },
                            scales: {
                                x: {
                                    grid: {
                                        display: false
                                    },
                                    ticks: {
                                        maxRotation: 45,
                                        minRotation: 45
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        borderDash: [2, 2]
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Renderizar gráfico de distribuição por cultura
                function renderizarGraficoCulturas() {
                    const chartElement = document.getElementById('chart-culturas');
                    if (!chartElement) return;
                    
                    // Destruir gráfico existente
                    if (estado.dashboard.charts.culturas) {
                        estado.dashboard.charts.culturas.destroy();
                    }
                    
                    // Obter estatísticas por cultura
                    const culturaStats = DB.registros.getStatsByCategory('cultura', estado.dashboard.period);
                    
                    // Separar top 5 culturas + outros
                    let sortedCulturas = [...culturaStats].sort((a, b) => b.quantidade - a.quantidade);
                    
                    let labels, values, colors;
                    
                    if (sortedCulturas.length > 5) {
                        const top5 = sortedCulturas.slice(0, 5);
                        const others = sortedCulturas.slice(5);
                        
                        const othersTotal = others.reduce((sum, current) => sum + current.quantidade, 0);
                        
                        labels = [...top5.map(c => c.name), 'Outros'];
                        values = [...top5.map(c => c.quantidade), othersTotal];
                    } else {
                        labels = sortedCulturas.map(c => c.name);
                        values = sortedCulturas.map(c => c.quantidade);
                    }
                    
                    // Cores para o gráfico
                    colors = [
                        'rgba(122, 99, 241, 0.7)',
                        'rgba(53, 165, 125, 0.7)',
                        'rgba(254, 134, 5, 0.7)',
                        'rgba(16, 185, 129, 0.7)',
                        'rgba(245, 158, 11, 0.7)',
                        'rgba(107, 114, 128, 0.7)'
                    ];
                    
                    // Criar novo gráfico
                    estado.dashboard.charts.culturas = new Chart(chartElement, {
                        type: 'pie',
                        data: {
                            labels: labels,
                            datasets: [{
                                data: values,
                                backgroundColor: colors,
                                borderColor: 'white',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'right',
                                    labels: {
                                        font: {
                                            size: 11
                                        }
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const value = context.raw;
                                            const total = context.dataset.data.reduce((sum, val) => sum + val, 0);
                                            const percentage = ((value / total) * 100).toFixed(1);
                                            return `${context.label}: ${Utils.formatNumber(value)} T (${percentage}%)`;
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Renderizar gráfico de comparação de colhedoras
                function renderizarGraficoColhedoras() {
                    const chartElement = document.getElementById('chart-colhedoras-comparacao');
                    if (!chartElement) return;
                    
                    // Destruir gráfico existente
                    if (estado.dashboard.charts.colhedoras) {
                        estado.dashboard.charts.colhedoras.destroy();
                    }
                    
                    const bestPerformers = estado.dashboard.bestPerformers;
                    if (!bestPerformers) return;
                    
                    // Obter dados das colhedoras
                    const colhedoraStats = bestPerformers.colhedoras.all;
                    
                    // Ordenar por volume
                    const sortedColhedoras = [...colhedoraStats].sort((a, b) => b.quantidade - a.quantidade);
                    
                    // Limitar a 8 colhedoras para o gráfico
                    const limitedColhedoras = sortedColhedoras.slice(0, 8);
                    
                    // Preparar dados para o gráfico
                    const labels = limitedColhedoras.map(c => c.name);
                    const valuesQuantidade = limitedColhedoras.map(c => c.quantidade);
                    const valuesProdutividade = limitedColhedoras.map(c => c.produtividade);
                    
                    // Criar novo gráfico
                    estado.dashboard.charts.colhedoras = new Chart(chartElement, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Produção (T)',
                                    data: valuesQuantidade,
                                    backgroundColor: 'rgba(122, 99, 241, 0.7)',
                                    borderColor: 'rgba(122, 99, 241, 1)',
                                    borderWidth: 1,
                                    yAxisID: 'y'
                                },
                                {
                                    label: 'Produtividade (T/ha)',
                                    data: valuesProdutividade,
                                    type: 'line',
                                    borderColor: 'rgba(254, 134, 5, 1)',
                                    backgroundColor: 'rgba(254, 134, 5, 0.2)',
                                    borderWidth: 2,
                                    pointBackgroundColor: 'rgba(254, 134, 5, 1)',
                                    tension: 0.2,
                                    fill: false,
                                    yAxisID: 'y1'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        font: {
                                            size: 11
                                        }
                                    }
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false
                                }
                            },
                            scales: {
                                x: {
                                    grid: {
                                        display: false
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Produção (T)'
                                    },
                                    grid: {
                                        borderDash: [2, 2]
                                    }
                                },
                                y1: {
                                    beginAtZero: true,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'Produtividade (T/ha)'
                                    },
                                    grid: {
                                        display: false
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Renderizar gráfico de comparação de culturas
                function renderizarGraficoCulturasComparacao() {
                    const chartElement = document.getElementById('chart-culturas-comparacao');
                    if (!chartElement) return;
                    
                    // Destruir gráfico existente
                    if (estado.dashboard.charts.culturasComparacao) {
                        estado.dashboard.charts.culturasComparacao.destroy();
                    }
                    
                    const bestPerformers = estado.dashboard.bestPerformers;
                    if (!bestPerformers) return;
                    
                    // Obter dados das culturas
                    const culturaStats = bestPerformers.culturas.all;
                    
                    // Ordenar por volume
                    const sortedCulturas = [...culturaStats].sort((a, b) => b.quantidade - a.quantidade);
                    
                    // Limitar a 8 culturas para o gráfico
                    const limitedCulturas = sortedCulturas.slice(0, 8);
                    
                    // Preparar dados para o gráfico
                    const labels = limitedCulturas.map(c => c.name);
                    const valuesQuantidade = limitedCulturas.map(c => c.quantidade);
                    const valuesArea = limitedCulturas.map(c => c.area);
                    
                    // Criar novo gráfico
                    estado.dashboard.charts.culturasComparacao = new Chart(chartElement, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Produção (T)',
                                    data: valuesQuantidade,
                                    backgroundColor: 'rgba(53, 165, 125, 0.7)',
                                    borderColor: 'rgba(53, 165, 125, 1)',
                                    borderWidth: 1,
                                    yAxisID: 'y'
                                },
                                {
                                    label: 'Área (ha)',
                                    data: valuesArea,
                                    backgroundColor: 'rgba(107, 114, 128, 0.7)',
                                    borderColor: 'rgba(107, 114, 128, 1)',
                                    borderWidth: 1,
                                    yAxisID: 'y1'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        font: {
                                            size: 11
                                        }
                                    }
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false
                                }
                            },
                            scales: {
                                x: {
                                    grid: {
                                        display: false
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Produção (T)'
                                    },
                                    grid: {
                                        borderDash: [2, 2]
                                    }
                                },
                                y1: {
                                    beginAtZero: true,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'Área (ha)'
                                    },
                                    grid: {
                                        display: false
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Renderizar gráfico de paradas por chuva
                function renderizarGraficoParadasChuva() {
                    const chartElement = document.getElementById('chart-paradas-chuva');
                    if (!chartElement) return;
                    
                    // Destruir gráfico existente
                    if (estado.dashboard.charts.paradasChuva) {
                        estado.dashboard.charts.paradasChuva.destroy();
                    }
                    
                    // Obter dados de paradas por chuva
                    const data = DB.chuvas.getTimeSeriesData(estado.dashboard.period);
                    
                    // Preparar dados para o gráfico
                    const labels = data.map(d => Utils.formatDate(d.date));
                    const valuesDias = data.map(d => d.dias);
                    
                    // Criar novo gráfico
                    estado.dashboard.charts.paradasChuva = new Chart(chartElement, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Dias Parados',
                                data: valuesDias,
                                backgroundColor: 'rgba(239, 68, 68, 0.7)',
                                borderColor: 'rgba(239, 68, 68, 1)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    callbacks: {
                                        title: function(context) {
                                            return Utils.formatDate(data[context[0].dataIndex].date);
                                        },
                                        label: function(context) {
                                            const value = context.raw;
                                            if (value === 0) return 'Sem paradas';
                                            if (value === 1) return '1 dia parado';
                                            return `${value} dias parados`;
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    grid: {
                                        display: false
                                    },
                                    ticks: {
                                        maxRotation: 45,
                                        minRotation: 45
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        borderDash: [2, 2]
                                    },
                                    title: {
                                        display: true,
                                        text: 'Dias Parados'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Renderizar gráfico de análise de caminhões
                function renderizarGraficoCaminhoesComparacao() {
                    const chartElement = document.getElementById('chart-caminhoes-tempo');
                    if (!chartElement) return;
                    
                    // Destruir gráfico existente
                    if (estado.dashboard.charts.caminhoesTempo) {
                        estado.dashboard.charts.caminhoesTempo.destroy();
                    }
                    
                    // Obter dados de caminhões
                    const data = DB.caminhoes.getTimeSeriesData(estado.dashboard.period);
                    
                    // Preparar dados para o gráfico
                    const labels = data.map(d => Utils.formatDate(d.date));
                    const valuesCampo = data.map(d => d.tempoCampoMedio);
                    const valuesPatio = data.map(d => d.tempoPatioMedio);
                    
                    // Criar novo gráfico
                    estado.dashboard.charts.caminhoesTempo = new Chart(chartElement, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'Tempo Médio de Campo (min)',
                                    data: valuesCampo,
                                    borderColor: 'rgba(16, 185, 129, 1)',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.3,
                                    fill: true
                                },
                                {
                                    label: 'Tempo Médio de Pátio (min)',
                                    data: valuesPatio,
                                    borderColor: 'rgba(59, 130, 246, 1)',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    borderWidth: 2,
                                    tension: 0.3,
                                    fill: true
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                    labels: {
                                        font: {
                                            size: 11
                                        }
                                    }
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false
                                }
                            },
                            scales: {
                                x: {
                                    grid: {
                                        display: false
                                    },
                                    ticks: {
                                        maxRotation: 45,
                                        minRotation: 45
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        borderDash: [2, 2]
                                    },
                                    title: {
                                        display: true,
                                        text: 'Tempo (min)'
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Atualizar seção de análise de desempenho
                function updatePerformanceSection() {
                    try {
                        const bestPerformers = estado.dashboard.bestPerformers;
                        if (!bestPerformers) return;
                        
                        // Tab Colhedoras
                        if (bestPerformers.colhedoras.bestProductivity) {
                            document.getElementById('best-productivity-colhedora').textContent = bestPerformers.colhedoras.bestProductivity.name;
                            document.getElementById('best-productivity-value').textContent = `${Utils.formatNumber(bestPerformers.colhedoras.bestProductivity.produtividade)} T/ha`;
                        }
                        
                        if (bestPerformers.colhedoras.bestVolume) {
                            document.getElementById('best-volume-colhedora').textContent = bestPerformers.colhedoras.bestVolume.name;
                            document.getElementById('best-volume-value').textContent = `${Utils.formatNumber(bestPerformers.colhedoras.bestVolume.quantidade)} T`;
                        }
                        
                        if (bestPerformers.colhedoras.bestYield) {
                            document.getElementById('best-yield-colhedora').textContent = bestPerformers.colhedoras.bestYield.name;
                            document.getElementById('best-yield-value').textContent = `${Utils.formatNumber(bestPerformers.colhedoras.bestYield.rendimento)} T/h`;
                        }
                        
                        // Tab Culturas
                        if (bestPerformers.culturas.bestProductivity) {
                            document.getElementById('best-productivity-cultura').textContent = bestPerformers.culturas.bestProductivity.name;
                            document.getElementById('best-productivity-cultura-value').textContent = `${Utils.formatNumber(bestPerformers.culturas.bestProductivity.produtividade)} T/ha`;
                        }
                        
                        if (bestPerformers.culturas.bestVolume) {
                            document.getElementById('best-volume-cultura').textContent = bestPerformers.culturas.bestVolume.name;
                            document.getElementById('best-volume-cultura-value').textContent = `${Utils.formatNumber(bestPerformers.culturas.bestVolume.quantidade)} T`;
                        }
                        
                        if (bestPerformers.culturas.bestArea) {
                            document.getElementById('best-area-cultura').textContent = bestPerformers.culturas.bestArea.name;
                            document.getElementById('best-area-cultura-value').textContent = `${Utils.formatNumber(bestPerformers.culturas.bestArea.area)} ha`;
                        }
                    } catch (e) {
                        console.error("Erro ao atualizar seção de análise de desempenho:", e);
                    }
                }
                
                // Atualizar estatísticas de caminhões
                function updateTruckStatistics() {
                    try {
                        // Obter tendências de caminhões
                        const truckTrends = DB.caminhoes.getTrends(estado.dashboard.period);
                        if (!truckTrends) return;
                        
                        // Atualizar cards de estatísticas
                        document.getElementById('dash-tempo-campo').textContent = `${Utils.formatNumber(truckTrends.tempoCampo.current)} min`;
                        document.getElementById('dash-tempo-patio').textContent = `${Utils.formatNumber(truckTrends.tempoPatio.current)} min`;
                        document.getElementById('dash-total-caminhoes').textContent = truckTrends.totalCaminhoes.current;
                        
                        // Progresso de tempo de campo (simulado para fins de demonstração)
                        const campoProgressPercent = Math.min(100, Math.round((truckTrends.tempoCampo.current / 120) * 100));
                        document.getElementById('dash-tempo-campo-progress').style.width = `${campoProgressPercent}%`;
                        
                        // Progresso de tempo de pátio (simulado para fins de demonstração)
                        const patioProgressPercent = Math.min(100, Math.round((truckTrends.tempoPatio.current / 60) * 100));
                        document.getElementById('dash-tempo-patio-progress').style.width = `${patioProgressPercent}%`;
                        
                        // Tendência de caminhões
                        const caminhoesTrendPercent = Math.round(truckTrends.totalCaminhoes.change);
                        const caminhoesTrendElement = document.getElementById('dash-caminhoes-trend');
                        caminhoesTrendElement.innerHTML = `
                            <i class="fas fa-arrow-${caminhoesTrendPercent >= 0 ? 'up' : 'down'} mr-1 text-${caminhoesTrendPercent >= 0 ? 'green' : 'red'}-500"></i>
                            <span>${Math.abs(caminhoesTrendPercent)}% vs. período anterior</span>
                        `;
                    } catch (e) {
                        console.error("Erro ao atualizar estatísticas de caminhões:", e);
                    }
                }
                
                // Atualizar estatísticas de paradas por chuva
                function updateChuvaStatistics() {
                    try {
                        const period = estado.dashboard.period;
                        
                        // Total de dias parados
                        const totalDiasChuva = DB.chuvas.getTotalDias(period);
                        document.getElementById('total-dias-chuva').textContent = `${totalDiasChuva} dias`;
                        
                        // Total de ocorrências de chuva
                        const chuvasPeriodo = DB.chuvas.getByPeriod(period);
                        document.getElementById('total-ocorrencias-chuva').textContent = chuvasPeriodo.length;
                        
                        // Impacto estimado
                        const impactoEstimado = DB.chuvas.calcularImpactoEstimado(period);
                        document.getElementById('impacto-estimado-chuva').textContent = `${Utils.formatNumber(impactoEstimado)} T`;
                    } catch (e) {
                        console.error("Erro ao atualizar estatísticas de paradas por chuva:", e);
                    }
                }
                
                // Atualizar resumo do dashboard
                function updateDashboardSummary() {
                    try {
                        // Número de colhedoras
                        document.getElementById('qtd-colhedoras').textContent = estado.colhedoras.length;
                        
                        // Número de registros
                        document.getElementById('qtd-registros').textContent = estado.registros.length;
                        
                        // Número de usuários
                        const usuarios = DB.users.getAll();
                        document.getElementById('qtd-usuarios').textContent = usuarios.length;
                    } catch (e) {
                        console.error("Erro ao atualizar resumo do dashboard:", e);
                    }
                }
                
                // Inicializar módulo de colhedoras
                function initColhedoras() {
                    // Formulário de adição/edição de colhedora
                    document.getElementById('form-colhedora').addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const id = document.getElementById('colhedora-id').value;
                        const modelo = document.getElementById('colhedora-modelo').value;
                        const marca = document.getElementById('colhedora-marca').value;
                        const ano = document.getElementById('colhedora-ano').value;
                        const observacoes = document.getElementById('colhedora-observacoes').value;
                        
                        if (!id || !modelo) {
                            mostrarToast("Preencha os campos obrigatórios", "warning");
                            return;
                        }
                        
                        try {
                            const modoEdicao = document.getElementById('colhedora-id').disabled;
                            
                            const colhedora = {
                                id,
                                modelo,
                                marca,
                                ano,
                                observacoes
                            };
                            
                            if (modoEdicao) {
                                // Atualizar colhedora existente
                                DB.colhedoras.update(colhedora);
                                mostrarToast("Colhedora atualizada com sucesso", "success");
                            } else {
                                // Verificar se ID já existe
                                const existente = DB.colhedoras.get(id);
                                if (existente) {
                                    mostrarToast("Já existe uma colhedora com este ID", "error");
                                    return;
                                }
                                
                                // Adicionar nova colhedora
                                DB.colhedoras.add(colhedora);
                                mostrarToast("Colhedora adicionada com sucesso", "success");
                            }
                            
                            // Atualizar lista e limpar formulário
                            atualizarListaColhedoras();
                            this.reset();
                            document.getElementById('colhedora-id').disabled = false;
                        } catch (e) {
                            console.error("Erro ao salvar colhedora:", e);
                            mostrarToast("Erro ao salvar colhedora", "error");
                        }
                    });
                    
                    // Função para atualizar a lista de colhedoras cadastradas
                    atualizarListaColhedoras();
                    
                    // Evento para o botão nova colhedora
                    document.getElementById('btn-add-colhedora').addEventListener('click', function() {
                        document.getElementById('colhedora-id').disabled = false;
                        document.getElementById('form-colhedora').reset();
                    });
                }
                
                // Atualizar a lista de colhedoras cadastradas
                function atualizarListaColhedoras() {
                    try {
                        // Obter todas as colhedoras
                        estado.colhedoras = DB.colhedoras.getAll();
                        
                        // Obter elemento da tabela
                        const tabela = document.getElementById('tabela-colhedoras-lista');
                        if (!tabela) return;
                        
                        // Gerar conteúdo da tabela
                        let html = '';
                        
                        if (estado.colhedoras.length === 0) {
                            html = `
                                <tr>
                                    <td colspan="4" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                        Nenhuma colhedora cadastrada
                                    </td>
                                </tr>
                            `;
                        } else {
                            estado.colhedoras.forEach(colhedora => {
                                html += `
                                    <tr>
                                        <td class="px-4 py-3">
                                            <div class="text-sm font-medium text-gray-900 dark:text-white">${colhedora.id}</div>
                                            <div class="text-sm text-gray-500 dark:text-gray-400">${colhedora.modelo}</div>
                                        </td>
                                        <td class="px-4 py-3">
                                            <div class="text-sm text-gray-900 dark:text-white">${colhedora.marca || '-'}</div>
                                        </td>
                                        <td class="px-4 py-3">
                                            <div class="text-sm text-gray-900 dark:text-white">${colhedora.ano || '-'}</div>
                                        </td>
                                        <td class="px-4 py-3 text-center">
                                            <button class="text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 edit-colhedora mr-2" data-id="${colhedora.id}">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 delete-colhedora" data-id="${colhedora.id}">
                                                <i class="fas fa-trash-alt"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `;
                            });
                        }
                        
                        tabela.innerHTML = html;
                        
                        // Adicionar listeners para botões de editar e excluir
                        document.querySelectorAll('.edit-colhedora').forEach(button => {
                            button.addEventListener('click', function() {
                                const id = this.getAttribute('data-id');
                                editarColhedora(id);
                            });
                        });
                        
                        document.querySelectorAll('.delete-colhedora').forEach(button => {
                            button.addEventListener('click', function() {
                                const id = this.getAttribute('data-id');
                                if (confirm('Tem certeza que deseja excluir esta colhedora?')) {
                                    excluirColhedora(id);
                                }
                            });
                        });
                        
                        // Atualizar também o dropdown de colhedoras no formulário de produção
                        atualizarDropdownColhedoras();
                    } catch (e) {
                        console.error("Erro ao atualizar lista de colhedoras:", e);
                        mostrarToast("Erro ao carregar colhedoras", "error");
                    }
                }
                
                // Função para editar colhedora
                function editarColhedora(id) {
                    try {
                        const colhedora = DB.colhedoras.get(id);
                        if (!colhedora) {
                            mostrarToast("Colhedora não encontrada", "error");
                            return;
                        }
                        
                        // Preencher formulário com dados da colhedora
                        document.getElementById('colhedora-id').value = colhedora.id;
                        document.getElementById('colhedora-modelo').value = colhedora.modelo;
                        document.getElementById('colhedora-marca').value = colhedora.marca || '';
                        document.getElementById('colhedora-ano').value = colhedora.ano || '';
                        document.getElementById('colhedora-observacoes').value = colhedora.observacoes || '';
                        
                        // Desabilitar campo de ID no modo de edição
                        document.getElementById('colhedora-id').disabled = true;
                        
                        // Rolar para o formulário
                        document.getElementById('form-colhedora').scrollIntoView({ behavior: 'smooth' });
                    } catch (e) {
                        console.error("Erro ao editar colhedora:", e);
                        mostrarToast("Erro ao editar colhedora", "error");
                    }
                }
                
                // Função para excluir colhedora
                function excluirColhedora(id) {
                    try {
                        DB.colhedoras.remove(id);
                        mostrarToast("Colhedora excluída com sucesso", "success");
                        atualizarListaColhedoras();
                    } catch (e) {
                        console.error("Erro ao excluir colhedora:", e);
                        mostrarToast("Erro ao excluir colhedora", "error");
                    }
                }
                
                // Atualizar dropdown de colhedoras em formulários
                function atualizarDropdownColhedoras() {
                    try {
                        const dropdowns = [
                            document.getElementById('registro-colhedora'),
                            document.getElementById('filtro-colhedora')
                        ];
                        
                        dropdowns.forEach(dropdown => {
                            if (!dropdown) return;
                            
                            // Salvar seleção atual
                            const currentValue = dropdown.value;
                            
                            // Limpar opções exceto a primeira (se for um placeholder)
                            const placeholder = dropdown.querySelector('option[value=""]');
                            dropdown.innerHTML = '';
                            
                            if (placeholder) {
                                dropdown.appendChild(placeholder.cloneNode(true));
                            }
                            
                            // Adicionar opções para cada colhedora
                            estado.colhedoras.forEach(colhedora => {
                                const option = document.createElement('option');
                                option.value = colhedora.id;
                                option.textContent = `${colhedora.id} - ${colhedora.modelo}`;
                                dropdown.appendChild(option);
                            });
                            
                            // Restaurar seleção se ainda existir
                            if (currentValue) {
                                dropdown.value = currentValue;
                            }
                        });
                    } catch (e) {
                        console.error("Erro ao atualizar dropdowns de colhedoras:", e);
                    }
                }
                
                // Inicializar módulo de registros de produção
                function initProducao() {
                    // Adicionar culturas à lista de datalist
                    const listaCulturas = document.getElementById('lista-culturas');
                    if (listaCulturas) {
                        // Limpar lista
                        listaCulturas.innerHTML = '';
                        
                        // Adicionar opções de culturas
                        estado.culturas.forEach(cultura => {
                            const option = document.createElement('option');
                            option.value = cultura;
                            listaCulturas.appendChild(option);
                        });
                    }
                    
                    // Formulário de registro de produção
                    document.getElementById('form-registro').addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const data = document.getElementById('registro-data').value;
                        const colhedoraId = document.getElementById('registro-colhedora').value;
                        const cultura = document.getElementById('registro-cultura').value;
                        const quantidade = document.getElementById('registro-quantidade').value;
                        const area = document.getElementById('registro-area').value;
                        const horas = document.getElementById('registro-horas').value;
                        const combustivel = document.getElementById('registro-combustivel').value;
                        const observacoes = document.getElementById('registro-observacoes').value;
                        
                        if (!data || !colhedoraId || !cultura || !quantidade || !area) {
                            mostrarToast("Preencha todos os campos obrigatórios", "warning");
                            return;
                        }
                        
                        try {
                            const registro = {
                                data,
                                colhedoraId,
                                cultura,
                                quantidade: Number(quantidade),
                                area: Number(area),
                                horas: Number(horas) || 0,
                                combustivel: Number(combustivel) || 0,
                                observacoes
                            };
                            
                            // Adicionar novo registro
                            DB.registros.add(registro);
                            
                            // Se a cultura não existe na lista, adicionar
                            if (!estado.culturas.includes(cultura)) {
                                estado.culturas.push(cultura);
                                
                                // Atualizar datalist
                                const option = document.createElement('option');
                                option.value = cultura;
                                document.getElementById('lista-culturas').appendChild(option);
                            }
                            
                            mostrarToast("Registro adicionado com sucesso", "success");
                            
                            // Limpar formulário
                            this.reset();
                            
                            // Definir data para o dia atual
                            document.getElementById('registro-data').valueAsDate = new Date();
                            
                            // Atualizar resumo
                            atualizarResumoProducao();
                        } catch (e) {
                            console.error("Erro ao salvar registro:", e);
                            mostrarToast("Erro ao salvar registro", "error");
                        }
                    });
                    
                    // Definir data para o dia atual
                    document.getElementById('registro-data').valueAsDate = new Date();
                    
                    // Atualizar resumo
                    atualizarProducao();
                }
                
                // Atualizar módulo de produção
                function atualizarProducao() {
                    // Atualizar dropdown de colhedoras
                    atualizarDropdownColhedoras();
                    
                    // Atualizar resumo
                    atualizarResumoProducao();
                }
                
                // Atualizar resumo de produção
                function atualizarResumoProducao() {
                    try {
                        // Obter todos os registros
                        const registros = DB.registros.getAll();
                        
                        // Calcular totais
                        let totalColhido = 0;
                        let areaTotal = 0;
                        let horasTotal = 0;
                        
                        registros.forEach(registro => {
                            totalColhido += Number(registro.quantidade) || 0;
                            areaTotal += Number(registro.area) || 0;
                            horasTotal += Number(registro.horas) || 0;
                        });
                        
                        // Calcular médias
                        const produtividadeMedia = areaTotal > 0 ? totalColhido / areaTotal : 0;
                        const rendimentoMedio = horasTotal > 0 ? totalColhido / horasTotal : 0;
                        
                        // Atualizar elementos
                        document.getElementById('total-colhido').textContent = `${Utils.formatNumber(totalColhido)} T`;
                        document.getElementById('area-total').textContent = `${Utils.formatNumber(areaTotal)} ha`;
                        document.getElementById('produtividade-media').textContent = `${Utils.formatNumber(produtividadeMedia)} T/ha`;
                        document.getElementById('rendimento-medio').textContent = `${Utils.formatNumber(rendimentoMedio)} T/h`;
                        
                        // Paradas por chuva
                        const totalDiasChuva = DB.chuvas.getTotalDias();
                        document.getElementById('paradas-chuva-total').textContent = `${totalDiasChuva} dias`;
                        
                        // Atualizar tabela de estatísticas por colhedora
                        atualizarTabelaColhedoras();
                    } catch (e) {
                        console.error("Erro ao atualizar resumo de produção:", e);
                    }
                }
                
                // Atualizar tabela de estatísticas por colhedora
                function atualizarTabelaColhedoras() {
                    try {
                        const tabela = document.getElementById('tabela-colhedoras');
                        if (!tabela) return;
                        
                        // Obter estatísticas por colhedora
                        const colhedoraStats = DB.registros.getStatsByCategory('colhedoraId');
                        
                        // Ordenar por volume
                        const sortedColhedoras = [...colhedoraStats].sort((a, b) => b.quantidade - a.quantidade);
                        
                        // Gerar conteúdo da tabela
                        let html = '';
                        
                        if (sortedColhedoras.length === 0) {
                            html = `
                                <tr>
                                    <td colspan="4" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                        Nenhum registro encontrado
                                    </td>
                                </tr>
                            `;
                        } else {
                            sortedColhedoras.forEach(colhedora => {
                                html += `
                                    <tr>
                                        <td class="px-4 py-3 text-sm text-gray-900 dark:text-white">${colhedora.name}</td>
                                        <td class="px-4 py-3 text-right text-sm text-gray-900 dark:text-white">${Utils.formatNumber(colhedora.quantidade)} T</td>
                                        <td class="px-4 py-3 text-right text-sm text-gray-900 dark:text-white">${Utils.formatNumber(colhedora.area)} ha</td>
                                        <td class="px-4 py-3 text-right text-sm text-gray-900 dark:text-white">${Utils.formatNumber(colhedora.produtividade)} T/ha</td>
                                    </tr>
                                `;
                            });
                        }
                        
                        tabela.innerHTML = html;
                    } catch (e) {
                        console.error("Erro ao atualizar tabela de colhedoras:", e);
                    }
                }
                
                // Inicializar módulo de registros de chuva
                function initChuvas() {
                    // Definir data para o dia atual
                    document.getElementById('chuva-data-inicio').valueAsDate = new Date();
                    document.getElementById('chuva-data-fim').valueAsDate = new Date();
                    
                    // Formulário de registro de chuva
                    document.getElementById('form-chuva').addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const dataInicio = document.getElementById('chuva-data-inicio').value;
                        const dataFim = document.getElementById('chuva-data-fim').value;
                        const dias = document.getElementById('chuva-dias').value;
                        const intensidade = document.getElementById('chuva-intensidade').value;
                        const observacoes = document.getElementById('chuva-observacoes').value;
                        
                        if (!dataInicio || !dataFim || !dias) {
                            mostrarToast("Preencha todos os campos obrigatórios", "warning");
                            return;
                        }
                        
                        // Verificar se data de início é menor ou igual à data de fim
                        if (new Date(dataInicio) > new Date(dataFim)) {
                            mostrarToast("A data de início deve ser menor ou igual à data de fim", "error");
                            return;
                        }
                        
                        try {
                            const chuva = {
                                dataInicio,
                                dataFim,
                                dias: Number(dias),
                                intensidade,
                                observacoes
                            };
                            
                            // Adicionar novo registro
                            DB.chuvas.add(chuva);
                            
                            mostrarToast("Registro de chuva adicionado com sucesso", "success");
                            
                            // Limpar formulário
                            this.reset();
                            
                            // Definir data para o dia atual
                            document.getElementById('chuva-data-inicio').valueAsDate = new Date();
                            document.getElementById('chuva-data-fim').valueAsDate = new Date();
                            
                            // Atualizar resumo e tabela
                            atualizarChuvas();
                        } catch (e) {
                            console.error("Erro ao salvar registro de chuva:", e);
                            mostrarToast("Erro ao salvar registro de chuva", "error");
                        }
                    });
                    
                    // Atualizar módulo de chuvas
                    atualizarChuvas();
                }
                
                // Atualizar módulo de chuvas
                function atualizarChuvas() {
                    try {
                        // Obter todos os registros de chuva
                        estado.chuvas = DB.chuvas.getAll();
                        
                        // Atualizar resumo
                        atualizarResumoChuvas();
                        
                        // Atualizar tabela
                        atualizarTabelaChuvas();
                        
                        // Atualizar gráfico mensal
                        renderizarGraficoChuvasMensal();
                    } catch (e) {
                        console.error("Erro ao atualizar módulo de chuvas:", e);
                    }
                }
                
                // Atualizar resumo de chuvas
                function atualizarResumoChuvas() {
                    try {
                        // Total de registros
                        document.getElementById('chuva-total-registros').textContent = `${estado.chuvas.length} registros`;
                        
                        // Total de dias parados
                        const totalDiasChuva = DB.chuvas.getTotalDias();
                        document.getElementById('chuva-total-dias').textContent = `${totalDiasChuva} dias`;
                        
                        // Última parada
                        const ultimaChuva = DB.chuvas.getLastChuva();
                        if (ultimaChuva) {
                            const dataInicio = Utils.formatDate(ultimaChuva.dataInicio);
                            const dataFim = Utils.formatDate(ultimaChuva.dataFim);
                            document.getElementById('chuva-ultima-parada').textContent = `${dataInicio} a ${dataFim}`;
                        } else {
                            document.getElementById('chuva-ultima-parada').textContent = '-';
                        }
                        
                        // Impacto estimado
                        const impactoEstimado = DB.chuvas.calcularImpactoEstimado();
                        document.getElementById('chuva-impacto-estimado').textContent = `${Utils.formatNumber(impactoEstimado)} T`;
                    } catch (e) {
                        console.error("Erro ao atualizar resumo de chuvas:", e);
                    }
                }
                
                // Atualizar tabela de chuvas
                function atualizarTabelaChuvas() {
                    try {
                        const tabela = document.getElementById('tabela-chuvas');
                        if (!tabela) return;
                        
                        // Ordenar registros por data (mais recente primeiro)
                        const sortedChuvas = [...estado.chuvas].sort((a, b) => new Date(b.dataInicio) - new Date(a.dataInicio));
                        
                        // Gerar conteúdo da tabela
                        let html = '';
                        
                        if (sortedChuvas.length === 0) {
                            html = `
                                <tr>
                                    <td colspan="5" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                        Nenhum registro de chuva encontrado
                                    </td>
                                </tr>
                            `;
                        } else {
                            sortedChuvas.forEach(chuva => {
                                const dataInicio = Utils.formatDate(chuva.dataInicio);
                                const dataFim = Utils.formatDate(chuva.dataFim);
                                
                                // Classe de intensidade
                                let intensidadeClass = '';
                                if (chuva.intensidade === 'baixa') {
                                    intensidadeClass = 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300';
                                } else if (chuva.intensidade === 'media') {
                                    intensidadeClass = 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';
                                } else {
                                    intensidadeClass = 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';
                                }
                                
                                html += `
                                    <tr>
                                        <td class="px-4 py-3">
                                            <div class="text-sm text-gray-900 dark:text-white">${dataInicio} a ${dataFim}</div>
                                        </td>
                                        <td class="px-4 py-3 text-center">
                                            <span class="text-sm text-gray-900 dark:text-white">${chuva.dias}</span>
                                        </td>
                                        <td class="px-4 py-3 text-center">
                                            <span class="px-2 py-1 rounded-full text-xs font-medium ${intensidadeClass}">
                                                ${chuva.intensidade.charAt(0).toUpperCase() + chuva.intensidade.slice(1)}
                                            </span>
                                        </td>
                                        <td class="px-4 py-3">
                                            <div class="text-sm text-gray-500 dark:text-gray-400">${chuva.observacoes || '-'}</div>
                                        </td>
                                        <td class="px-4 py-3 text-center">
                                            <button class="text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 delete-chuva" data-id="${chuva.id}">
                                                <i class="fas fa-trash-alt"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `;
                            });
                        }
                        
                        tabela.innerHTML = html;
                        
                        // Adicionar evento para botões de exclusão
                        document.querySelectorAll('.delete-chuva').forEach(button => {
                            button.addEventListener('click', function() {
                                const id = this.getAttribute('data-id');
                                if (confirm('Tem certeza que deseja excluir este registro de chuva?')) {
                                    try {
                                        DB.chuvas.remove(id);
                                        mostrarToast("Registro de chuva excluído com sucesso", "success");
                                        atualizarChuvas();
                                    } catch (e) {
                                        console.error("Erro ao excluir registro de chuva:", e);
                                        mostrarToast("Erro ao excluir registro de chuva", "error");
                                    }
                                }
                            });
                        });
                    } catch (e) {
                        console.error("Erro ao atualizar tabela de chuvas:", e);
                    }
                }
                
                // Renderizar gráfico mensal de chuvas
                function renderizarGraficoChuvasMensal() {
                    const chartElement = document.getElementById('chart-chuva-mensal');
                    if (!chartElement) return;
                    
                    // Obter dados mensais
                    const data = DB.chuvas.getMonthlyChuvaData();
                    
                    // Preparar dados para o gráfico
                    const labels = data.map(d => d.monthName);
                    const valuesDias = data.map(d => d.totalDias);
                    
                    // Verificar se já existe um gráfico
                    if (chartElement.chart) {
                        chartElement.chart.destroy();
                    }
                    
                    // Criar novo gráfico
                    chartElement.chart = new Chart(chartElement, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Dias Parados',
                                data: valuesDias,
                                backgroundColor: 'rgba(59, 130, 246, 0.7)',
                                borderColor: 'rgba(59, 130, 246, 1)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const value = context.raw;
                                            return `${value} dias parados`;
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    grid: {
                                        display: false
                                    }
                                },
                                y: {
                                    beginAtZero: true,
                                    grid: {
                                        borderDash: [2, 2]
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Inicializar módulo de histórico de registros
                function initRegistros() {
                    // Filtros
                    document.getElementById('btn-aplicar-filtros').addEventListener('click', function() {
                        // Capturar filtros
                        estado.filtros.colhedora = document.getElementById('filtro-colhedora').value;
                        estado.filtros.cultura = document.getElementById('filtro-cultura').value;
                        estado.filtros.dataInicio = document.getElementById('filtro-data-inicio').value;
                        estado.filtros.dataFim = document.getElementById('filtro-data-fim').value;
                        
                        // Resetar paginação
                        estado.paginacao.paginaAtual = 1;
                        
                        // Atualizar registros
                        atualizarRegistros();
                    });
                    
                    // Limpar filtros
                    document.getElementById('btn-limpar-filtros').addEventListener('click', function() {
                        document.getElementById('filtro-colhedora').value = '';
                        document.getElementById('filtro-cultura').value = '';
                        document.getElementById('filtro-data-inicio').value = '';
                        document.getElementById('filtro-data-fim').value = '';
                        
                        // Resetar estado de filtros
                        estado.filtros = {
                            colhedora: '',
                            cultura: '',
                            dataInicio: '',
                            dataFim: ''
                        };
                        
                        // Resetar paginação
                        estado.paginacao.paginaAtual = 1;
                        
                        // Atualizar registros
                        atualizarRegistros();
                    });
                    
                    // Paginação
                    document.getElementById('btn-pagina-anterior').addEventListener('click', function() {
                        if (estado.paginacao.paginaAtual > 1) {
                            estado.paginacao.paginaAtual--;
                            atualizarRegistros();
                        }
                    });
                    
                    document.getElementById('btn-proxima-pagina').addEventListener('click', function() {
                        if (estado.paginacao.paginaAtual < estado.paginacao.totalPaginas) {
                            estado.paginacao.paginaAtual++;
                            atualizarRegistros();
                        }
                    });
                    
                    // Inicializar dropdown de colhedoras para filtro
                    atualizarDropdownColhedoras();
                    
                    // Inicializar dropdown de culturas para filtro
                    const dropdownCultura = document.getElementById('filtro-cultura');
                    if (dropdownCultura) {
                        // Salvar seleção atual
                        const currentValue = dropdownCultura.value;
                        
                        // Limpar opções exceto a primeira (placeholder)
                        const placeholder = dropdownCultura.querySelector('option[value=""]');
                        dropdownCultura.innerHTML = '';
                        
                        if (placeholder) {
                            dropdownCultura.appendChild(placeholder.cloneNode(true));
                        }
                        
                        // Adicionar opções para cada cultura
                        estado.culturas.forEach(cultura => {
                            const option = document.createElement('option');
                            option.value = cultura;
                            option.textContent = cultura;
                            dropdownCultura.appendChild(option);
                        });
                        
                        // Restaurar seleção se ainda existir
                        if (currentValue) {
                            dropdownCultura.value = currentValue;
                        }
                    }
                    
                    // Carregar registros
                    atualizarRegistros();
                }
                
                // Atualizar lista de registros com paginação e filtros
                function atualizarRegistros() {
                    try {
                        // Registros por página conforme configuração
                        estado.paginacao.registrosPorPagina = estado.config.registrosPorPagina || 10;
                        
                        // Obter todos os registros
                        let registros = DB.registros.getAll();
                        
                        // Aplicar filtros
                        if (estado.filtros.colhedora) {
                            registros = registros.filter(r => r.colhedoraId === estado.filtros.colhedora);
                        }
                        
                        if (estado.filtros.cultura) {
                            registros = registros.filter(r => r.cultura === estado.filtros.cultura);
                        }
                        
                        if (estado.filtros.dataInicio) {
                            registros = registros.filter(r => r.data >= estado.filtros.dataInicio);
                        }
                        
                        if (estado.filtros.dataFim) {
                            registros = registros.filter(r => r.data <= estado.filtros.dataFim);
                        }
                        
                        // Ordenar por data (mais recente primeiro)
                        registros.sort((a, b) => new Date(b.data) - new Date(a.data));
                        
                        // Atualizar contagem de registros
                        document.getElementById('registros-contagem').textContent = registros.length;
                        
                        // Calcular total de páginas
                        estado.paginacao.totalPaginas = Math.ceil(registros.length / estado.paginacao.registrosPorPagina);
                        
                        // Verificar se a página atual é válida
                        if (estado.paginacao.paginaAtual > estado.paginacao.totalPaginas && estado.paginacao.totalPaginas > 0) {
                            estado.paginacao.paginaAtual = estado.paginacao.totalPaginas;
                        } else if (estado.paginacao.paginaAtual < 1) {
                            estado.paginacao.paginaAtual = 1;
                        }
                        
                        // Atualizar informações de paginação
                        document.getElementById('paginacao-info').textContent = `Página ${estado.paginacao.paginaAtual} de ${estado.paginacao.totalPaginas || 1}`;
                        
                        // Habilitar/desabilitar botões de paginação
                        document.getElementById('btn-pagina-anterior').disabled = estado.paginacao.paginaAtual <= 1;
                        document.getElementById('btn-proxima-pagina').disabled = estado.paginacao.paginaAtual >= estado.paginacao.totalPaginas;
                        
                        // Calcular índices para a página atual
                        const inicio = (estado.paginacao.paginaAtual - 1) * estado.paginacao.registrosPorPagina;
                        const fim = Math.min(inicio + estado.paginacao.registrosPorPagina, registros.length);
                        
                        // Obter os registros da página atual
                        const registrosPagina = registros.slice(inicio, fim);
                        
                        // Atualizar tabela
                        const tabela = document.getElementById('tabela-registros');
                        if (tabela) {
                            // Gerar conteúdo da tabela
                            let html = '';
                            
                            if (registrosPagina.length === 0) {
                                html = `
                                    <tr>
                                        <td colspan="9" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                            Nenhum registro encontrado
                                        </td>
                                    </tr>
                                `;
                            } else {
                                registrosPagina.forEach(registro => {
                                    // Calcular produtividade e rendimento
                                    const produtividade = Utils.calcProdutividade(registro.quantidade, registro.area);
                                    const rendimento = Utils.calcRendimento(registro.quantidade, registro.horas);
                                    
                                    html += `
                                        <tr>
                                            <td class="px-4 py-3">
                                                <div class="text-sm text-gray-900 dark:text-white">${Utils.formatDate(registro.data)}</div>
                                            </td>
                                            <td class="px-4 py-3">
                                                <div class="text-sm text-gray-900 dark:text-white">${registro.colhedoraId}</div>
                                            </td>
                                            <td class="px-4 py-3">
                                                <div class="text-sm text-gray-900 dark:text-white">${registro.cultura}</div>
                                            </td>
                                            <td class="px-4 py-3 text-right">
                                                <div class="text-sm text-gray-900 dark:text-white">${Utils.formatNumber(registro.quantidade)}</div>
                                            </td>
                                            <td class="px-4 py-3 text-right">
                                                <div class="text-sm text-gray-900 dark:text-white">${Utils.formatNumber(registro.area)}</div>
                                            </td>
                                            <td class="px-4 py-3 text-right">
                                                <div class="text-sm text-gray-900 dark:text-white">${registro.horas ? Utils.formatNumber(registro.horas) : '-'}</div>
                                            </td>
                                            <td class="px-4 py-3 text-right">
                                                <div class="text-sm text-gray-900 dark:text-white">${Utils.formatNumber(produtividade)}</div>
                                            </td>
                                            <td class="px-4 py-3 text-right">
                                                <div class="text-sm text-gray-900 dark:text-white">${rendimento > 0 ? Utils.formatNumber(rendimento) : '-'}</div>
                                            </td>
                                            <td class="px-4 py-3 text-center">
                                                <button class="text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 delete-registro" data-id="${registro.id}">
                                                    <i class="fas fa-trash-alt"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    `;
                                });
                            }
                            
                            tabela.innerHTML = html;
                            
                            // Adicionar eventos para botões de exclusão
                            document.querySelectorAll('.delete-registro').forEach(button => {
                                button.addEventListener('click', function() {
                                    const id = this.getAttribute('data-id');
                                    if (confirm('Tem certeza que deseja excluir este registro?')) {
                                        try {
                                            DB.registros.remove(id);
                                            mostrarToast("Registro excluído com sucesso", "success");
                                            atualizarRegistros();
                                        } catch (e) {
                                            console.error("Erro ao excluir registro:", e);
                                            mostrarToast("Erro ao excluir registro", "error");
                                        }
                                    }
                                });
                            });
                        }
                    } catch (e) {
                        console.error("Erro ao atualizar registros:", e);
                        mostrarToast("Erro ao carregar registros", "error");
                    }
                }
                
                // Inicializar módulo de caminhões
                function initCaminhoes() {
                    // Definir data para o dia atual
                    document.getElementById('caminhao-data').valueAsDate = new Date();
                    
                    // Formulário de registro de caminhão
                    document.getElementById('form-caminhao').addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const data = document.getElementById('caminhao-data').value;
                        const idCaminhao = document.getElementById('caminhao-id').value;
                        const tempoCampo = document.getElementById('caminhao-tempo-campo').value;
                        const tempoPatio = document.getElementById('caminhao-tempo-patio').value;
                        const observacoes = document.getElementById('caminhao-observacoes').value;
                        
                        if (!data || !idCaminhao || !tempoCampo || !tempoPatio) {
                            mostrarToast("Preencha todos os campos obrigatórios", "warning");
                            return;
                        }
                        
                        try {
                            const caminhao = {
                                data,
                                idCaminhao,
                                tempoCampo: Number(tempoCampo),
                                tempoPatio: Number(tempoPatio),
                                observacoes
                            };
                            
                            // Adicionar novo registro
                            DB.caminhoes.add(caminhao);
                            
                            mostrarToast("Registro de caminhão adicionado com sucesso", "success");
                            
                            // Limpar formulário
                            this.reset();
                            
                            // Definir data para o dia atual
                            document.getElementById('caminhao-data').valueAsDate = new Date();
                            
                            // Atualizar caminhões
                            atualizarCaminhoes();
                        } catch (e) {
                            console.error("Erro ao salvar registro de caminhão:", e);
                            mostrarToast("Erro ao salvar registro de caminhão", "error");
                        }
                    });
                    
                    // Filtro por data
                    document.getElementById('btn-filtrar-caminhoes').addEventListener('click', function() {
                        atualizarCaminhoes();
                    });
                    
                    // Inicializar módulo de caminhões
                    atualizarCaminhoes();
                }
                
                // Atualizar módulo de caminhões
                function atualizarCaminhoes() {
                    try {
                        // Obter data do filtro
                        const dataFiltro = document.getElementById('data-filtro-caminhoes').value;
                        
                        // Obter registros de caminhões
                        let caminhoes = DB.caminhoes.getAll();
                        
                        // Aplicar filtro de data se fornecido
                        if (dataFiltro) {
                            caminhoes = caminhoes.filter(c => c.data === dataFiltro);
                        }
                        
                        // Ordenar por data (mais recente primeiro)
                        caminhoes.sort((a, b) => new Date(b.data) - new Date(a.data));
                        
                        // Atualizar estatísticas
                        atualizarEstatisticasCaminhoes(caminhoes);
                        
                        // Atualizar tabela de histórico
                        atualizarTabelaHistoricoCaminhoes(caminhoes);
                    } catch (e) {
                        console.error("Erro ao atualizar módulo de caminhões:", e);
                    }
                }
                
                // Atualizar estatísticas de caminhões
                function atualizarEstatisticasCaminhoes(caminhoes) {
                    try {
                        // Calcular médias
                        let totalCampo = 0;
                        let totalPatio = 0;
                        
                        caminhoes.forEach(c => {
                            totalCampo += Number(c.tempoCampo) || 0;
                            totalPatio += Number(c.tempoPatio) || 0;
                        });
                        
                        const mediaCampo = caminhoes.length > 0 ? totalCampo / caminhoes.length : 0;
                        const mediaPatio = caminhoes.length > 0 ? totalPatio / caminhoes.length : 0;
                        const tempoTotalMedio = mediaCampo + mediaPatio;
                        
                        // Atualizar elementos
                        document.getElementById('media-campo').textContent = `${Utils.formatNumber(mediaCampo)} min`;
                        document.getElementById('media-patio').textContent = `${Utils.formatNumber(mediaPatio)} min`;
                        document.getElementById('total-registros-caminhoes').textContent = caminhoes.length;
                        document.getElementById('tempo-total-medio').textContent = `${Utils.formatNumber(tempoTotalMedio)} min`;
                        
                        // Atualizar tabela de médias por caminhão
                        atualizarTabelaMediasCaminhoes(caminhoes);
                    } catch (e) {
                        console.error("Erro ao atualizar estatísticas de caminhões:", e);
                    }
                }
                
                // Atualizar tabela de médias por caminhão
                function atualizarTabelaMediasCaminhoes(caminhoes) {
                    try {
                        const tabela = document.getElementById('tabela-medias-caminhoes');
                        if (!tabela) return;
                        
                        // Agrupar por caminhão
                        const caminhaoMap = new Map();
                        
                        caminhoes.forEach(c => {
                            const id = c.idCaminhao;
                            
                            if (!caminhaoMap.has(id)) {
                                caminhaoMap.set(id, {
                                    id,
                                    totalCampo: 0,
                                    totalPatio: 0,
                                    count: 0
                                });
                            }
                            
                            const stats = caminhaoMap.get(id);
                            stats.totalCampo += Number(c.tempoCampo) || 0;
                            stats.totalPatio += Number(c.tempoPatio) || 0;
                            stats.count += 1;
                        });
                        
                        // Calcular médias
                        caminhaoMap.forEach(stats => {
                            stats.mediaCampo = stats.count > 0 ? stats.totalCampo / stats.count : 0;
                            stats.mediaPatio = stats.count > 0 ? stats.totalPatio / stats.count : 0;
                            stats.mediaTotal = stats.mediaCampo + stats.mediaPatio;
                        });
                        
                        // Ordenar por ID
                        const sortedCaminhoes = Array.from(caminhaoMap.values()).sort((a, b) => a.id.localeCompare(b.id));
                        
                        // Gerar conteúdo da tabela
                        let html = '';
                        
                        if (sortedCaminhoes.length === 0) {
                            html = `
                                <tr>
                                    <td colspan="4" class="px-4 py-2 text-center text-gray-500 dark:text-gray-400">
                                        Nenhum registro encontrado
                                    </td>
                                </tr>
                            `;
                        } else {
                            sortedCaminhoes.forEach(c => {
                                html += `
                                    <tr>
                                        <td class="px-4 py-2 text-sm text-gray-900 dark:text-white">${c.id}</td>
                                        <td class="px-4 py-2 text-right text-sm text-gray-900 dark:text-white">${Utils.formatNumber(c.mediaCampo)}</td>
                                        <td class="px-4 py-2 text-right text-sm text-gray-900 dark:text-white">${Utils.formatNumber(c.mediaPatio)}</td>
                                        <td class="px-4 py-2 text-right text-sm font-medium text-primary-600 dark:text-primary-400">${Utils.formatNumber(c.mediaTotal)}</td>
                                    </tr>
                                `;
                            });
                        }
                        
                        tabela.innerHTML = html;
                    } catch (e) {
                        console.error("Erro ao atualizar tabela de médias por caminhão:", e);
                    }
                }
                
                // Atualizar tabela de histórico de caminhões
                function atualizarTabelaHistoricoCaminhoes(caminhoes) {
                    try {
                        const tabela = document.getElementById('tabela-historico-caminhoes');
                        if (!tabela) return;
                        
                        // Gerar conteúdo da tabela
                        let html = '';
                        
                        if (caminhoes.length === 0) {
                            html = `
                                <tr>
                                    <td colspan="6" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                        Nenhum registro encontrado
                                    </td>
                                </tr>
                            `;
                        } else {
                            caminhoes.forEach(c => {
                                const tempoTotal = Number(c.tempoCampo) + Number(c.tempoPatio);
                                
                                html += `
                                    <tr>
                                        <td class="px-4 py-3">
                                            <div class="text-sm text-gray-900 dark:text-white">${Utils.formatDate(c.data)}</div>
                                        </td>
                                        <td class="px-4 py-3">
                                            <div class="text-sm text-gray-900 dark:text-white">${c.idCaminhao}</div>
                                        </td>
                                        <td class="px-4 py-3 text-right">
                                            <div class="text-sm text-gray-900 dark:text-white">${c.tempoCampo}</div>
                                        </td>
                                        <td class="px-4 py-3 text-right">
                                            <div class="text-sm text-gray-900 dark:text-white">${c.tempoPatio}</div>
                                        </td>
                                        <td class="px-4 py-3 text-right">
                                            <div class="text-sm font-medium text-primary-600 dark:text-primary-400">${tempoTotal}</div>
                                        </td>
                                        <td class="px-4 py-3 text-center">
                                            <button class="text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 delete-caminhao" data-id="${c.id}">
                                                <i class="fas fa-trash-alt"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `;
                            });
                        }
                        
                        tabela.innerHTML = html;
                        
                        // Adicionar eventos para botões de exclusão
                        document.querySelectorAll('.delete-caminhao').forEach(button => {
                            button.addEventListener('click', function() {
                                const id = this.getAttribute('data-id');
                                if (confirm('Tem certeza que deseja excluir este registro?')) {
                                    try {
                                        DB.caminhoes.remove(id);
                                        mostrarToast("Registro excluído com sucesso", "success");
                                        atualizarCaminhoes();
                                    } catch (e) {
                                        console.error("Erro ao excluir registro de caminhão:", e);
                                        mostrarToast("Erro ao excluir registro", "error");
                                    }
                                }
                            });
                        });
                    } catch (e) {
                        console.error("Erro ao atualizar tabela de histórico de caminhões:", e);
                    }
                }
                
                // Inicializar módulo de configurações
                function initConfig() {
                    // Carregar configurações atuais
                    const config = DB.config.get();
                    
                    // Tema escuro
                    document.getElementById('config-tema-escuro').checked = config.temaEscuro;
                    
                    // Registros por página
                    document.getElementById('config-registros-pagina').value = config.registrosPorPagina || 10;
                    
                    // Formato de data
                    document.getElementById('config-formato-data').value = config.formatoData || 'dd/MM/yyyy';
                    
                    // Formulário de configurações gerais
                    document.getElementById('form-config-geral').addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const temaEscuro = document.getElementById('config-tema-escuro').checked;
                        const registrosPorPagina = document.getElementById('config-registros-pagina').value;
                        const formatoData = document.getElementById('config-formato-data').value;
                        
                        try {
                            // Atualizar configurações
                            const novoConfig = {
                                ...config,
                                temaEscuro,
                                registrosPorPagina: Number(registrosPorPagina),
                                formatoData
                            };
                            
                            // Salvar configurações
                            DB.config.update(novoConfig);
                            
                            // Atualizar estado
                            estado.config = novoConfig;
                            
                            // Aplicar tema
                            if (temaEscuro) {
                                document.documentElement.classList.add('dark');
                            } else {
                                document.documentElement.classList.remove('dark');
                            }
                            
                            mostrarToast("Configurações salvas com sucesso", "success");
                        } catch (e) {
                            console.error("Erro ao salvar configurações:", e);
                            mostrarToast("Erro ao salvar configurações", "error");
                        }
                    });
                    
                    // Exportar JSON
                    document.getElementById('btn-exportar-json').addEventListener('click', function() {
                        try {
                            const jsonData = DB.exportData();
                            Utils.downloadFile(jsonData, 'ggomes_log_backup.json');
                            mostrarToast("Dados exportados com sucesso", "success");
                        } catch (e) {
                            console.error("Erro ao exportar dados:", e);
                            mostrarToast("Erro ao exportar dados: " + e.message, "error");
                        }
                    });
                    
                    // Exportar PDF
                    document.getElementById('btn-exportar-pdf').addEventListener('click', function() {
                        try {
                            // Criar PDF de relatório
                            const title = "Relatório de Produção - GGOMES-LOG";
                            const headers = ["Data", "Colhedora", "Cultura", "Quantidade (T)", "Área (ha)", "Prod. (T/ha)"];
                            
                            // Preparar dados para o PDF
                            const data = estado.registros.map(r => [
                                Utils.formatDate(r.data),
                                r.colhedoraId,
                                r.cultura,
                                Utils.formatNumber(r.quantidade),
                                Utils.formatNumber(r.area),
                                Utils.formatNumber(Utils.calcProdutividade(r.quantidade, r.area))
                            ]);
                            
                            // Gerar o PDF
                            Utils.generatePDF(title, headers, data);
                            mostrarToast("Relatório PDF gerado com sucesso", "success");
                        } catch (e) {
                            console.error("Erro ao gerar relatório PDF:", e);
                            mostrarToast("Erro ao gerar relatório: " + e.message, "error");
                        }
                    });
                    
                    // Selecionar arquivo para importação
                    document.getElementById('btn-selecionar-arquivo').addEventListener('click', function() {
                        document.getElementById('input-importar-json').click();
                    });
                    
                    // Evento de seleção de arquivo
                    document.getElementById('input-importar-json').addEventListener('change', function() {
                        const file = this.files[0];
                        if (file) {
                            document.getElementById('arquivo-selecionado').textContent = file.name;
                            document.getElementById('btn-importar-json').disabled = false;
                            document.getElementById('btn-importar-json').classList.remove('opacity-50', 'cursor-not-allowed');
                        } else {
                            document.getElementById('arquivo-selecionado').textContent = 'Nenhum arquivo selecionado';
                            document.getElementById('btn-importar-json').disabled = true;
                            document.getElementById('btn-importar-json').classList.add('opacity-50', 'cursor-not-allowed');
                        }
                    });
                    
                    // Importar JSON
                    document.getElementById('btn-importar-json').addEventListener('click', function() {
                        try {
                            const fileInput = document.getElementById('input-importar-json');
                            const file = fileInput.files[0];
                            
                            if (!file) {
                                mostrarToast("Selecione um arquivo para importação", "warning");
                                return;
                            }
                            
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                try {
                                    const jsonData = e.target.result;
                                    
                                    // Confirmar antes de importar
                                    if (confirm('Tem certeza que deseja importar os dados? Isso pode substituir dados existentes.')) {
                                        // Importar dados
                                        DB.importData(jsonData);
                                        
                                        // Recarregar dados
                                        carregarDados();
                                        
                                        // Atualizar todas as views
                                        atualizarDashboard();
                                        atualizarListaColhedoras();
                                        atualizarRegistros();
                                        atualizarProducao();
                                        atualizarCaminhoes();
                                        atualizarChuvas();
                                        atualizarUsuarios();
                                        
                                        mostrarToast("Dados importados com sucesso", "success");
                                        
                                        // Limpar input e label
                                        fileInput.value = '';
                                        document.getElementById('arquivo-selecionado').textContent = 'Nenhum arquivo selecionado';
                                        document.getElementById('btn-importar-json').disabled = true;
                                        document.getElementById('btn-importar-json').classList.add('opacity-50', 'cursor-not-allowed');
                                    }
                                } catch (e) {
                                    console.error("Erro ao processar arquivo JSON:", e);
                                    mostrarToast("Erro ao processar arquivo: " + e.message, "error");
                                }
                            };
                            
                            reader.onerror = function() {
                                mostrarToast("Erro ao ler o arquivo", "error");
                            };
                            
                            reader.readAsText(file);
                        } catch (e) {
                            console.error("Erro ao importar dados:", e);
                            mostrarToast("Erro ao importar dados: " + e.message, "error");
                        }
                    });
                }
                
                // Inicializar módulo de usuários
                function initUsuarios() {
                    // Carregar usuários apenas se o usuário atual for admin
                    if (!Auth.isAdmin()) return;
                    
                    // Formulário de adição de usuário
                    document.getElementById('form-usuario').addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const nome = document.getElementById('nome-usuario').value;
                        const email = document.getElementById('email-usuario').value;
                        const senha = document.getElementById('senha-usuario').value;
                        const tipo = document.querySelector('input[name="tipo-usuario"]:checked').value;
                        
                        if (!nome || !email || !senha) {
                            mostrarToast("Preencha todos os campos obrigatórios", "warning");
                            return;
                        }
                        
                        try {
                            // Verificar se já existe um usuário com este email
                            const existente = DB.users.getByEmail(email);
                            if (existente) {
                                mostrarToast("Já existe um usuário com este email", "error");
                                return;
                            }
                            
                            // Adicionar usuário
                            const user = {
                                name: nome,
                                email,
                                password: senha,
                                isAdmin: tipo === 'admin'
                            };
                            
                            DB.users.add(user);
                            mostrarToast("Usuário adicionado com sucesso", "success");
                            
                            // Limpar formulário
                            this.reset();
                            
                            // Atualizar lista de usuários
                            atualizarUsuarios();
                        } catch (e) {
                            console.error("Erro ao adicionar usuário:", e);
                            mostrarToast("Erro ao adicionar usuário", "error");
                        }
                    });
                    
                    // Atualizar lista de usuários
                    atualizarUsuarios();
                }
                
                // Modal de exclusão de usuário
                function initModalExcluirUsuario() {
                    const modal = document.getElementById('modal-excluir-usuario');
                    const btnConfirmar = document.getElementById('btn-confirmar-excluir-usuario');
                    const btnCancelar = document.getElementById('btn-cancelar-excluir-usuario');
                    
                    if (!modal || !btnConfirmar || !btnCancelar) return;
                    
                    btnCancelar.addEventListener('click', function() {
                        modal.classList.add('hidden');
                    });
                    
                    btnConfirmar.addEventListener('click', function() {
                        const userId = document.getElementById('usuario-excluir-id').value;
                        
                        try {
                            // Não permitir excluir o próprio usuário
                            if (userId === estado.user.id) {
                                mostrarToast("Não é possível excluir seu próprio usuário", "error");
                                modal.classList.add('hidden');
                                return;
                            }
                            
                            // Excluir usuário
                            DB.users.remove(userId);
                            mostrarToast("Usuário excluído com sucesso", "success");
                            
                            // Atualizar lista de usuários
                            atualizarUsuarios();
                            
                            // Fechar modal
                            modal.classList.add('hidden');
                        } catch (e) {
                            console.error("Erro ao excluir usuário:", e);
                            mostrarToast("Erro ao excluir usuário", "error");
                        }
                    });
                }
                
                // Atualizar lista de usuários
                function atualizarUsuarios() {
                    try {
                        // Se não for admin, não mostrar nada
                        if (!Auth.isAdmin()) return;
                        
                        // Obter todos os usuários
                        const usuarios = DB.users.getAll();
                        
                        // Obter elemento da tabela
                        const tabela = document.getElementById('tabela-usuarios');
                        if (!tabela) return;
                        
                        // Gerar conteúdo da tabela
                        let html = '';
                        
                        if (usuarios.length === 0) {
                            html = `
                                <tr>
                                    <td colspan="4" class="px-4 py-3 text-center text-gray-500 dark:text-gray-400">
                                        Nenhum usuário encontrado
                                    </td>
                                </tr>
                            `;
                        } else {
                            usuarios.forEach(user => {
                                html += `
                                    <tr>
                                        <td class="px-4 py-3">
                                            <div class="text-sm font-medium text-gray-900 dark:text-white">${user.name}</div>
                                        </td>
                                        <td class="px-4 py-3">
                                            <div class="text-sm text-gray-500 dark:text-gray-400">${user.email}</div>
                                        </td>
                                        <td class="px-4 py-3 text-center">
                                            <span class="px-2 py-1 text-xs font-medium rounded-full ${user.isAdmin ? 'bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-300' : 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'}">
                                                ${user.isAdmin ? 'Admin' : 'Usuário'}
                                            </span>
                                        </td>
                                        <td class="px-4 py-3 text-center">
                                            <button class="text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 delete-usuario ${user.id === estado.user.id ? 'opacity-50 cursor-not-allowed' : ''}" data-id="${user.id}" ${user.id === estado.user.id ? 'disabled' : ''}>
                                                <i class="fas fa-trash-alt"></i>
                                            </button>
                                        </td>
                                    </tr>
                                `;
                            });
                        }
                        
                        tabela.innerHTML = html;
                        
                        // Adicionar eventos para botões de exclusão
                        document.querySelectorAll('.delete-usuario:not([disabled])').forEach(button => {
                            button.addEventListener('click', function() {
                                const id = this.getAttribute('data-id');
                                
                                // Definir ID no modal
                                document.getElementById('usuario-excluir-id').value = id;
                                
                                // Mostrar modal
                                document.getElementById('modal-excluir-usuario').classList.remove('hidden');
                            });
                        });
                        
                        // Inicializar modal de exclusão de usuário
                        initModalExcluirUsuario();
                    } catch (e) {
                        console.error("Erro ao atualizar lista de usuários:", e);
                    }
                }
                
                // Inicializar painel de notificações
                function initNotifications() {
                    // Atualizar contador de notificações
                    atualizarContadorNotificacoes();
                    
                    // Botão de marcar todas como lidas
                    document.querySelector('#notifications-panel button').addEventListener('click', function() {
                        DB.notifications.markAllAsRead();
                        atualizarContadorNotificacoes();
                        mostrarToast("Todas as notificações foram marcadas como lidas", "success");
                    });
                }
                
                // Função para inicializar seção de ajuda
                function initHelp() {
                    // Botão de fechar ajuda
                    document.getElementById('close-help').addEventListener('click', function() {
                        document.getElementById('help-overlay').classList.add('hidden');
                    });
                    
                    // Botão de tutorial interativo
                    document.getElementById('start-tutorial').addEventListener('click', function() {
                        document.getElementById('help-overlay').classList.add('hidden');
                        // Iniciar tutorial interativo (implementação futura)
                        mostrarToast("Tutorial interativo será implementado em uma atualização futura", "info");
                    });
                    
                    // Botão de iniciar tutorial na aba de ajuda
                    document.getElementById('btn-help-tutorial').addEventListener('click', function() {
                        document.getElementById('help-overlay').classList.remove('hidden');
                    });
                }
                
                // Inicialização quando o DOM estiver carregado
                document.addEventListener('DOMContentLoaded', function() {
                    // Inicializar formulário de login
                    initLoginForm();
                });
    </script>
</body>
</html>
